

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mechanical Models &mdash; Simcoon 1.9.7 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css?v=7f9a90b1" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
    <link rel="canonical" href="https://microgen.readthedocs.io/en/latest/cpp_api/umat/mechanical.html"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=0f42b3e6"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #24445C" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Simcoon
              <img src="../../_static/simcoonLogos_ss_fond.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#developer-installation">Developer Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../installation.html#prerequisites-using-conda">Prerequisites (using conda)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../installation.html#prerequisites-without-conda">Prerequisites (without conda)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../installation.html#simcoon-installation">Simcoon Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../installation.html#running-tests-all-platforms">Running Tests (All Platforms)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../installation.html#additional-information">Additional Information</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../external.html">External</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../external.html#umext-plugin-format">UMEXT Plugin Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../external.html#umaba-plugin-format-abaqus-compatibility">UMABA Plugin Format (Abaqus Compatibility)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../external.html#umans-plugin-format-ansys-compatibility">UMANS Plugin Format (Ansys Compatibility)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../external.html#compiling-external-plugins">Compiling External Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../external.html#setting-up-input-files">Setting Up Input Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../external.html#testing-external-plugins">Testing External Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../external.html#running-the-tests">Running the Tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../simulation/index.html">Simulation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../simulation/solver.html">Use the solver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/solver.html#elastic-tensile-test">Elastic tensile test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/solver.html#solver-parameters">Solver parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../simulation/solver.html#corotational-spin-rate-types">Corotational spin rate types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/solver.html#define-the-loading-path">Define the loading path</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../simulation/solver.html#general-structure">General structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../simulation/solver.html#block-parameters">Block parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../simulation/solver.html#step-definitions">Step definitions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/solver.html#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../simulation/solver.html#cyclic-loading-plasticity">Cyclic loading (plasticity)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../simulation/solver.html#hyperelasticity-with-deformation-gradient-control">Hyperelasticity with deformation gradient control</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../simulation/solver.html#finite-deformation-with-spin-logarithmic-strain">Finite deformation with spin (logarithmic strain)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../simulation/solver.html#thermomechanical-loading">Thermomechanical loading</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../simulation/output.html">Configure the output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/output.html#file-structure">File structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/output.html#basic-example">Basic example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/output.html#strain-output-options">Strain output options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/output.html#stress-output-options">Stress output options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/output.html#rotation-output-options">Rotation output options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/output.html#tangent-modulus-output">Tangent modulus output</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/output.html#temperature-output">Temperature output</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/output.html#internal-state-variables">Internal state variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/output.html#block-output-control">Block output control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/output.html#hyperelasticity-example">Hyperelasticity example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/output.html#default-values">Default values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/output.html#result-file-format">Result file format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../simulation/fea_integration.html">FEA Integration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/fea_integration.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/fea_integration.html#supported-fea-software">Supported FEA Software</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../simulation/abaqus.html">Abaqus Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../simulation/ansys.html">Ansys Integration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/fea_integration.html#key-differences">Key Differences</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simulation/fea_integration.html#available-models">Available Models</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#analysis-and-processing-examples">Analysis and processing examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/analysis/directional_stiffness.html">Effective properties of a cubic material</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/analysis/eshelby_numerical_vs_analytical.html">Numerical vs Analytical Eshelby Tensor Comparison</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/analysis/eshelby_numerical_vs_analytical.html#aspect-ratio-sweep">Aspect Ratio Sweep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/analysis/eshelby_numerical_vs_analytical.html#numerical-integration-convergence">Numerical Integration Convergence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/analysis/eshelby_numerical_vs_analytical.html#plot-analytical-vs-numerical-eshelby-tensor-components">Plot: Analytical vs Numerical Eshelby Tensor Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/analysis/eshelby_numerical_vs_analytical.html#relative-error-analysis">Relative Error Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/analysis/eshelby_numerical_vs_analytical.html#plot-error-comparison-with-limiting-cases">Plot: Error Comparison with Limiting Cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/analysis/eshelby_numerical_vs_analytical.html#convergence-to-limiting-cases">Convergence to Limiting Cases</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/analysis/objective_rates.html">Comparison of objective rates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#continuum-mechanics-examples">Continuum Mechanics Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/continuum_mechanics/constitutive_relations.html">Constitutive Library Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/constitutive_relations.html#l-iso">L_iso</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/constitutive_relations.html#m-iso">M_iso</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/constitutive_relations.html#l-cubic">L_cubic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/constitutive_relations.html#m-cubic">M_cubic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/constitutive_relations.html#l-isotrans">L_isotrans</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/constitutive_relations.html#m-isotrans">M_isotrans</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/constitutive_relations.html#l-ortho">L_ortho</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/constitutive_relations.html#m-ortho">M_ortho</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/continuum_mechanics/rotation.html">Rotation library Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/continuum_mechanics/stress_measures.html">Stress transfer: Cauchy → PKI/PKII/Kirchhoff</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/continuum_mechanics/stress_transfer_helpers.html">Stress transfer library examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/continuum_mechanics/yield_criteria.html">Yield Criteria Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/yield_criteria.html#von-mises-equivalent-stress">Von Mises equivalent stress</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/yield_criteria.html#tresca-equivalent-stress">Tresca equivalent stress</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/yield_criteria.html#drucker-equivalent-stress">Drucker equivalent stress</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/yield_criteria.html#hill-anisotropic-yield-criterion">Hill anisotropic yield criterion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/yield_criteria.html#hill-configurational-tensor">Hill configurational tensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/yield_criteria.html#yield-surface-visualization">Yield surface visualization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/yield_criteria.html#d-yield-surfaces">3D Yield Surfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/yield_criteria.html#plane-stress-11-22">Plane Stress (σ₁₁, σ₂₂)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/yield_criteria.html#tension-shear-11-12">Tension-Shear (σ₁₁, σ₁₂)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/yield_criteria.html#hill-anisotropy-parameters">Hill Anisotropy Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/continuum_mechanics/yield_criteria.html#drucker-parameter-b">Drucker Parameter b</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#heterogeneous-materials-simulation">Heterogeneous materials simulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/heterogeneous/effective_props.html">Micromechanics Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/heterogeneous/effective_props.html#plotting-the-results">Plotting the results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/heterogeneous/effective_props.html#effect-of-aspect-ratio-on-effective-stiffness">Effect of Aspect Ratio on Effective Stiffness</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/heterogeneous/eshelby_tensors.html">Eshelby Tensor Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/heterogeneous/eshelby_tensors.html#eshelby-tensor-for-a-sphere">Eshelby tensor for a sphere</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/heterogeneous/eshelby_tensors.html#eshelby-tensor-for-an-infinite-cylinder">Eshelby tensor for an infinite cylinder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/heterogeneous/eshelby_tensors.html#eshelby-tensor-for-prolate-ellipsoid">Eshelby tensor for prolate ellipsoid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/heterogeneous/eshelby_tensors.html#eshelby-tensor-for-oblate-ellipsoid">Eshelby tensor for oblate ellipsoid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/heterogeneous/eshelby_tensors.html#eshelby-tensor-for-penny-shaped-crack">Eshelby tensor for penny-shaped crack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/heterogeneous/eshelby_tensors.html#numerical-eshelby-tensor-for-general-ellipsoid">Numerical Eshelby tensor for general ellipsoid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/heterogeneous/eshelby_tensors.html#hill-s-interaction-tensor">Hill’s interaction tensor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/heterogeneous/homogenization.html">2 phase composite homogenization example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/heterogeneous/homogenization.html#effect-of-aspect-ratio-on-eshelby-tensor-components">Effect of aspect ratio on Eshelby tensor components</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#hyperelasticity">Hyperelasticity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/hyperelasticity/HYPER_numerical.html">Hyperelastic models - use the API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/hyperelasticity/HYPER_umat.html">Hyperelastic models - use the umat</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#constitutive-laws-examples">Constitutive Laws Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/umats/ELISO.html">Isotropic elasticity examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/umats/ELIST.html">Transversely Isotropic Elasticity Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/umats/ELIST.html#plotting-the-results">Plotting the results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/umats/ELORT.html">Orthotropic Elasticity Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/umats/ELORT.html#plotting-the-results">Plotting the results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/umats/EPCHA.html">Plasticity with Chaboche Hardening Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/umats/EPCHA.html#plotting-the-results">Plotting the results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/umats/EPICP.html">Plasticity with isotropic hardening example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/umats/EPKCP.html">Plasticity with Isotropic and Kinematic Hardening Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/umats/EPKCP.html#plotting-the-results">Plotting the results</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../continuum_mechanics/index.html">Continuum Mechanics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../continuum_mechanics/functions/index.html">Continuum Mechanics generic functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html">The Constitutive Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.Ireal"><code class="docutils literal notranslate"><span class="pre">Ireal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.Ivol"><code class="docutils literal notranslate"><span class="pre">Ivol()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.Idev"><code class="docutils literal notranslate"><span class="pre">Idev()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.Ireal2"><code class="docutils literal notranslate"><span class="pre">Ireal2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.Idev2"><code class="docutils literal notranslate"><span class="pre">Idev2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.Ith"><code class="docutils literal notranslate"><span class="pre">Ith()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.Ir2"><code class="docutils literal notranslate"><span class="pre">Ir2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.Ir05"><code class="docutils literal notranslate"><span class="pre">Ir05()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.L_iso"><code class="docutils literal notranslate"><span class="pre">L_iso()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.M_iso"><code class="docutils literal notranslate"><span class="pre">M_iso()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.L_cubic"><code class="docutils literal notranslate"><span class="pre">L_cubic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.M_cubic"><code class="docutils literal notranslate"><span class="pre">M_cubic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.L_ortho"><code class="docutils literal notranslate"><span class="pre">L_ortho()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.M_ortho"><code class="docutils literal notranslate"><span class="pre">M_ortho()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.L_isotrans"><code class="docutils literal notranslate"><span class="pre">L_isotrans()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.M_isotrans"><code class="docutils literal notranslate"><span class="pre">M_isotrans()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_constitutive.html#simcoon.simmit.H_iso"><code class="docutils literal notranslate"><span class="pre">H_iso()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html">The Contimech Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.dev"><code class="docutils literal notranslate"><span class="pre">dev()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.sph"><code class="docutils literal notranslate"><span class="pre">sph()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.tr"><code class="docutils literal notranslate"><span class="pre">tr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.Mises_stress"><code class="docutils literal notranslate"><span class="pre">Mises_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.eta_stress"><code class="docutils literal notranslate"><span class="pre">eta_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.Mises_strain"><code class="docutils literal notranslate"><span class="pre">Mises_strain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.eta_strain"><code class="docutils literal notranslate"><span class="pre">eta_strain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.J2_stress"><code class="docutils literal notranslate"><span class="pre">J2_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.J2_strain"><code class="docutils literal notranslate"><span class="pre">J2_strain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.J3_stress"><code class="docutils literal notranslate"><span class="pre">J3_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.J3_strain"><code class="docutils literal notranslate"><span class="pre">J3_strain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.Macaulay_p"><code class="docutils literal notranslate"><span class="pre">Macaulay_p()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.Macaulay_n"><code class="docutils literal notranslate"><span class="pre">Macaulay_n()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.sign"><code class="docutils literal notranslate"><span class="pre">sign()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.normal_ellipsoid"><code class="docutils literal notranslate"><span class="pre">normal_ellipsoid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.curvature_ellipsoid"><code class="docutils literal notranslate"><span class="pre">curvature_ellipsoid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.sigma_int"><code class="docutils literal notranslate"><span class="pre">sigma_int()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.p_ikjl"><code class="docutils literal notranslate"><span class="pre">p_ikjl()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.auto_sym_dyadic"><code class="docutils literal notranslate"><span class="pre">auto_sym_dyadic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.sym_dyadic"><code class="docutils literal notranslate"><span class="pre">sym_dyadic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.auto_dyadic"><code class="docutils literal notranslate"><span class="pre">auto_dyadic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.dyadic_4vectors_sym"><code class="docutils literal notranslate"><span class="pre">dyadic_4vectors_sym()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.auto_sym_dyadic_operator"><code class="docutils literal notranslate"><span class="pre">auto_sym_dyadic_operator()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_contimech.html#simcoon.simmit.sym_dyadic_operator"><code class="docutils literal notranslate"><span class="pre">sym_dyadic_operator()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html">The Criteria Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html#simcoon.simmit.Drucker_stress"><code class="docutils literal notranslate"><span class="pre">Drucker_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html#simcoon.simmit.dDrucker_stress"><code class="docutils literal notranslate"><span class="pre">dDrucker_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html#simcoon.simmit.Tresca_stress"><code class="docutils literal notranslate"><span class="pre">Tresca_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html#simcoon.simmit.dTresca_stress"><code class="docutils literal notranslate"><span class="pre">dTresca_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html#simcoon.simmit.P_Ani"><code class="docutils literal notranslate"><span class="pre">P_Ani()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html#simcoon.simmit.P_Hill"><code class="docutils literal notranslate"><span class="pre">P_Hill()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html#simcoon.simmit.P_DFA"><code class="docutils literal notranslate"><span class="pre">P_DFA()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html#simcoon.simmit.Hill_stress"><code class="docutils literal notranslate"><span class="pre">Hill_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html#simcoon.simmit.dHill_stress"><code class="docutils literal notranslate"><span class="pre">dHill_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html#simcoon.simmit.Ani_stress"><code class="docutils literal notranslate"><span class="pre">Ani_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html#simcoon.simmit.dAni_stress"><code class="docutils literal notranslate"><span class="pre">dAni_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html#simcoon.simmit.DFA_stress"><code class="docutils literal notranslate"><span class="pre">DFA_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html#simcoon.simmit.dDFA_stress"><code class="docutils literal notranslate"><span class="pre">dDFA_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html#simcoon.simmit.Eq_stress"><code class="docutils literal notranslate"><span class="pre">Eq_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_criteria.html#simcoon.simmit.dEq_stress"><code class="docutils literal notranslate"><span class="pre">dEq_stress()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../continuum_mechanics/functions/doc_transfer.html">Transfer helpers (Voigt &lt;-&gt; matrix)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_transfer.html#simcoon.simmit.v2t_strain"><code class="docutils literal notranslate"><span class="pre">v2t_strain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_transfer.html#simcoon.simmit.t2v_strain"><code class="docutils literal notranslate"><span class="pre">t2v_strain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_transfer.html#simcoon.simmit.v2t_stress"><code class="docutils literal notranslate"><span class="pre">v2t_stress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_transfer.html#simcoon.simmit.t2v_stress"><code class="docutils literal notranslate"><span class="pre">t2v_stress()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../continuum_mechanics/functions/doc_stress.html">Stress conversions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_stress.html#simcoon.simmit.stress_convert"><code class="docutils literal notranslate"><span class="pre">stress_convert()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../continuum_mechanics/functions/doc_damage.html">The Damage Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_damage.html#simcoon.simmit.damage_weibull"><code class="docutils literal notranslate"><span class="pre">damage_weibull()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_damage.html#simcoon.simmit.damage_kachanov"><code class="docutils literal notranslate"><span class="pre">damage_kachanov()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_damage.html#simcoon.simmit.damage_miner"><code class="docutils literal notranslate"><span class="pre">damage_miner()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_damage.html#simcoon.simmit.damage_manson"><code class="docutils literal notranslate"><span class="pre">damage_manson()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html">The Kinematics Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.ER_to_F"><code class="docutils literal notranslate"><span class="pre">ER_to_F()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.eR_to_F"><code class="docutils literal notranslate"><span class="pre">eR_to_F()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.G_UdX"><code class="docutils literal notranslate"><span class="pre">G_UdX()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.G_Udx"><code class="docutils literal notranslate"><span class="pre">G_Udx()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.R_Cauchy_Green"><code class="docutils literal notranslate"><span class="pre">R_Cauchy_Green()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.L_Cauchy_Green"><code class="docutils literal notranslate"><span class="pre">L_Cauchy_Green()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.RU_decomposition"><code class="docutils literal notranslate"><span class="pre">RU_decomposition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.VR_decomposition"><code class="docutils literal notranslate"><span class="pre">VR_decomposition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.Inv_X"><code class="docutils literal notranslate"><span class="pre">Inv_X()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.Cauchy"><code class="docutils literal notranslate"><span class="pre">Cauchy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.Green_Lagrange"><code class="docutils literal notranslate"><span class="pre">Green_Lagrange()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.Euler_Almansi"><code class="docutils literal notranslate"><span class="pre">Euler_Almansi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.Log_strain"><code class="docutils literal notranslate"><span class="pre">Log_strain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.finite_L"><code class="docutils literal notranslate"><span class="pre">finite_L()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.finite_D"><code class="docutils literal notranslate"><span class="pre">finite_D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.finite_W"><code class="docutils literal notranslate"><span class="pre">finite_W()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.finite_Omega"><code class="docutils literal notranslate"><span class="pre">finite_Omega()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_kinematics.html#simcoon.simmit.finite_DQ"><code class="docutils literal notranslate"><span class="pre">finite_DQ()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../continuum_mechanics/functions/doc_hyperelastic.html">Hyperelasticity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../continuum_mechanics/functions/doc_recovery_props.html">Recovery of Elastic Properties</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_recovery_props.html#simcoon.simmit.check_symetries"><code class="docutils literal notranslate"><span class="pre">check_symetries()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_recovery_props.html#simcoon.simmit.L_iso_props"><code class="docutils literal notranslate"><span class="pre">L_iso_props()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_recovery_props.html#simcoon.simmit.M_iso_props"><code class="docutils literal notranslate"><span class="pre">M_iso_props()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_recovery_props.html#simcoon.simmit.L_isotrans_props"><code class="docutils literal notranslate"><span class="pre">L_isotrans_props()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_recovery_props.html#simcoon.simmit.M_isotrans_props"><code class="docutils literal notranslate"><span class="pre">M_isotrans_props()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_recovery_props.html#simcoon.simmit.L_cubic_props"><code class="docutils literal notranslate"><span class="pre">L_cubic_props()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_recovery_props.html#simcoon.simmit.M_cubic_props"><code class="docutils literal notranslate"><span class="pre">M_cubic_props()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_recovery_props.html#simcoon.simmit.L_ortho_props"><code class="docutils literal notranslate"><span class="pre">L_ortho_props()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_recovery_props.html#simcoon.simmit.M_ortho_props"><code class="docutils literal notranslate"><span class="pre">M_ortho_props()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../continuum_mechanics/functions/doc_recovery_props.html#simcoon.simmit.M_aniso_props"><code class="docutils literal notranslate"><span class="pre">M_aniso_props()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../homogenization/index.html">Homogenization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../homogenization/doc_eshelby.html">The Eshelby Library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../homogenization/doc_eshelby.html#simcoon.simmit.Eshelby_sphere"><code class="docutils literal notranslate"><span class="pre">Eshelby_sphere()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../homogenization/doc_eshelby.html#simcoon.simmit.Eshelby_cylinder"><code class="docutils literal notranslate"><span class="pre">Eshelby_cylinder()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../homogenization/doc_eshelby.html#simcoon.simmit.Eshelby_prolate"><code class="docutils literal notranslate"><span class="pre">Eshelby_prolate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../homogenization/doc_eshelby.html#simcoon.simmit.Eshelby_oblate"><code class="docutils literal notranslate"><span class="pre">Eshelby_oblate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../homogenization/doc_eshelby.html#simcoon.simmit.Eshelby_penny"><code class="docutils literal notranslate"><span class="pre">Eshelby_penny()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../homogenization/doc_eshelby.html#simcoon.simmit.Eshelby"><code class="docutils literal notranslate"><span class="pre">Eshelby()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../homogenization/doc_eshelby.html#simcoon.simmit.T_II"><code class="docutils literal notranslate"><span class="pre">T_II()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #24445C" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Simcoon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Mechanical Models</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/cpp_api/umat/mechanical.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mechanical-models">
<h1>Mechanical Models<a class="headerlink" href="#mechanical-models" title="Link to this heading"></a></h1>
<p>Small strain mechanical constitutive models including elasticity,
plasticity, viscoelasticity, and damage.</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420abaqus2smart_M_lightPKdPKdRKiPdRKiRKiRN4arma3vecERN4arma3matERN4arma3vecERN4arma3vecE">
<span id="_CPPv320abaqus2smart_M_lightPKdPKdRKiPdRKiRKiRN4arma3vecERN4arma3matERN4arma3vecERN4arma3vecE"></span><span id="_CPPv220abaqus2smart_M_lightPKdPKdRKiPdRKiRKiRN4arma3vecERN4arma3matERN4arma3vecERN4arma3vecE"></span><span id="abaqus2smart_M_light__doubleCP.doubleCP.iCR.doubleP.iCR.iCR.arma::vecR.arma::matR.arma::vecR.arma::vecR"></span><span class="target" id="group__umat__mechanical_1gae035bbf6e5bf3b3ac03a732f61f9c6be"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">abaqus2smart_M_light</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">stress</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ddsdde</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev_smart</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420abaqus2smart_M_lightPKdPKdRKiPdRKiRKiRN4arma3vecERN4arma3matERN4arma3vecERN4arma3vecE" title="Link to this definition"></a><br /></dt>
<dd><p>Light transfer from Abaqus output arrays to simcoon format (mechanical) </p>
<p>Converts stress, tangent, and state variables from Abaqus format. Use this after calling an external Abaqus UMAT to retrieve results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stress</strong> – Abaqus stress array (ntens) </p></li>
<li><p><strong>ddsdde</strong> – Abaqus tangent operator array (ntens×ntens, column-major) </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – Abaqus state variables array </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components </p></li>
<li><p><strong>sigma</strong> – [out] simcoon stress vector (6) </p></li>
<li><p><strong>Lt</strong> – [out] simcoon tangent matrix (6×6) </p></li>
<li><p><strong>Wm</strong> – [out] simcoon work quantities vector (4): Wm, Wm_r, Wm_ir, Wm_d </p></li>
<li><p><strong>statev_smart</strong> – [out] simcoon state variables vector </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414abaqus2smart_MPKdPKdPKdPKdPKdRKdRKdRKdRKiPKdRKiPdRKiRKiPKdRN4arma3vecERN4arma3matERN4arma3vecERN4arma3vecERdRdRdRdRN4arma3vecERN4arma3vecERN4arma3vecERN4arma3matERb">
<span id="_CPPv314abaqus2smart_MPKdPKdPKdPKdPKdRKdRKdRKdRKiPKdRKiPdRKiRKiPKdRN4arma3vecERN4arma3matERN4arma3vecERN4arma3vecERdRdRdRdRN4arma3vecERN4arma3vecERN4arma3vecERN4arma3matERb"></span><span id="_CPPv214abaqus2smart_MPKdPKdPKdPKdPKdRKdRKdRKdRKiPKdRKiPdRKiRKiPKdRN4arma3vecERN4arma3matERN4arma3vecERN4arma3vecERdRdRdRdRN4arma3vecERN4arma3vecERN4arma3vecERN4arma3matERb"></span><span id="abaqus2smart_M__doubleCP.doubleCP.doubleCP.doubleCP.doubleCP.doubleCR.doubleCR.doubleCR.iCR.doubleCP.iCR.doubleP.iCR.iCR.doubleCP.arma::vecR.arma::matR.arma::vecR.arma::vecR.doubleR.doubleR.doubleR.doubleR.arma::vecR.arma::vecR.arma::vecR.arma::matR.bR"></span><span class="target" id="group__umat__mechanical_1gab6dba61dbb2386269b177c6537da8459"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">abaqus2smart_M</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">stress</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ddsdde</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">stran</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dstran</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dtime</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temperature</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Dtemperature</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">drot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props_smart</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev_smart</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414abaqus2smart_MPKdPKdPKdPKdPKdRKdRKdRKdRKiPKdRKiPdRKiRKiPKdRN4arma3vecERN4arma3matERN4arma3vecERN4arma3vecERdRdRdRdRN4arma3vecERN4arma3vecERN4arma3vecERN4arma3matERb" title="Link to this definition"></a><br /></dt>
<dd><p>Full transfer from Abaqus input arrays to simcoon format (mechanical) </p>
<p>Converts all UMAT inputs from Abaqus format to simcoon Armadillo format. Use this before calling a simcoon constitutive model from an Abaqus UMAT wrapper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stress</strong> – Abaqus stress array </p></li>
<li><p><strong>ddsdde</strong> – Abaqus tangent operator array </p></li>
<li><p><strong>stran</strong> – Abaqus total strain array </p></li>
<li><p><strong>dstran</strong> – Abaqus strain increment array </p></li>
<li><p><strong>time</strong> – Abaqus time array [step_time, total_time] </p></li>
<li><p><strong>dtime</strong> – Time increment </p></li>
<li><p><strong>temperature</strong> – Temperature at start of increment </p></li>
<li><p><strong>Dtemperature</strong> – Temperature increment </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Abaqus material properties array </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – Abaqus state variables array </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components </p></li>
<li><p><strong>drot</strong> – Abaqus rotation increment matrix (3×3, column-major) </p></li>
<li><p><strong>sigma</strong> – [out] simcoon stress vector </p></li>
<li><p><strong>Lt</strong> – [out] simcoon tangent matrix </p></li>
<li><p><strong>Etot</strong> – [out] simcoon total strain vector </p></li>
<li><p><strong>DEtot</strong> – [out] simcoon strain increment vector </p></li>
<li><p><strong>T</strong> – [out] simcoon temperature </p></li>
<li><p><strong>DT</strong> – [out] simcoon temperature increment </p></li>
<li><p><strong>Time</strong> – [out] simcoon total time </p></li>
<li><p><strong>DTime</strong> – [out] simcoon time increment </p></li>
<li><p><strong>props_smart</strong> – [out] simcoon properties vector </p></li>
<li><p><strong>Wm</strong> – [out] simcoon work quantities vector </p></li>
<li><p><strong>statev_smart</strong> – [out] simcoon state variables vector </p></li>
<li><p><strong>DR</strong> – [out] simcoon rotation matrix </p></li>
<li><p><strong>start</strong> – [out] true if this is the first increment </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414abaqus2smart_TPKdPKdPKdPKdRKdPKdPKdPKdRKdRKdRKdRKiPKdRKiPdRKiRKiPKdRN4arma3vecERN4arma3matERN4arma3matERN4arma3matERN4arma3matERN4arma3vecERN4arma3vecERdRdRdRdRN4arma3vecERN4arma3vecERN4arma3vecERN4arma3vecERN4arma3matERb">
<span id="_CPPv314abaqus2smart_TPKdPKdPKdPKdRKdPKdPKdPKdRKdRKdRKdRKiPKdRKiPdRKiRKiPKdRN4arma3vecERN4arma3matERN4arma3matERN4arma3matERN4arma3matERN4arma3vecERN4arma3vecERdRdRdRdRN4arma3vecERN4arma3vecERN4arma3vecERN4arma3vecERN4arma3matERb"></span><span id="_CPPv214abaqus2smart_TPKdPKdPKdPKdRKdPKdPKdPKdRKdRKdRKdRKiPKdRKiPdRKiRKiPKdRN4arma3vecERN4arma3matERN4arma3matERN4arma3matERN4arma3matERN4arma3vecERN4arma3vecERdRdRdRdRN4arma3vecERN4arma3vecERN4arma3vecERN4arma3vecERN4arma3matERb"></span><span id="abaqus2smart_T__doubleCP.doubleCP.doubleCP.doubleCP.doubleCR.doubleCP.doubleCP.doubleCP.doubleCR.doubleCR.doubleCR.iCR.doubleCP.iCR.doubleP.iCR.iCR.doubleCP.arma::vecR.arma::matR.arma::matR.arma::matR.arma::matR.arma::vecR.arma::vecR.doubleR.doubleR.doubleR.doubleR.arma::vecR.arma::vecR.arma::vecR.arma::vecR.arma::matR.bR"></span><span class="target" id="group__umat__mechanical_1gaeabc187e291283818da6ac67e758723f"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">abaqus2smart_T</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">stress</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ddsdde</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ddsddt</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">drplde</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">drpldt</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">stran</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dstran</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dtime</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temperature</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Dtemperature</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">drot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dSdE</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dSdT</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">drpldE</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">drpldT</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props_smart</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wt</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev_smart</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414abaqus2smart_TPKdPKdPKdPKdRKdPKdPKdPKdRKdRKdRKdRKiPKdRKiPdRKiRKiPKdRN4arma3vecERN4arma3matERN4arma3matERN4arma3matERN4arma3matERN4arma3vecERN4arma3vecERdRdRdRdRN4arma3vecERN4arma3vecERN4arma3vecERN4arma3vecERN4arma3matERb" title="Link to this definition"></a><br /></dt>
<dd><p>Full transfer from Abaqus input arrays to simcoon format (thermomechanical) </p>
<p>Converts all thermomechanical UMAT inputs from Abaqus format. Includes thermal tangent operators and heat generation terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stress</strong> – Abaqus stress array </p></li>
<li><p><strong>ddsdde</strong> – Abaqus mechanical tangent array </p></li>
<li><p><strong>ddsddt</strong> – Abaqus stress-temperature tangent array </p></li>
<li><p><strong>drplde</strong> – Abaqus heat generation-strain tangent array </p></li>
<li><p><strong>drpldt</strong> – Abaqus heat generation-temperature tangent </p></li>
<li><p><strong>stran</strong> – Abaqus total strain array </p></li>
<li><p><strong>dstran</strong> – Abaqus strain increment array </p></li>
<li><p><strong>time</strong> – Abaqus time array </p></li>
<li><p><strong>dtime</strong> – Time increment </p></li>
<li><p><strong>temperature</strong> – Temperature at start of increment </p></li>
<li><p><strong>Dtemperature</strong> – Temperature increment </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Abaqus material properties array </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – Abaqus state variables array </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components </p></li>
<li><p><strong>drot</strong> – Abaqus rotation increment matrix </p></li>
<li><p><strong>sigma</strong> – [out] simcoon stress vector </p></li>
<li><p><strong>dSdE</strong> – [out] simcoon mechanical tangent matrix </p></li>
<li><p><strong>dSdT</strong> – [out] simcoon stress-temperature tangent matrix </p></li>
<li><p><strong>drpldE</strong> – [out] simcoon heat generation-strain tangent matrix </p></li>
<li><p><strong>drpldT</strong> – [out] simcoon heat generation-temperature tangent matrix </p></li>
<li><p><strong>Etot</strong> – [out] simcoon total strain vector </p></li>
<li><p><strong>DEtot</strong> – [out] simcoon strain increment vector </p></li>
<li><p><strong>T</strong> – [out] simcoon temperature </p></li>
<li><p><strong>DT</strong> – [out] simcoon temperature increment </p></li>
<li><p><strong>Time</strong> – [out] simcoon total time </p></li>
<li><p><strong>DTime</strong> – [out] simcoon time increment </p></li>
<li><p><strong>props_smart</strong> – [out] simcoon properties vector </p></li>
<li><p><strong>Wm</strong> – [out] simcoon mechanical work quantities vector </p></li>
<li><p><strong>Wt</strong> – [out] simcoon thermal work quantities vector </p></li>
<li><p><strong>statev_smart</strong> – [out] simcoon state variables vector </p></li>
<li><p><strong>DR</strong> – [out] simcoon rotation matrix </p></li>
<li><p><strong>start</strong> – [out] true if this is the first increment </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414smart2abaqus_MPdPdPdRKiRKiRKN4arma3vecERKN4arma3vecERKN4arma3vecERKN4arma3matE">
<span id="_CPPv314smart2abaqus_MPdPdPdRKiRKiRKN4arma3vecERKN4arma3vecERKN4arma3vecERKN4arma3matE"></span><span id="_CPPv214smart2abaqus_MPdPdPdRKiRKiRKN4arma3vecERKN4arma3vecERKN4arma3vecERKN4arma3matE"></span><span id="smart2abaqus_M__doubleP.doubleP.doubleP.iCR.iCR.arma::vecCR.arma::vecCR.arma::vecCR.arma::matCR"></span><span class="target" id="group__umat__mechanical_1ga78bfff524900e990bc401bababfee948"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">smart2abaqus_M</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">stress</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ddsdde</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev_smart</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414smart2abaqus_MPdPdPdRKiRKiRKN4arma3vecERKN4arma3vecERKN4arma3vecERKN4arma3matE" title="Link to this definition"></a><br /></dt>
<dd><p>Transfer simcoon output to Abaqus format (mechanical, simple) </p>
<p>Converts stress, tangent, and state variables to Abaqus format. Use this to return results from a simcoon model to an Abaqus UMAT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stress</strong> – [out] Abaqus stress array </p></li>
<li><p><strong>ddsdde</strong> – [out] Abaqus tangent operator array </p></li>
<li><p><strong>statev</strong> – [out] Abaqus state variables array </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components </p></li>
<li><p><strong>sigma</strong> – simcoon stress vector </p></li>
<li><p><strong>statev_smart</strong> – simcoon state variables vector </p></li>
<li><p><strong>Wm</strong> – simcoon work quantities vector </p></li>
<li><p><strong>Lt</strong> – simcoon tangent matrix </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419smart2abaqus_M_fullPdPdPdPdPdRdRdRdRiPdRiPdRKiRKiPdRKN4arma3vecERKN4arma3matERKN4arma3vecERKN4arma3vecERKdRKdRKdRKdRKN4arma3vecERKN4arma3vecERKN4arma3vecERKN4arma3matERb">
<span id="_CPPv319smart2abaqus_M_fullPdPdPdPdPdRdRdRdRiPdRiPdRKiRKiPdRKN4arma3vecERKN4arma3matERKN4arma3vecERKN4arma3vecERKdRKdRKdRKdRKN4arma3vecERKN4arma3vecERKN4arma3vecERKN4arma3matERb"></span><span id="_CPPv219smart2abaqus_M_fullPdPdPdPdPdRdRdRdRiPdRiPdRKiRKiPdRKN4arma3vecERKN4arma3matERKN4arma3vecERKN4arma3vecERKdRKdRKdRKdRKN4arma3vecERKN4arma3vecERKN4arma3vecERKN4arma3matERb"></span><span id="smart2abaqus_M_full__doubleP.doubleP.doubleP.doubleP.doubleP.doubleR.doubleR.doubleR.iR.doubleP.iR.doubleP.iCR.iCR.doubleP.arma::vecCR.arma::matCR.arma::vecCR.arma::vecCR.doubleCR.doubleCR.doubleCR.doubleCR.arma::vecCR.arma::vecCR.arma::vecCR.arma::matCR.bR"></span><span class="target" id="group__umat__mechanical_1gace3a262e2dd88b7c2ad614b2590e0b4f"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">smart2abaqus_M_full</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">stress</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ddsdde</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">stran</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dstran</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">time</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dtime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temperature</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Dtemperature</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">drot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props_smart</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev_smart</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419smart2abaqus_M_fullPdPdPdPdPdRdRdRdRiPdRiPdRKiRKiPdRKN4arma3vecERKN4arma3matERKN4arma3vecERKN4arma3vecERKdRKdRKdRKdRKN4arma3vecERKN4arma3vecERKN4arma3vecERKN4arma3matERb" title="Link to this definition"></a><br /></dt>
<dd><p>Full transfer from simcoon to Abaqus format (mechanical) </p>
<p>Converts all simcoon outputs to Abaqus UMAT format. Use this for complete state transfer in external UMAT wrappers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stress</strong> – [out] Abaqus stress array </p></li>
<li><p><strong>ddsdde</strong> – [out] Abaqus tangent operator array </p></li>
<li><p><strong>stran</strong> – [out] Abaqus total strain array </p></li>
<li><p><strong>dstran</strong> – [out] Abaqus strain increment array </p></li>
<li><p><strong>time</strong> – [out] Abaqus time array </p></li>
<li><p><strong>dtime</strong> – [out] Time increment </p></li>
<li><p><strong>temperature</strong> – [out] Temperature </p></li>
<li><p><strong>Dtemperature</strong> – [out] Temperature increment </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – [out] Abaqus material properties array </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – [out] Abaqus state variables array </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components </p></li>
<li><p><strong>drot</strong> – [out] Abaqus rotation increment matrix </p></li>
<li><p><strong>sigma</strong> – simcoon stress vector </p></li>
<li><p><strong>Lt</strong> – simcoon tangent matrix </p></li>
<li><p><strong>Etot</strong> – simcoon total strain vector </p></li>
<li><p><strong>DEtot</strong> – simcoon strain increment vector </p></li>
<li><p><strong>T</strong> – simcoon temperature </p></li>
<li><p><strong>DT</strong> – simcoon temperature increment </p></li>
<li><p><strong>Time</strong> – simcoon total time </p></li>
<li><p><strong>DTime</strong> – simcoon time increment </p></li>
<li><p><strong>props_smart</strong> – simcoon properties vector </p></li>
<li><p><strong>Wm</strong> – simcoon work quantities vector </p></li>
<li><p><strong>statev_smart</strong> – simcoon state variables vector </p></li>
<li><p><strong>DR</strong> – simcoon rotation matrix </p></li>
<li><p><strong>start</strong> – simcoon start flag </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414smart2abaqus_TPdPdPdPdRdRdPdRKiRKiRKN4arma3vecERKN4arma3vecERKdRKN4arma3vecERKN4arma3vecERKN4arma3matERKN4arma3matERKN4arma3matERKN4arma3matE">
<span id="_CPPv314smart2abaqus_TPdPdPdPdRdRdPdRKiRKiRKN4arma3vecERKN4arma3vecERKdRKN4arma3vecERKN4arma3vecERKN4arma3matERKN4arma3matERKN4arma3matERKN4arma3matE"></span><span id="_CPPv214smart2abaqus_TPdPdPdPdRdRdPdRKiRKiRKN4arma3vecERKN4arma3vecERKdRKN4arma3vecERKN4arma3vecERKN4arma3matERKN4arma3matERKN4arma3matERKN4arma3matE"></span><span id="smart2abaqus_T__doubleP.doubleP.doubleP.doubleP.doubleR.doubleR.doubleP.iCR.iCR.arma::vecCR.arma::vecCR.doubleCR.arma::vecCR.arma::vecCR.arma::matCR.arma::matCR.arma::matCR.arma::matCR"></span><span class="target" id="group__umat__mechanical_1ga83800843aaa054fcc127aff490c348b0"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">smart2abaqus_T</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">stress</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ddsdde</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ddsddt</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">drplde</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">drpldt</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">rpl</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev_smart</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">r</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wt</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dSdE</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dSdT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">drpldE</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">drpldT</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414smart2abaqus_TPdPdPdPdRdRdPdRKiRKiRKN4arma3vecERKN4arma3vecERKdRKN4arma3vecERKN4arma3vecERKN4arma3matERKN4arma3matERKN4arma3matERKN4arma3matE" title="Link to this definition"></a><br /></dt>
<dd><p>Transfer simcoon output to Abaqus format (thermomechanical) </p>
<p>Converts thermomechanical outputs to Abaqus UMAT format. Includes thermal tangent operators and heat generation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stress</strong> – [out] Abaqus stress array </p></li>
<li><p><strong>ddsdde</strong> – [out] Abaqus mechanical tangent array </p></li>
<li><p><strong>ddsddt</strong> – [out] Abaqus stress-temperature tangent array </p></li>
<li><p><strong>drplde</strong> – [out] Abaqus heat generation-strain tangent array </p></li>
<li><p><strong>drpldt</strong> – [out] Abaqus heat generation-temperature tangent </p></li>
<li><p><strong>rpl</strong> – [out] Abaqus heat generation rate </p></li>
<li><p><strong>statev</strong> – [out] Abaqus state variables array </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components </p></li>
<li><p><strong>sigma</strong> – simcoon stress vector </p></li>
<li><p><strong>statev_smart</strong> – simcoon state variables vector </p></li>
<li><p><strong>r</strong> – simcoon heat generation rate </p></li>
<li><p><strong>Wm</strong> – simcoon mechanical work quantities vector </p></li>
<li><p><strong>Wt</strong> – simcoon thermal work quantities vector </p></li>
<li><p><strong>dSdE</strong> – simcoon mechanical tangent matrix </p></li>
<li><p><strong>dSdT</strong> – simcoon stress-temperature tangent matrix </p></li>
<li><p><strong>drpldE</strong> – simcoon heat generation-strain tangent matrix </p></li>
<li><p><strong>drpldT</strong> – simcoon heat generation-temperature tangent matrix </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413ansys2smart_MPKdPKdRKdRKdRKdPKdPKdRKdRKdRKdRKdRKiRKiRKiRN4arma3vecERN4arma3vecERN4arma3vecERN4arma3vecERN4arma3vecERdRd">
<span id="_CPPv313ansys2smart_MPKdPKdRKdRKdRKdPKdPKdRKdRKdRKdRKdRKiRKiRKiRN4arma3vecERN4arma3vecERN4arma3vecERN4arma3vecERN4arma3vecERdRd"></span><span id="_CPPv213ansys2smart_MPKdPKdRKdRKdRKdPKdPKdRKdRKdRKdRKdRKiRKiRKiRN4arma3vecERN4arma3vecERN4arma3vecERN4arma3vecERN4arma3vecERdRd"></span><span id="ansys2smart_M__doubleCP.doubleCP.doubleCR.doubleCR.doubleCR.doubleCP.doubleCP.doubleCR.doubleCR.doubleCR.doubleCR.iCR.iCR.iCR.arma::vecR.arma::vecR.arma::vecR.arma::vecR.arma::vecR.doubleR.doubleR"></span><span class="target" id="group__umat__mechanical_1gab7d3c45a4ec1cd31dcc2e50189da63d0"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ansys2smart_M</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">stress</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dstran</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sedEl</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sedPl</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">epseq</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temperature</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Dtemperature</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ncomp</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev_smart</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props_smart</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413ansys2smart_MPKdPKdRKdRKdRKdPKdPKdRKdRKdRKdRKdRKiRKiRKiRN4arma3vecERN4arma3vecERN4arma3vecERN4arma3vecERN4arma3vecERdRd" title="Link to this definition"></a><br /></dt>
<dd><p>Transfer Ansys USERMAT input arrays to simcoon format (mechanical) </p>
<p>Converts all USERMAT inputs from Ansys format to simcoon format. Handles Ansys Voigt notation: (11,22,33,12,23,13) by swapping components 4 and 5.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stress</strong> – Ansys stress array (ncomp) </p></li>
<li><p><strong>dstran</strong> – Ansys strain increment array (ncomp) </p></li>
<li><p><strong>sedEl</strong> – Specific elastic strain energy </p></li>
<li><p><strong>sedPl</strong> – Specific plastic strain energy </p></li>
<li><p><strong>epseq</strong> – Equivalent plastic strain </p></li>
<li><p><strong>statev</strong> – Ansys state variables array </p></li>
<li><p><strong>props</strong> – Ansys material properties array </p></li>
<li><p><strong>Time</strong> – Total time </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>temperature</strong> – Temperature </p></li>
<li><p><strong>Dtemperature</strong> – Temperature increment </p></li>
<li><p><strong>ncomp</strong> – Number of stress/strain components </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>sigma</strong> – [out] simcoon stress vector </p></li>
<li><p><strong>DEtot</strong> – [out] simcoon strain increment vector </p></li>
<li><p><strong>Wm</strong> – [out] simcoon work quantities vector </p></li>
<li><p><strong>statev_smart</strong> – [out] simcoon state variables vector </p></li>
<li><p><strong>props_smart</strong> – [out] simcoon properties vector </p></li>
<li><p><strong>T</strong> – [out] simcoon temperature </p></li>
<li><p><strong>DT</strong> – [out] simcoon temperature increment </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413smart2ansys_MPdPdRdRdPdRKiRKN4arma3vecERKN4arma3matERKN4arma3vecERKN4arma3vecE">
<span id="_CPPv313smart2ansys_MPdPdRdRdPdRKiRKN4arma3vecERKN4arma3matERKN4arma3vecERKN4arma3vecE"></span><span id="_CPPv213smart2ansys_MPdPdRdRdPdRKiRKN4arma3vecERKN4arma3matERKN4arma3vecERKN4arma3vecE"></span><span id="smart2ansys_M__doubleP.doubleP.doubleR.doubleR.doubleP.iCR.arma::vecCR.arma::matCR.arma::vecCR.arma::vecCR"></span><span class="target" id="group__umat__mechanical_1ga64835e7ed41749c81aaf780d4f23a33b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">smart2ansys_M</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">stress</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ddsdde</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sedEl</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sedPl</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ncomp</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev_smart</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413smart2ansys_MPdPdRdRdPdRKiRKN4arma3vecERKN4arma3matERKN4arma3vecERKN4arma3vecE" title="Link to this definition"></a><br /></dt>
<dd><p>Transfer simcoon output to Ansys USERMAT format (mechanical) </p>
<p>Converts stress, tangent, and state variables to Ansys format. Handles Ansys Voigt notation by swapping components 4 and 5.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stress</strong> – [out] Ansys stress array </p></li>
<li><p><strong>ddsdde</strong> – [out] Ansys tangent operator array </p></li>
<li><p><strong>sedEl</strong> – [out] Specific elastic strain energy </p></li>
<li><p><strong>sedPl</strong> – [out] Specific plastic strain energy </p></li>
<li><p><strong>statev</strong> – [out] Ansys state variables array </p></li>
<li><p><strong>ncomp</strong> – Number of stress/strain components </p></li>
<li><p><strong>sigma</strong> – simcoon stress vector </p></li>
<li><p><strong>Lt</strong> – simcoon tangent matrix </p></li>
<li><p><strong>Wm</strong> – simcoon work quantities vector </p></li>
<li><p><strong>statev_smart</strong> – simcoon state variables vector </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417umat_damage_LLD_0RKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd">
<span id="_CPPv317umat_damage_LLD_0RKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="_CPPv217umat_damage_LLD_0RKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="umat_damage_LLD_0__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matR.arma::vecR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.iCR.doubleR"></span><span class="target" id="group__umat__mechanical_1ga2bcdff3be105809f973ac1236b380dcc"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_damage_LLD_0</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">L</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma_in</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_ir</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_d</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">solver_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tnew_dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417umat_damage_LLD_0RKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd" title="Link to this definition"></a><br /></dt>
<dd><p>Ladevèze-Le Dantec (LLD) anisotropic damage model with coupled plasticity for composite materials. </p>
<p>This function implements the Ladevèze-Le Dantec damage model specifically designed for unidirectional fiber-reinforced composite materials. The model features:<ul class="simple">
<li><p>Transversely isotropic elastic behavior</p></li>
<li><p>Anisotropic damage in matrix-dominated modes (transverse tension, in-plane shear)</p></li>
<li><p>Coupled transverse-shear plasticity</p></li>
<li><p>Thermodynamically consistent damage evolution based on energy release rate</p></li>
<li><p>Separate damage variables for different failure modes</p></li>
<li><p>No fiber failure (matrix-dominated damage only)</p></li>
</ul>
</p>
<p><strong>Material Symmetry:</strong></p>
<p>The model assumes transverse isotropy with the fiber direction as the axis of symmetry:<ul class="simple">
<li><p>Direction 1: Fiber direction (longitudinal, no damage)</p></li>
<li><p>Directions 2-3: Transverse plane (isotropic, subject to damage)</p></li>
</ul>
</p>
<p><strong>Damage Variables:</strong></p>
<p>Two independent scalar damage variables characterize the material state:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( d_{22} \in [0,1] \)</span>: Transverse damage (matrix cracking perpendicular to fibers)</p></li>
<li><p><span class="math notranslate nohighlight">\( d_{12} \in [0,1] \)</span>: Shear damage (matrix/interface damage in fiber-matrix plane)</p></li>
</ul>
</p>
<p>where <span class="math notranslate nohighlight">\( d = 0 \)</span> is undamaged and <span class="math notranslate nohighlight">\( d = 1 \)</span> is fully damaged.</p>
<p><strong>Effective Stress Concept:</strong></p>
<p>The effective stress acting on the undamaged material configuration is:   <div class="math notranslate nohighlight">
\[\tilde{\boldsymbol{\sigma}} = \mathbf{M}^{-1} : \boldsymbol{\sigma}
\]</div>
 where <span class="math notranslate nohighlight">\( \mathbf{M} \)</span> is the damage effect tensor:   <div class="math notranslate nohighlight">
\[\mathbf{M} = \text{diag}(1, 1-d_{22}, 1-d_{22}, 1-d_{12}, 1-d_{12}, 1)
\]</div>
</p>
<p><strong>Damaged Elastic Stiffness:</strong></p>
<p>The elastic stiffness degrades with damage:   <div class="math notranslate nohighlight">
\[\mathbf{L}(d_{22}, d_{12}) = \mathbf{L}_0 : \mathbf{M}
\]</div>
 where <span class="math notranslate nohighlight">\( \mathbf{L}_0 \)</span> is the undamaged transversely isotropic stiffness.</p>
<p><strong>Specific moduli degradation:</strong><ul class="simple">
<li><p><span class="math notranslate nohighlight">\( E_2 = E_{2,0} (1 - d_{22}) \)</span> (transverse Young’s modulus)</p></li>
<li><p><span class="math notranslate nohighlight">\( E_3 = E_{3,0} (1 - d_{22}) \)</span> (out-of-plane Young’s modulus)</p></li>
<li><p><span class="math notranslate nohighlight">\( G_{12} = G_{12,0} (1 - d_{12}) \)</span> (in-plane shear modulus)</p></li>
<li><p><span class="math notranslate nohighlight">\( G_{13} = G_{13,0} (1 - d_{12}) \)</span> (out-of-plane shear modulus)</p></li>
<li><p><span class="math notranslate nohighlight">\( E_1 \)</span> (fiber direction) remains constant (no fiber damage)</p></li>
</ul>
</p>
<p><strong>Thermodynamic Forces:</strong></p>
<p>The energy release rates driving damage evolution are:   <div class="math notranslate nohighlight">
\[Y_{22} = \frac{1}{2} \boldsymbol{\varepsilon}^e : \frac{\partial \mathbf{L}}{\partial d_{22}} : \boldsymbol{\varepsilon}^e
\]</div>
<div class="math notranslate nohighlight">
\[Y_{12} = \frac{1}{2} \boldsymbol{\varepsilon}^e : \frac{\partial \mathbf{L}}{\partial d_{12}} : \boldsymbol{\varepsilon}^e
\]</div>
</p>
<p><strong>Damage Evolution Laws:</strong></p>
<p><strong>Transverse Damage (d₂₂):</strong><div class="math notranslate nohighlight">
\[\begin{split}\dot{d}_{22} = \begin{cases}
0 &amp; \text{if } Y_{22} &lt; Y_{22,0} \\
\left( \frac{Y_{22} - Y_{22,c}}{Y_{22,u} - Y_{22,c}} \right)^b &amp; \text{if } Y_{22,0} \leq Y_{22} &lt; Y_{22,u} \\
\infty &amp; \text{if } Y_{22} \geq Y_{22,u}
\end{cases}
\end{split}\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( Y_{22,0} \)</span> is the damage initiation threshold</p></li>
<li><p><span class="math notranslate nohighlight">\( Y_{22,c} \)</span> is the characteristic energy release rate</p></li>
<li><p><span class="math notranslate nohighlight">\( Y_{22,u} \)</span> is the ultimate energy release rate (failure)</p></li>
<li><p><span class="math notranslate nohighlight">\( b \)</span> is the damage evolution exponent</p></li>
</ul>
</p>
<p><strong>Shear Damage (d₁₂):</strong><div class="math notranslate nohighlight">
\[\begin{split}\dot{d}_{12} = \begin{cases}
0 &amp; \text{if } Y_{12} &lt; Y_{12,0} \\
\frac{Y_{12} - Y_{12,c}}{Y_{12,c}} &amp; \text{if } Y_{12} \geq Y_{12,0}
\end{cases}
\end{split}\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( Y_{12,0} \)</span> is the shear damage initiation threshold</p></li>
<li><p><span class="math notranslate nohighlight">\( Y_{12,c} \)</span> is the characteristic shear energy release rate</p></li>
</ul>
</p>
<p><strong>Coupled Transverse-Shear Plasticity:</strong></p>
<p>A Hill-type yield criterion couples transverse and shear stresses:   <div class="math notranslate nohighlight">
\[\Phi = \sqrt{\left( \frac{\sigma_{22}}{A_{ts}} \right)^2 + \sigma_{12}^2} - \sigma_{ts,0} - \alpha_{ts} p_{ts} - \beta_{ts} p_{ts}^2 \leq 0
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( A_{ts} \)</span> is the transverse-shear coupling parameter</p></li>
<li><p><span class="math notranslate nohighlight">\( \sigma_{ts,0} \)</span> is the initial yield stress</p></li>
<li><p><span class="math notranslate nohighlight">\( \alpha_{ts}, \beta_{ts} \)</span> are hardening parameters</p></li>
<li><p><span class="math notranslate nohighlight">\( p_{ts} \)</span> is the accumulated plastic strain</p></li>
</ul>
</p>
<p><strong>Plastic Flow Rule:</strong></p>
<p>Associative flow in the transverse-shear plane:   <div class="math notranslate nohighlight">
\[\dot{\boldsymbol{\varepsilon}}^p = \dot{p}_{ts} \frac{\partial \Phi}{\partial \boldsymbol{\sigma}}
\]</div>
</p>
<p><strong>Material Parameters (props):</strong></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units   </p></th>
<th class="head"><p>Typical Range (CFRP)    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>props[0]   </p></td>
<td><p>axis   </p></td>
<td><p>Fiber orientation axis (1, 2, or 3)   </p></td>
<td><p>-   </p></td>
<td><p>1    </p></td>
</tr>
<tr class="row-odd"><td><p>props[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E_L \)</span></p></td>
<td><p>Longitudinal Young’s modulus   </p></td>
<td><p>Stress   </p></td>
<td><p>100-200 GPa    </p></td>
</tr>
<tr class="row-even"><td><p>props[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E_T \)</span></p></td>
<td><p>Transverse Young’s modulus   </p></td>
<td><p>Stress   </p></td>
<td><p>5-15 GPa    </p></td>
</tr>
<tr class="row-odd"><td><p>props[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \nu_{TL} \)</span></p></td>
<td><p>Major Poisson’s ratio   </p></td>
<td><p>-   </p></td>
<td><p>0.25-0.35    </p></td>
</tr>
<tr class="row-even"><td><p>props[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \nu_{TT} \)</span></p></td>
<td><p>Transverse Poisson’s ratio   </p></td>
<td><p>-   </p></td>
<td><p>0.35-0.45    </p></td>
</tr>
<tr class="row-odd"><td><p>props[5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( G_{LT} \)</span></p></td>
<td><p>In-plane shear modulus   </p></td>
<td><p>Stress   </p></td>
<td><p>3-8 GPa    </p></td>
</tr>
<tr class="row-even"><td><p>props[6]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \alpha_L \)</span></p></td>
<td><p>Longitudinal CTE   </p></td>
<td><p>1/Temperature   </p></td>
<td><p>-0.5 to 0 e-6 /K    </p></td>
</tr>
<tr class="row-odd"><td><p>props[7]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \alpha_T \)</span></p></td>
<td><p>Transverse CTE   </p></td>
<td><p>1/Temperature   </p></td>
<td><p>20-40 e-6 /K    </p></td>
</tr>
<tr class="row-even"><td><p>props[8]   </p></td>
<td><p><span class="math notranslate nohighlight">\( Y_{12,0} \)</span></p></td>
<td><p>Shear damage initiation threshold   </p></td>
<td><p>Energy/Volume   </p></td>
<td><p>0.05-0.2 MPa    </p></td>
</tr>
<tr class="row-odd"><td><p>props[9]   </p></td>
<td><p><span class="math notranslate nohighlight">\( Y_{12,c} \)</span></p></td>
<td><p>Characteristic shear energy release   </p></td>
<td><p>Energy/Volume   </p></td>
<td><p>0.1-0.5 MPa    </p></td>
</tr>
<tr class="row-even"><td><p>props[10]   </p></td>
<td><p><span class="math notranslate nohighlight">\( Y_{22,0} \)</span></p></td>
<td><p>Transverse damage initiation   </p></td>
<td><p>Energy/Volume   </p></td>
<td><p>0.1-0.3 MPa    </p></td>
</tr>
<tr class="row-odd"><td><p>props[11]   </p></td>
<td><p><span class="math notranslate nohighlight">\( Y_{22,c} \)</span></p></td>
<td><p>Characteristic transverse energy   </p></td>
<td><p>Energy/Volume   </p></td>
<td><p>0.2-0.6 MPa    </p></td>
</tr>
<tr class="row-even"><td><p>props[12]   </p></td>
<td><p><span class="math notranslate nohighlight">\( Y_{22,u} \)</span></p></td>
<td><p>Ultimate transverse energy   </p></td>
<td><p>Energy/Volume   </p></td>
<td><p>0.5-2.0 MPa    </p></td>
</tr>
<tr class="row-odd"><td><p>props[13]   </p></td>
<td><p><span class="math notranslate nohighlight">\( b \)</span></p></td>
<td><p>Transverse damage exponent   </p></td>
<td><p>-   </p></td>
<td><p>1-5    </p></td>
</tr>
<tr class="row-even"><td><p>props[14]   </p></td>
<td><p><span class="math notranslate nohighlight">\( A_{ts} \)</span></p></td>
<td><p>Transverse-shear coupling   </p></td>
<td><p>-   </p></td>
<td><p>1-3    </p></td>
</tr>
<tr class="row-odd"><td><p>props[15]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \sigma_{ts,0} \)</span></p></td>
<td><p>Initial yield stress   </p></td>
<td><p>Stress   </p></td>
<td><p>30-80 MPa    </p></td>
</tr>
<tr class="row-even"><td><p>props[16]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \alpha_{ts} \)</span></p></td>
<td><p>Linear hardening parameter   </p></td>
<td><p>Stress   </p></td>
<td><p>0-500 MPa    </p></td>
</tr>
<tr class="row-odd"><td><p>props[17]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \beta_{ts} \)</span></p></td>
<td><p>Quadratic hardening parameter   </p></td>
<td><p>Stress   </p></td>
<td><p>0-5000 MPa   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>State Variables (statev):</strong></p>
<p>Total state variables required: <span class="math notranslate nohighlight">\( n_{statev} = 10 \)</span></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>statev[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( T_{init} \)</span></p></td>
<td><p>Initial/reference temperature   </p></td>
<td><p>Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( d_{22} \)</span></p></td>
<td><p>Transverse damage variable   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-even"><td><p>statev[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( d_{12} \)</span></p></td>
<td><p>Shear damage variable   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( p_{ts} \)</span></p></td>
<td><p>Accumulated plastic strain   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{11} \)</span></p></td>
<td><p>Plastic strain component 11   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{22} \)</span></p></td>
<td><p>Plastic strain component 22   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[6]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{33} \)</span></p></td>
<td><p>Plastic strain component 33   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[7]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{12} \)</span></p></td>
<td><p>Plastic strain component 12 (engineering)   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[8]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{13} \)</span></p></td>
<td><p>Plastic strain component 13 (engineering)   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[9]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{23} \)</span></p></td>
<td><p>Plastic strain component 23 (engineering)   </p></td>
<td><p>Strain   </p></td>
</tr>
</tbody>
</table>
</p>
<p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>// Example usage: Carbon/Epoxy unidirectional composite (T300/914)
vec props(18);
props(0) = 1;           // axis = 1 (fibers along direction 1)
props(1) = 138000;      // EL = 138 GPa (fiber-dominated)
props(2) = 11000;       // ET = 11 GPa (matrix-dominated)
props(3) = 0.28;        // nuTL = 0.28
props(4) = 0.40;        // nuTT = 0.40
props(5) = 5500;        // GLT = 5.5 GPa
props(6) = -0.3e-6;     // alphaL = -0.3e-6 /K (negative for carbon fibers)
props(7) = 30e-6;       // alphaT = 30e-6 /K (resin dominated)
props(8) = 0.10;        // Y_12_0 = 0.10 MPa (shear damage threshold)
props(9) = 0.30;        // Y_12_c = 0.30 MPa
props(10) = 0.15;       // Y_22_0 = 0.15 MPa (transverse damage threshold)
props(11) = 0.40;       // Y_22_c = 0.40 MPa
props(12) = 1.20;       // Y_22_u = 1.20 MPa (ultimate failure)
props(13) = 2.5;        // b = 2.5
props(14) = 2.0;        // A_ts = 2.0
props(15) = 50;         // sigma_ts_0 = 50 MPa
props(16) = 300;        // alpha_ts = 300 MPa
props(17) = 1000;       // beta_ts = 1000 MPa

vec statev = zeros(10);
statev(0) = 20.0;  // Reference temperature 20°C

vec Etot = {0.0, 0.005, 0.0, 0.0, 0.0, 0.0};  // 0.5% transverse strain (induces damage)
vec DEtot = {0.0, 0.0001, 0.0, 0.0, 0.0, 0.0};
vec sigma = zeros(6);
mat Lt = zeros(6,6);
mat L = zeros(6,6);
vec sigma_in = zeros(6);
mat DR = eye(3,3);

umat_damage_LLD_0(Etot, DEtot, sigma, Lt, L, sigma_in, DR,
                  18, props, 10, statev, 20.0, 0.0, 0.0, 1.0,
                  Wm, Wm_r, Wm_ir, Wm_d, 3, 3, false, 0, tnew_dt);

// Check damage state
double d22 = statev(1);  // Transverse damage
double d12 = statev(2);  // Shear damage
cout &lt;&lt; &quot;Transverse damage: &quot; &lt;&lt; d22 &lt;&lt; &quot;, Shear damage: &quot; &lt;&lt; d12 &lt;&lt; endl;
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../continuum_mechanics/functions/constitutive.html#group__constitutive_1gaa951d85ed1016abbf57eccc0685bb4ff"><span class="std std-ref">L_isotrans()</span></a> for transversely isotropic stiffness construction </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Lagrange_exp() for penalty function (Damage Functions bounds enforcement) </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../simulation/maths.html#group__maths_1ga49348dc9b69d5ce97cd716c29a1397a9"><span class="std std-ref">rotate_strain()</span></a> for strain tensor rotation </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../simulation/maths.html#group__maths_1ga4aca74b2412c1c6a36ff9ebc0ac2cebc"><span class="std std-ref">rotate_stress()</span></a> for Stress Functions tensor rotation</p>
</div>
</p>
<p><strong>References:</strong><ul class="simple">
<li><p>Ladevèze, P., &amp; Le Dantec, E. (1992). “Damage modelling of the elementary ply for laminated composites.” <em>Composites Science and Technology</em>, 43(3), 257-267.</p></li>
<li><p>Allix, O., &amp; Ladevèze, P. (1992). “Interlaminar interface modelling for the prediction of delamination.” <em>Composite Structures</em>, 22(4), 235-242.</p></li>
<li><p>Ladevèze, P. (1992). “A damage computational method for composite structures.” <em>Computers &amp; Structures</em>, 44(1-2), 79-87.</p></li>
<li><p>Matzenmiller, A., Lubliner, J., &amp; Taylor, R. L. (1995). “A constitutive model for anisotropic damage in fiber-composites.” <em>Mechanics of Materials</em>, 20(2), 125-152.</p></li>
<li><p>Pinho, S. T., et al. (2012). “Material and structural response of polymer-matrix fibre-reinforced composites.” <em>Journal of Composite Materials</em>, 46(19-20), 2313-2341. </p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The LLD model is specifically designed for unidirectional fiber composites </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Damage is irreversible and monotonically increasing </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The model does NOT account for fiber failure (compression/tension in direction 1) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Suitable for matrix-dominated failure modes: transverse cracking, delamination </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Parameter identification requires multiple test configurations: </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>- Transverse tension for d₂₂ parameters </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>- In-plane shear for d₁₂ parameters </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>- Off-axis tests for plasticity coupling </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Convergence requires small load steps once damage initiates </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Material axes must be properly oriented relative to global coordinates</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Etot</strong> – Total strain tensor at beginning of increment (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>DEtot</strong> – Strain increment tensor (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>sigma</strong> – Stress tensor (Voigt notation: 6×1 vector) [output] </p></li>
<li><p><strong>Lt</strong> – Consistent tangent modulus (6×6 matrix) [output] </p></li>
<li><p><strong>L</strong> – Damaged elastic stiffness tensor (6×6 matrix) [output] </p></li>
<li><p><strong>sigma_in</strong> – Internal stress contribution for explicit solvers (6×1 vector) [output] </p></li>
<li><p><strong>DR</strong> – Rotation increment matrix (3×3) for objective integration </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Material properties vector (see table above) </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – State variables vector (see table above) [input/output] </p></li>
<li><p><strong>T</strong> – Temperature at beginning of increment </p></li>
<li><p><strong>DT</strong> – Temperature increment </p></li>
<li><p><strong>Time</strong> – Time at beginning of increment </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>Wm</strong> – Total mechanical work [output] </p></li>
<li><p><strong>Wm_r</strong> – Recoverable (elastic) work [output] </p></li>
<li><p><strong>Wm_ir</strong> – Irrecoverable work stored in damage [output] </p></li>
<li><p><strong>Wm_d</strong> – Dissipated work (damage + plasticity) [output] </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components (typically 3) </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components (typically 3) </p></li>
<li><p><strong>start</strong> – Flag indicating first increment (true) or continuation (false) </p></li>
<li><p><strong>solver_type</strong> – Solver type: 0=implicit, 1=explicit, 2=dynamic implicit </p></li>
<li><p><strong>tnew_dt</strong> – Suggested new time step size for adaptive time stepping [output]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419umat_damage_weibullRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd">
<span id="_CPPv319umat_damage_weibullRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="_CPPv219umat_damage_weibullRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="umat_damage_weibull__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matR.arma::vecR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.iCR.doubleR"></span><span class="target" id="group__umat__mechanical_1ga41717ca3ea28580d081aa56b7a6ca0fa"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_damage_weibull</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419umat_damage_weibullRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419umat_elasticity_isoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd">
<span id="_CPPv319umat_elasticity_isoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="_CPPv219umat_elasticity_isoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="umat_elasticity_iso__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matR.arma::vecR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.iCR.doubleR"></span><span class="target" id="group__umat__mechanical_1ga0512eae83fbcb2d1e3ebea42f823cb6e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_elasticity_iso</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">L</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma_in</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_ir</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_d</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">solver_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tnew_dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419umat_elasticity_isoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd" title="Link to this definition"></a><br /></dt>
<dd><p>Linear elastic isotropic constitutive model with thermal expansion. </p>
<p>This function implements the fundamental linear elastic isotropic material model based on Hooke’s law, suitable for small strain analysis of materials exhibiting reversible elastic deformation.</p>
<p><strong>Constitutive Equations:</strong></p>
<p>The stress-strain relationship follows the generalized Hooke’s law:   <div class="math notranslate nohighlight">
\[\boldsymbol{\sigma} = \mathbf{L} : (\boldsymbol{\varepsilon} - \boldsymbol{\varepsilon}^{th})
\]</div>
</p>
<p>where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \boldsymbol{\sigma} \)</span> is the stress tensor (Voigt notation)</p></li>
<li><p><span class="math notranslate nohighlight">\( \mathbf{L} \)</span> is the fourth-order elastic stiffness tensor</p></li>
<li><p><span class="math notranslate nohighlight">\( \boldsymbol{\varepsilon} \)</span> is the total strain tensor</p></li>
<li><p><span class="math notranslate nohighlight">\( \boldsymbol{\varepsilon}^{th} = \alpha (T - T_0) \mathbf{I} \)</span> is the thermal strain</p></li>
<li><p><span class="math notranslate nohighlight">\( \alpha \)</span> is the coefficient of thermal expansion</p></li>
<li><p><span class="math notranslate nohighlight">\( T \)</span> is the current temperature</p></li>
<li><p><span class="math notranslate nohighlight">\( T_0 \)</span> is the reference temperature</p></li>
</ul>
</p>
<p><strong>Elastic Stiffness Tensor:</strong></p>
<p>For an isotropic material, the stiffness tensor is constructed from two independent constants:   <div class="math notranslate nohighlight">
\[\mathbf{L} = 3K \mathbf{I}_{vol} + 2\mu \mathbf{I}_{dev}
\]</div>
</p>
<p>where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( K = \frac{E}{3(1-2\nu)} \)</span> is the bulk modulus</p></li>
<li><p><span class="math notranslate nohighlight">\( \mu = \frac{E}{2(1+\nu)} \)</span> is the shear modulus</p></li>
<li><p><span class="math notranslate nohighlight">\( \mathbf{I}_{vol} \)</span> is the volumetric projection tensor</p></li>
<li><p><span class="math notranslate nohighlight">\( \mathbf{I}_{dev} \)</span> is the deviatoric projection tensor</p></li>
</ul>
</p>
<p>In component form (Voigt notation):           <div class="math notranslate nohighlight">
\[\begin{split}\mathbf{L} = \frac{E}{(1+\nu)(1-2\nu)}
\begin{bmatrix}
1-\nu &amp; \nu &amp; \nu &amp; 0 &amp; 0 &amp; 0 \\
\nu &amp; 1-\nu &amp; \nu &amp; 0 &amp; 0 &amp; 0 \\
\nu &amp; \nu &amp; 1-\nu &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \frac{1-2\nu}{2} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1-2\nu}{2} &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1-2\nu}{2}
\end{bmatrix}
\end{split}\]</div>
</p>
<p><strong>Stress Update:</strong></p>
<p>For an increment of strain <span class="math notranslate nohighlight">\( \Delta \boldsymbol{\varepsilon} \)</span>:   <div class="math notranslate nohighlight">
\[\boldsymbol{\sigma}_{n+1} = \boldsymbol{\sigma}_n + \mathbf{L} : \left( \Delta \boldsymbol{\varepsilon} - \alpha \Delta T \mathbf{I} \right)
\]</div>
</p>
<p><strong>Tangent Modulus:</strong></p>
<p>For linear elasticity, the tangent modulus is constant and equal to the elastic stiffness:   <div class="math notranslate nohighlight">
\[\mathbf{L}_t = \mathbf{L}
\]</div>
</p>
<p>This ensures optimal convergence in Newton-Raphson iterations.</p>
<p><strong>Material Parameters (props):</strong></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units   </p></th>
<th class="head"><p>Typical Range    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>props[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E \)</span></p></td>
<td><p>Young’s modulus   </p></td>
<td><p>Stress   </p></td>
<td><p>1-500 GPa    </p></td>
</tr>
<tr class="row-odd"><td><p>props[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \nu \)</span></p></td>
<td><p>Poisson’s ratio   </p></td>
<td><p>-   </p></td>
<td><p>0.0-0.5    </p></td>
</tr>
<tr class="row-even"><td><p>props[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \alpha \)</span></p></td>
<td><p>Coefficient of thermal expansion   </p></td>
<td><p>1/Temperature   </p></td>
<td><p>1e-6 to 1e-4 /K   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>Constraint on Poisson’s ratio:</strong><ul class="simple">
<li><p>For 3D: <span class="math notranslate nohighlight">\( -1 &lt; \nu &lt; 0.5 \)</span></p></li>
<li><p><span class="math notranslate nohighlight">\( \nu = 0.5 \)</span> implies incompressibility (infinite bulk modulus)</p></li>
<li><p><span class="math notranslate nohighlight">\( \nu = 0 \)</span> implies no lateral strain under uniaxial loading</p></li>
</ul>
</p>
<p><strong>State Variables (statev):</strong></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>statev[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( T_{init} \)</span></p></td>
<td><p>Initial/reference temperature   </p></td>
<td><p>Temperature   </p></td>
</tr>
</tbody>
</table>
</p>
<p>Total state variables required: <span class="math notranslate nohighlight">\( n_{statev} = 1 \)</span></p>
<p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>// Example usage: Steel
vec props = {210000, 0.3, 1.2e-5};  // E=210 GPa, nu=0.3, alpha=12e-6 /K
vec statev = zeros(1);
statev(0) = 20.0;  // Reference temperature 20°C

vec Etot = {0.001, 0.0, 0.0, 0.0, 0.0, 0.0};  // 0.1% strain in direction 1
vec DEtot = {0.0001, 0.0, 0.0, 0.0, 0.0, 0.0};
vec sigma = zeros(6);
mat Lt = zeros(6,6);
mat L = zeros(6,6);
vec sigma_in = zeros(6);
mat DR = eye(3,3);

umat_elasticity_iso(Etot, DEtot, sigma, Lt, L, sigma_in, DR,
                    3, props, 1, statev, 25.0, 5.0, 0.0, 1.0,
                    Wm, Wm_r, Wm_ir, Wm_d, 3, 3, false, 0, tnew_dt);

// Expected stress: sigma(0) ≈ E*Etot(0)*(1-nu)/((1+nu)(1-2nu)) - E*alpha*DT/(1-2nu)
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../continuum_mechanics/functions/constitutive.html#group__constitutive_1gaf485036362aaf2d53d4057c64b16cba8"><span class="std std-ref">L_iso()</span></a> for elastic stiffness tensor construction </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../continuum_mechanics/functions/constitutive.html#group__constitutive_1ga26aa9d2e852a11d4de1edc0574468218"><span class="std std-ref">Ivol()</span></a> for volumetric projection tensor </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../continuum_mechanics/functions/constitutive.html#group__constitutive_1ga8d4770913e5c1d521a6aaf9ae3d2bb8d"><span class="std std-ref">Idev()</span></a> for deviatoric projection tensor </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../continuum_mechanics/functions/constitutive.html#group__constitutive_1ga6fbc336c70448cf768ecb12305f8b684"><span class="std std-ref">Ith()</span></a> for thermal expansion vector</p>
</div>
</p>
<p><strong>References:</strong><ul class="simple">
<li><p>Timoshenko, S. P., &amp; Goodier, J. N. (1970). <em>Theory of Elasticity</em> (3rd ed.). McGraw-Hill.</p></li>
<li><p>Bower, A. F. (2009). <em>Applied Mechanics of Solids</em>. CRC Press.</p></li>
<li><p>Gurtin, M. E. (1981). <em>An Introduction to Continuum Mechanics</em>. Academic Press. </p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This model is restricted to small strains (&lt; 1%) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For large strains, use hyperelastic models (Neo-Hookean, Mooney-Rivlin) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The model is path-independent (no history dependence) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>No energy dissipation occurs (Wm_ir = Wm_d = 0, Wm = Wm_r) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For plane stress/strain, set ndi=2 or ndi=1 accordingly</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Etot</strong> – Total strain tensor at beginning of increment (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>DEtot</strong> – Strain increment tensor (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>sigma</strong> – Stress tensor (Voigt notation: 6×1 vector) [output] </p></li>
<li><p><strong>Lt</strong> – Tangent modulus <span class="math notranslate nohighlight">\( \mathbf{L}_t = \mathbf{L} \)</span> (6×6 matrix) [output] </p></li>
<li><p><strong>L</strong> – Elastic stiffness tensor (6×6 matrix) [output] </p></li>
<li><p><strong>sigma_in</strong> – Internal stress contribution for explicit solvers (6×1 vector) [output] </p></li>
<li><p><strong>DR</strong> – Rotation increment matrix (3×3) for objective integration </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Material properties vector (see table above) </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – State variables vector (see table above) [input/output] </p></li>
<li><p><strong>T</strong> – Temperature at beginning of increment </p></li>
<li><p><strong>DT</strong> – Temperature increment </p></li>
<li><p><strong>Time</strong> – Time at beginning of increment </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>Wm</strong> – Total mechanical work [output] </p></li>
<li><p><strong>Wm_r</strong> – Recoverable (elastic) work [output] </p></li>
<li><p><strong>Wm_ir</strong> – Irrecoverable work (0 for elastic model) [output] </p></li>
<li><p><strong>Wm_d</strong> – Dissipated work (0 for elastic model) [output] </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components (typically 3) </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components (typically 3) </p></li>
<li><p><strong>start</strong> – Flag indicating first increment (true) or continuation (false) </p></li>
<li><p><strong>solver_type</strong> – Solver type: 0=implicit, 1=explicit, 2=dynamic implicit </p></li>
<li><p><strong>tnew_dt</strong> – Suggested new time step size for adaptive time stepping [output]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421umat_elasticity_orthoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd">
<span id="_CPPv321umat_elasticity_orthoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="_CPPv221umat_elasticity_orthoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="umat_elasticity_ortho__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matR.arma::vecR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.iCR.doubleR"></span><span class="target" id="group__umat__mechanical_1ga35f48d3fe23c0b2032c7173a85e029ff"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_elasticity_ortho</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421umat_elasticity_orthoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd" title="Link to this definition"></a><br /></dt>
<dd><p>The elastic UMAT requires 2 constants: </p>
<p>props[0] : Young modulus</p>
<p>props[1] : Poisson ratio</p>
<p>props[2] : CTE</p>
<p>No statev is required for thermoelastic constitutive law </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425umat_elasticity_trans_isoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd">
<span id="_CPPv325umat_elasticity_trans_isoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="_CPPv225umat_elasticity_trans_isoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="umat_elasticity_trans_iso__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matR.arma::vecR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.iCR.doubleR"></span><span class="target" id="group__umat__mechanical_1ga89d360dc3f49c3c3ed8184065b185707"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_elasticity_trans_iso</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425umat_elasticity_trans_isoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd" title="Link to this definition"></a><br /></dt>
<dd><p>The elastic UMAT requires 2 constants: </p>
<p>props[0] : Young modulus</p>
<p>props[1] : Poisson ratio</p>
<p>props[2] : CTE</p>
<p>No statev is required for thermoelastic constitutive law </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421umat_ani_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd">
<span id="_CPPv321umat_ani_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="_CPPv221umat_ani_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="umat_ani_chaboche_CCP__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matR.arma::vecR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.iCR.doubleR"></span><span class="target" id="group__umat__mechanical_1gaf7f7d4a14cdf27388a61e7ac1068a531"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_ani_chaboche_CCP</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">L</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma_in</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_ir</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_d</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">solver_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tnew_dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421umat_ani_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd" title="Link to this definition"></a><br /></dt>
<dd><p>Elastic-plastic model with general anisotropic yield criterion and Chaboche kinematic hardening. </p>
<p>This function implements an advanced anisotropic plasticity model combining a general quadratic anisotropic yield criterion with Chaboche nonlinear kinematic hardening. This model provides maximum flexibility for capturing complex anisotropic cyclic plasticity behavior.</p>
<p><strong>Key Features:</strong><ul class="simple">
<li><p>General quadratic anisotropic yield criterion (21 independent parameters)</p></li>
<li><p>Multiple Armstrong-Frederick backstresses for nonlinear kinematic hardening</p></li>
<li><p>Optional Voce-type isotropic hardening</p></li>
<li><p>Convex Cutting Plane algorithm for return mapping</p></li>
<li><p>Consistent tangent modulus for implicit FE analysis</p></li>
</ul>
</p>
<p><strong>General Anisotropic Yield Function:</strong></p>
<p>The yield function is defined as:   <div class="math notranslate nohighlight">
\[\Phi(\boldsymbol{\sigma}, \mathbf{X}, p) = \sqrt{(\boldsymbol{\sigma} - \mathbf{X}) : \mathbf{H} : (\boldsymbol{\sigma} - \mathbf{X})} - R(p) - \sigma_Y \leq 0
\]</div>
 where <span class="math notranslate nohighlight">\( \mathbf{H} \)</span> is a general fourth-order anisotropy tensor with up to 21 independent components for a fully anisotropic material.</p>
<p>**Anisotropy Tensor <span class="math notranslate nohighlight">\( \mathbf{H} \)</span>:**</p>
<p>In Voigt notation, the anisotropy tensor is represented as a 6×6 symmetric matrix:          <div class="math notranslate nohighlight">
\[\begin{split}\mathbf{H} = \begin{bmatrix}
H_{11} &amp; H_{12} &amp; H_{13} &amp; H_{14} &amp; H_{15} &amp; H_{16} \\
H_{12} &amp; H_{22} &amp; H_{23} &amp; H_{24} &amp; H_{25} &amp; H_{26} \\
H_{13} &amp; H_{23} &amp; H_{33} &amp; H_{34} &amp; H_{35} &amp; H_{36} \\
H_{14} &amp; H_{24} &amp; H_{34} &amp; H_{44} &amp; H_{45} &amp; H_{46} \\
H_{15} &amp; H_{25} &amp; H_{35} &amp; H_{45} &amp; H_{55} &amp; H_{56} \\
H_{16} &amp; H_{26} &amp; H_{36} &amp; H_{46} &amp; H_{56} &amp; H_{66}
\end{bmatrix}
\end{split}\]</div>
</p>
<p><strong>Special Cases:</strong></p>
<p><ul class="simple">
<li><p><strong>von Mises (isotropic)</strong>: <span class="math notranslate nohighlight">\( \mathbf{H} = \mathbf{I}_{dev} \)</span> (deviatoric identity)</p></li>
<li><p><strong>Hill orthotropic</strong>: <span class="math notranslate nohighlight">\( H_{ij} = 0 \)</span> for <span class="math notranslate nohighlight">\( i \leq 3 &lt; j \)</span> or <span class="math notranslate nohighlight">\( j \leq 3 &lt; i \)</span></p></li>
<li><p><strong>Transversely isotropic</strong>: 5 independent parameters</p></li>
</ul>
</p>
<p><strong>Armstrong-Frederick Backstress Evolution:</strong></p>
<p>Each backstress component evolves according to:   <div class="math notranslate nohighlight">
\[\dot{\mathbf{X}}_i = \frac{2}{3} C_i \dot{\boldsymbol{\varepsilon}}^p - D_i \mathbf{X}_i \dot{p}
\]</div>
</p>
<p><strong>Isotropic Hardening (Voce Law):</strong></p>
<p><div class="math notranslate nohighlight">
\[R(p) = \sum_{j=1}^{N_{iso}} Q_j (1 - e^{-b_j p})
\]</div>
</p>
<p><strong>Applications:</strong></p>
<p>This model is suited for:<ul class="simple">
<li><p>Single crystals with complex slip system interactions</p></li>
<li><p>Highly textured polycrystals requiring full anisotropy</p></li>
<li><p>Materials with non-orthotropic symmetry (monoclinic, triclinic)</p></li>
<li><p>Advanced composite materials with complex anisotropy</p></li>
</ul>
</p>
<p><strong>State Variables (statev):</strong></p>
<p>Total: <span class="math notranslate nohighlight">\( n_{statev} = 1 + 1 + 6 + 6 \times N_{kin} \)</span></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>statev[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( T_{init} \)</span></p></td>
<td><p>Initial temperature   </p></td>
<td><p>Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( p \)</span></p></td>
<td><p>Accumulated plastic strain   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[2:7]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \boldsymbol{\varepsilon}^p \)</span></p></td>
<td><p>Plastic strain tensor (Voigt)   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[8+6i:13+6i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \mathbf{X}_i \)</span></p></td>
<td><p>Backstress i (Voigt)   </p></td>
<td><p>Stress   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>References:</strong><ul class="simple">
<li><p>Chaboche, J. L. (1986). “Time-independent constitutive theories for cyclic plasticity.” <em>Int. J. Plasticity</em>, 2(2), 149-188.</p></li>
<li><p>Barlat, F., et al. (2005). “Linear transformation-based anisotropic yield functions.” <em>Int. J. Plasticity</em>, 21(5), 1009-1039. </p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__umat__mechanical_1ga6c153aa10feac4477e39cd4bc610dd66"><span class="std std-ref">umat_hill_chaboche_CCP()</span></a> for orthotropic Hill + Chaboche </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__umat__mechanical_1gad0775f735c8fc1e7adfc1f4e5a31dce2"><span class="std std-ref">umat_plasticity_chaboche_CCP()</span></a> for isotropic von Mises + Chaboche</p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The anisotropy tensor must be positive semi-definite for convexity </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For orthotropic materials, consider using Hill_chaboche_ccp instead </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Parameter identification requires extensive multiaxial testing</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Etot</strong> – Total strain tensor at beginning of increment (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>DEtot</strong> – Strain increment tensor (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>sigma</strong> – Stress tensor (Voigt notation: 6×1 vector) [output] </p></li>
<li><p><strong>Lt</strong> – Consistent tangent modulus (6×6 matrix) [output] </p></li>
<li><p><strong>L</strong> – Elastic stiffness tensor (6×6 matrix) [output] </p></li>
<li><p><strong>sigma_in</strong> – Internal stress for explicit solvers (6×1 vector) [output] </p></li>
<li><p><strong>DR</strong> – Rotation increment matrix (3×3) for objective integration </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Material properties vector </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – State variables vector [input/output] </p></li>
<li><p><strong>T</strong> – Temperature at beginning of increment </p></li>
<li><p><strong>DT</strong> – Temperature increment </p></li>
<li><p><strong>Time</strong> – Time at beginning of increment </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>Wm</strong> – Total mechanical work [output] </p></li>
<li><p><strong>Wm_r</strong> – Recoverable (elastic) work [output] </p></li>
<li><p><strong>Wm_ir</strong> – Irrecoverable work stored in hardening [output] </p></li>
<li><p><strong>Wm_d</strong> – Dissipated (plastic) work [output] </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components (typically 3) </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components (typically 3) </p></li>
<li><p><strong>start</strong> – Flag indicating first increment (true) or continuation (false) </p></li>
<li><p><strong>solver_type</strong> – Solver type: 0=implicit, 1=explicit, 2=dynamic implicit </p></li>
<li><p><strong>tnew_dt</strong> – Suggested new time step size for adaptive time stepping [output]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421umat_dfa_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd">
<span id="_CPPv321umat_dfa_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="_CPPv221umat_dfa_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="umat_dfa_chaboche_CCP__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matR.arma::vecR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.iCR.doubleR"></span><span class="target" id="group__umat__mechanical_1ga99fd004994a08162f998769bfab6291e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_dfa_chaboche_CCP</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">L</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma_in</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_ir</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_d</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">solver_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tnew_dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421umat_dfa_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd" title="Link to this definition"></a><br /></dt>
<dd><p>Elastic-plastic model with Distortional/Directional Forming Anisotropy (DFA) and Chaboche hardening. </p>
<p>This function implements an advanced plasticity model that captures the evolution of plastic anisotropy during deformation (distortional hardening). Unlike classical models where the yield surface only translates (kinematic) or expands (isotropic), the DFA model allows the yield surface shape to evolve with plastic straining.</p>
<p><strong>Key Features:</strong><ul class="simple">
<li><p>Distortional hardening: yield surface shape evolves with deformation</p></li>
<li><p>Multiple Armstrong-Frederick backstresses for kinematic hardening</p></li>
<li><p>Optional Voce-type isotropic hardening</p></li>
<li><p>Captures cross-hardening and directional effects</p></li>
<li><p>Convex Cutting Plane algorithm for return mapping</p></li>
</ul>
</p>
<p><strong>Physical Motivation:</strong></p>
<p>Classical hardening models (isotropic + kinematic) cannot capture:<ul class="simple">
<li><p><strong>Cross-hardening</strong>: Yield stress in one direction affected by prior loading in another</p></li>
<li><p><strong>Permanent softening</strong>: Reduced yield in tension after prior compression (or vice versa)</p></li>
<li><p><strong>Yield surface distortion</strong>: Changes in yield locus shape observed in metals after pre-straining</p></li>
</ul>
</p>
<p>The DFA model addresses these limitations by allowing the anisotropy tensor <span class="math notranslate nohighlight">\( \mathbf{H} \)</span> to evolve with plastic deformation.</p>
<p><strong>Yield Function with Evolving Anisotropy:</strong></p>
<p><div class="math notranslate nohighlight">
\[\Phi = \sqrt{(\boldsymbol{\sigma} - \mathbf{X}) : \mathbf{H}(p, \boldsymbol{\varepsilon}^p) : (\boldsymbol{\sigma} - \mathbf{X})} - R(p) - \sigma_Y \leq 0
\]</div>
</p>
<p>where the anisotropy tensor <span class="math notranslate nohighlight">\( \mathbf{H} \)</span> evolves according to:   <div class="math notranslate nohighlight">
\[\dot{\mathbf{H}} = f(\mathbf{H}, \boldsymbol{\sigma}, \dot{\boldsymbol{\varepsilon}}^p, \dot{p})
\]</div>
</p>
<p><strong>Directional Hardening:</strong></p>
<p>The model tracks directional hardening through internal variables that remember the loading history orientation. This allows capturing:<ul class="simple">
<li><p><strong>Latent hardening</strong>: Increased yield stress in inactive slip systems</p></li>
<li><p><strong>Texture evolution effects</strong>: Macroscopic manifestation of microstructural changes</p></li>
<li><p><strong>Anisotropic damage accumulation</strong>: Direction-dependent material degradation</p></li>
</ul>
</p>
<p><strong>Applications:</strong></p>
<p><ul class="simple">
<li><p>Sheet metal forming with complex strain paths</p></li>
<li><p>Materials exhibiting strong cross-hardening (aluminum alloys, TWIP steels)</p></li>
<li><p>Multi-pass forming operations with changing strain directions</p></li>
<li><p>Accurate springback prediction in automotive stamping</p></li>
</ul>
</p>
<p><strong>State Variables (statev):</strong></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>statev[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( T_{init} \)</span></p></td>
<td><p>Initial temperature   </p></td>
<td><p>Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( p \)</span></p></td>
<td><p>Accumulated plastic strain   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[2:7]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \boldsymbol{\varepsilon}^p \)</span></p></td>
<td><p>Plastic strain tensor (Voigt)   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[8+6i:13+6i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \mathbf{X}_i \)</span></p></td>
<td><p>Backstress i (Voigt)   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>statev[…]   </p></td>
<td><p><span class="math notranslate nohighlight">\( H_{ij} \)</span></p></td>
<td><p>Evolving anisotropy components   </p></td>
<td><p>-   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>References:</strong><ul class="simple">
<li><p>Barlat, F., et al. (2011). “An alternative to kinematic hardening in classical plasticity.” <em>Int. J. Plasticity</em>, 27(9), 1309-1327.</p></li>
<li><p>Teodosiu, C., &amp; Hu, Z. (1998). “Microstructure in the continuum modeling of plastic anisotropy.” <em>Proc. 19th Riso Int. Symp.</em>, 149-168.</p></li>
<li><p>Holmedal, B. (2019). “Bauschinger effect modelled by yield surface distortions.” <em>Int. J. Plasticity</em>, 123, 86-100. </p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__umat__mechanical_1gad0775f735c8fc1e7adfc1f4e5a31dce2"><span class="std std-ref">umat_plasticity_chaboche_CCP()</span></a> for standard Chaboche without distortional hardening </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__umat__mechanical_1gaf7f7d4a14cdf27388a61e7ac1068a531"><span class="std std-ref">umat_ani_chaboche_CCP()</span></a> for fixed anisotropy Chaboche</p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Requires careful parameter identification from cross-hardening tests </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Computationally more expensive than standard Chaboche due to evolving anisotropy </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Useful for complex forming simulations with strain path changes</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Etot</strong> – Total strain tensor at beginning of increment (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>DEtot</strong> – Strain increment tensor (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>sigma</strong> – Stress tensor (Voigt notation: 6×1 vector) [output] </p></li>
<li><p><strong>Lt</strong> – Consistent tangent modulus (6×6 matrix) [output] </p></li>
<li><p><strong>L</strong> – Elastic stiffness tensor (6×6 matrix) [output] </p></li>
<li><p><strong>sigma_in</strong> – Internal stress for explicit solvers (6×1 vector) [output] </p></li>
<li><p><strong>DR</strong> – Rotation increment matrix (3×3) for objective integration </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Material properties vector </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – State variables vector [input/output] </p></li>
<li><p><strong>T</strong> – Temperature at beginning of increment </p></li>
<li><p><strong>DT</strong> – Temperature increment </p></li>
<li><p><strong>Time</strong> – Time at beginning of increment </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>Wm</strong> – Total mechanical work [output] </p></li>
<li><p><strong>Wm_r</strong> – Recoverable (elastic) work [output] </p></li>
<li><p><strong>Wm_ir</strong> – Irrecoverable work stored in hardening [output] </p></li>
<li><p><strong>Wm_d</strong> – Dissipated (plastic) work [output] </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components (typically 3) </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components (typically 3) </p></li>
<li><p><strong>start</strong> – Flag indicating first increment (true) or continuation (false) </p></li>
<li><p><strong>solver_type</strong> – Solver type: 0=implicit, 1=explicit, 2=dynamic implicit </p></li>
<li><p><strong>tnew_dt</strong> – Suggested new time step size for adaptive time stepping [output]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425umat_generic_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd">
<span id="_CPPv325umat_generic_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="_CPPv225umat_generic_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="umat_generic_chaboche_CCP__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matR.arma::vecR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.iCR.doubleR"></span><span class="target" id="group__umat__mechanical_1ga646983ffbb802905b2c33d1e83770402"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_generic_chaboche_CCP</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">L</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma_in</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_ir</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_d</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">solver_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tnew_dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425umat_generic_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd" title="Link to this definition"></a><br /></dt>
<dd><p>Generic elastic-plastic framework with flexible yield criterion and Chaboche kinematic hardening. </p>
<p>This function implements a generic plasticity framework that allows for flexible configuration of the yield criterion while using Chaboche-type hardening. It serves as a template for implementing various plasticity models with different yield functions.</p>
<p><strong>Key Features:</strong><ul class="simple">
<li><p>Configurable yield criterion through function pointers or template parameters</p></li>
<li><p>Multiple Armstrong-Frederick backstresses for nonlinear kinematic hardening</p></li>
<li><p>Optional Voce-type isotropic hardening</p></li>
<li><p>Convex Cutting Plane algorithm for return mapping</p></li>
<li><p>Consistent tangent modulus for implicit FE analysis</p></li>
</ul>
</p>
<p><strong>Generic Yield Function:</strong></p>
<p>The yield function takes the general form:   <div class="math notranslate nohighlight">
\[\Phi(\boldsymbol{\sigma}, \mathbf{X}, p, \boldsymbol{\alpha}) = f(\boldsymbol{\sigma} - \mathbf{X}) - R(p) - \sigma_Y \leq 0
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( f(\boldsymbol{\eta}) \)</span> is a general equivalent stress function (configurable)</p></li>
<li><p><span class="math notranslate nohighlight">\( \boldsymbol{\alpha} \)</span> represents additional internal variables</p></li>
</ul>
</p>
<p><strong>Supported Yield Criteria:</strong></p>
<p>The generic framework can accommodate:<ul class="simple">
<li><p><strong>von Mises</strong>: <span class="math notranslate nohighlight">\( f = \sqrt{\frac{3}{2} \mathbf{s}:\mathbf{s}} \)</span></p></li>
<li><p><strong>Hill (1948)</strong>: Quadratic orthotropic</p></li>
<li><p><strong>Barlat Yld2000-2d</strong>: Advanced anisotropic for sheet metals</p></li>
<li><p><strong>Drucker-Prager</strong>: Pressure-dependent for geomaterials</p></li>
<li><p><strong>Hosford</strong>: Non-quadratic isotropic</p></li>
<li><p><strong>Custom user-defined</strong>: Through function interface</p></li>
</ul>
</p>
<p><strong>Armstrong-Frederick Backstress Evolution:</strong></p>
<p>Each backstress evolves according to:   <div class="math notranslate nohighlight">
\[\dot{\mathbf{X}}_i = \frac{2}{3} C_i \dot{\boldsymbol{\varepsilon}}^p - D_i \mathbf{X}_i \dot{p}
\]</div>
</p>
<p><strong>Isotropic Hardening (Voce Law):</strong></p>
<p><div class="math notranslate nohighlight">
\[R(p) = \sum_{j=1}^{N_{iso}} Q_j (1 - e^{-b_j p})
\]</div>
</p>
<p><strong>Framework Architecture:</strong></p>
<p>The generic model separates:<ol class="loweralpha simple">
<li><p><strong>Yield criterion evaluation</strong>: <span class="math notranslate nohighlight">\( f(\boldsymbol{\eta}) \)</span> and <span class="math notranslate nohighlight">\( \partial f / \partial \boldsymbol{\eta} \)</span></p></li>
<li><p><strong>Hardening laws</strong>: Evolution of <span class="math notranslate nohighlight">\( \mathbf{X}_i \)</span> and <span class="math notranslate nohighlight">\( R \)</span></p></li>
<li><p><strong>Return mapping</strong>: CCP algorithm for stress update</p></li>
<li><p><strong>Consistent tangent</strong>: Algorithmic modulus computation</p></li>
</ol>
</p>
<p>This allows easy extension to new yield criteria while reusing the hardening and integration framework.</p>
<p><strong>State Variables (statev):</strong></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>statev[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( T_{init} \)</span></p></td>
<td><p>Initial temperature   </p></td>
<td><p>Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( p \)</span></p></td>
<td><p>Accumulated plastic strain   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[2:7]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \boldsymbol{\varepsilon}^p \)</span></p></td>
<td><p>Plastic strain tensor (Voigt)   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[8+6i:13+6i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \mathbf{X}_i \)</span></p></td>
<td><p>Backstress i (Voigt)   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>statev[…]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \boldsymbol{\alpha} \)</span></p></td>
<td><p>Additional criterion-specific variables   </p></td>
<td><p>-   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>References:</strong><ul class="simple">
<li><p>Chaboche, J. L. (2008). “A review of some plasticity and viscoplasticity constitutive theories.” <em>Int. J. Plasticity</em>, 24(10), 1642-1693.</p></li>
<li><p>Simo, J. C., &amp; Hughes, T. J. R. (1998). <em>Computational Inelasticity</em>. Springer. </p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__umat__mechanical_1gad0775f735c8fc1e7adfc1f4e5a31dce2"><span class="std std-ref">umat_plasticity_chaboche_CCP()</span></a> for standard von Mises Chaboche </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__umat__mechanical_1ga6c153aa10feac4477e39cd4bc610dd66"><span class="std std-ref">umat_hill_chaboche_CCP()</span></a> for Hill anisotropic Chaboche </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__umat__mechanical_1gaf7f7d4a14cdf27388a61e7ac1068a531"><span class="std std-ref">umat_ani_chaboche_CCP()</span></a> for general anisotropic Chaboche</p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use this as a base for implementing new yield criteria </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Requires implementation of yield function and its derivatives </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See specialized models (Hill, Ani) for specific applications</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Etot</strong> – Total strain tensor at beginning of increment (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>DEtot</strong> – Strain increment tensor (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>sigma</strong> – Stress tensor (Voigt notation: 6×1 vector) [output] </p></li>
<li><p><strong>Lt</strong> – Consistent tangent modulus (6×6 matrix) [output] </p></li>
<li><p><strong>L</strong> – Elastic stiffness tensor (6×6 matrix) [output] </p></li>
<li><p><strong>sigma_in</strong> – Internal stress for explicit solvers (6×1 vector) [output] </p></li>
<li><p><strong>DR</strong> – Rotation increment matrix (3×3) for objective integration </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Material properties vector (criterion-dependent) </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – State variables vector [input/output] </p></li>
<li><p><strong>T</strong> – Temperature at beginning of increment </p></li>
<li><p><strong>DT</strong> – Temperature increment </p></li>
<li><p><strong>Time</strong> – Time at beginning of increment </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>Wm</strong> – Total mechanical work [output] </p></li>
<li><p><strong>Wm_r</strong> – Recoverable (elastic) work [output] </p></li>
<li><p><strong>Wm_ir</strong> – Irrecoverable work stored in hardening [output] </p></li>
<li><p><strong>Wm_d</strong> – Dissipated (plastic) work [output] </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components (typically 3) </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components (typically 3) </p></li>
<li><p><strong>start</strong> – Flag indicating first increment (true) or continuation (false) </p></li>
<li><p><strong>solver_type</strong> – Solver type: 0=implicit, 1=explicit, 2=dynamic implicit </p></li>
<li><p><strong>tnew_dt</strong> – Suggested new time step size for adaptive time stepping [output]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422umat_hill_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd">
<span id="_CPPv322umat_hill_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="_CPPv222umat_hill_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="umat_hill_chaboche_CCP__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matR.arma::vecR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.iCR.doubleR"></span><span class="target" id="group__umat__mechanical_1ga6c153aa10feac4477e39cd4bc610dd66"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_hill_chaboche_CCP</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">L</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma_in</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_ir</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_d</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">solver_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tnew_dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422umat_hill_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd" title="Link to this definition"></a><br /></dt>
<dd><p>Elastic-plastic model combining Hill anisotropic yield criterion with Chaboche kinematic hardening. </p>
<p>This function implements an advanced plasticity model combining the Hill (1948) anisotropic yield criterion with Chaboche nonlinear kinematic hardening. This allows modeling of anisotropic materials under cyclic loading conditions. The model features:<ul class="simple">
<li><p>Hill (1948) quadratic anisotropic yield criterion</p></li>
<li><p>Multiple Armstrong-Frederick backstresses for nonlinear kinematic hardening</p></li>
<li><p>Optional Voce-type isotropic hardening</p></li>
<li><p>Convex Cutting Plane algorithm for return mapping</p></li>
<li><p>Consistent tangent modulus for implicit FE analysis</p></li>
</ul>
</p>
<p><strong>Constitutive Equations:</strong></p>
<p>The anisotropic yield function with kinematic hardening is defined as:   <div class="math notranslate nohighlight">
\[\Phi(\boldsymbol{\sigma}, \mathbf{X}, p) = \sigma_{eq}^{Hill}(\boldsymbol{\sigma} - \mathbf{X}) - R(p) - \sigma_Y \leq 0
\]</div>
 where the Hill equivalent stress of the shifted stress tensor is:   <div class="math notranslate nohighlight">
\[\sigma_{eq}^{Hill}(\boldsymbol{\eta}) = \sqrt{\boldsymbol{\eta} : \mathbf{P}^{Hill} : \boldsymbol{\eta}}
\]</div>
 with <span class="math notranslate nohighlight">\( \boldsymbol{\eta} = \boldsymbol{\sigma} - \mathbf{X} \)</span> being the effective (shifted) stress.</p>
<p><strong>Hill Anisotropic Yield Surface:</strong></p>
<p>The Hill projection tensor <span class="math notranslate nohighlight">\( \mathbf{P}^{Hill} \)</span> is defined by six parameters <span class="math notranslate nohighlight">\( (F, G, H, L, M, N) \)</span>:   <div class="math notranslate nohighlight">
\[(\sigma_{eq}^{Hill})^2 = F(\eta_{22} - \eta_{33})^2 + G(\eta_{33} - \eta_{11})^2 + H(\eta_{11} - \eta_{22})^2 + 2L\eta_{23}^2 + 2M\eta_{13}^2 + 2N\eta_{12}^2
\]</div>
</p>
<p><strong>Armstrong-Frederick Backstress Evolution:</strong></p>
<p>Each backstress component evolves with dynamic recovery:   <div class="math notranslate nohighlight">
\[\dot{\mathbf{X}}_i = \frac{2}{3} C_i \dot{\boldsymbol{\varepsilon}}^p - D_i \mathbf{X}_i \dot{p}
\]</div>
 where the total backstress is: <span class="math notranslate nohighlight">\( \mathbf{X} = \sum_{i=1}^{N_{kin}} \mathbf{X}_i \)</span></p>
<p><strong>Flow Rule:</strong></p>
<p>The plastic strain rate follows the associative flow rule:   <div class="math notranslate nohighlight">
\[\dot{\boldsymbol{\varepsilon}}^p = \dot{p} \frac{\partial \Phi}{\partial \boldsymbol{\sigma}} = \dot{p} \frac{\mathbf{P}^{Hill} : \boldsymbol{\eta}}{\sigma_{eq}^{Hill}(\boldsymbol{\eta})}
\]</div>
</p>
<p><strong>Applications:</strong></p>
<p>This model is suited for:<ul class="simple">
<li><p>Rolled sheet metals under cyclic loading</p></li>
<li><p>Textured polycrystalline materials with Bauschinger effect</p></li>
<li><p>Drawn tubes and wires with anisotropic yield and kinematic hardening</p></li>
<li><p>Any orthotropic material exhibiting cyclic plasticity</p></li>
</ul>
</p>
<p><strong>Material Parameters (props):</strong></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>props[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E \)</span></p></td>
<td><p>Young’s modulus   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>props[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \nu \)</span></p></td>
<td><p>Poisson’s ratio   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-even"><td><p>props[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \alpha \)</span></p></td>
<td><p>Thermal expansion coefficient   </p></td>
<td><p>1/Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>props[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \sigma_Y \)</span></p></td>
<td><p>Initial yield stress   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>props[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( N_{iso} \)</span></p></td>
<td><p>Number of isotropic hardening terms   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-odd"><td><p>props[5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( N_{kin} \)</span></p></td>
<td><p>Number of kinematic hardening terms   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-even"><td><p>props[6]   </p></td>
<td><p><span class="math notranslate nohighlight">\( F \)</span></p></td>
<td><p>Hill parameter F   </p></td>
<td><p>1/Stress²    </p></td>
</tr>
<tr class="row-odd"><td><p>props[7]   </p></td>
<td><p><span class="math notranslate nohighlight">\( G \)</span></p></td>
<td><p>Hill parameter G   </p></td>
<td><p>1/Stress²    </p></td>
</tr>
<tr class="row-even"><td><p>props[8]   </p></td>
<td><p><span class="math notranslate nohighlight">\( H \)</span></p></td>
<td><p>Hill parameter H   </p></td>
<td><p>1/Stress²    </p></td>
</tr>
<tr class="row-odd"><td><p>props[9]   </p></td>
<td><p><span class="math notranslate nohighlight">\( L \)</span></p></td>
<td><p>Hill parameter L   </p></td>
<td><p>1/Stress²    </p></td>
</tr>
<tr class="row-even"><td><p>props[10]   </p></td>
<td><p><span class="math notranslate nohighlight">\( M \)</span></p></td>
<td><p>Hill parameter M   </p></td>
<td><p>1/Stress²    </p></td>
</tr>
<tr class="row-odd"><td><p>props[11]   </p></td>
<td><p><span class="math notranslate nohighlight">\( N \)</span></p></td>
<td><p>Hill parameter N   </p></td>
<td><p>1/Stress²    </p></td>
</tr>
<tr class="row-even"><td><p>props[12+2j]   </p></td>
<td><p><span class="math notranslate nohighlight">\( Q_j \)</span></p></td>
<td><p>Isotropic saturation stress (j-th term)   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>props[13+2j]   </p></td>
<td><p><span class="math notranslate nohighlight">\( b_j \)</span></p></td>
<td><p>Isotropic hardening rate (j-th term)   </p></td>
<td><p>1/Strain    </p></td>
</tr>
<tr class="row-even"><td><p>props[12+2N_{iso}+2i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( C_i \)</span></p></td>
<td><p>Kinematic modulus (i-th backstress)   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>props[13+2N_{iso}+2i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( D_i \)</span></p></td>
<td><p>Dynamic recovery (i-th backstress)   </p></td>
<td><p>-   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>State Variables (statev):</strong></p>
<p>Total: <span class="math notranslate nohighlight">\( n_{statev} = 1 + 1 + 6 + 6 \times N_{kin} \)</span></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>statev[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( T_{init} \)</span></p></td>
<td><p>Initial temperature   </p></td>
<td><p>Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( p \)</span></p></td>
<td><p>Accumulated plastic strain   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[2:7]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \boldsymbol{\varepsilon}^p \)</span></p></td>
<td><p>Plastic strain tensor (Voigt)   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[8+6i:13+6i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \mathbf{X}_i \)</span></p></td>
<td><p>Backstress i (Voigt)   </p></td>
<td><p>Stress   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>References:</strong><ul class="simple">
<li><p>Hill, R. (1948). “A theory of the yielding and plastic flow of anisotropic metals.” <em>Proc. Roy. Soc. A</em>, 193(1033), 281-297.</p></li>
<li><p>Chaboche, J. L. (1986). “Time-independent constitutive theories for cyclic plasticity.” <em>Int. J. Plasticity</em>, 2(2), 149-188.</p></li>
<li><p>Barlat, F., et al. (2005). “Linear transformation-based anisotropic yield functions.” <em>Int. J. Plasticity</em>, 21(5), 1009-1039. </p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__umat__mechanical_1ga8fb91b082a2fa883bce24a8ee68f2238"><span class="std std-ref">umat_plasticity_hill_isoh_CCP()</span></a> for Hill with isotropic hardening only </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__umat__mechanical_1gad0775f735c8fc1e7adfc1f4e5a31dce2"><span class="std std-ref">umat_plasticity_chaboche_CCP()</span></a> for isotropic (von Mises) Chaboche model</p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Material axes must align with global coordinates or use rotation tensors </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For isotropic yield with Chaboche hardening, use umat_plasticity_chaboche_CCP </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Captures both anisotropic yielding and Bauschinger effect</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Etot</strong> – Total strain tensor at beginning of increment (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>DEtot</strong> – Strain increment tensor (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>sigma</strong> – Stress tensor (Voigt notation: 6×1 vector) [output] </p></li>
<li><p><strong>Lt</strong> – Consistent tangent modulus (6×6 matrix) [output] </p></li>
<li><p><strong>L</strong> – Elastic stiffness tensor (6×6 matrix) [output] </p></li>
<li><p><strong>sigma_in</strong> – Internal stress for explicit solvers (6×1 vector) [output] </p></li>
<li><p><strong>DR</strong> – Rotation increment matrix (3×3) for objective integration </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Material properties vector (see table above) </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – State variables vector (see table above) [input/output] </p></li>
<li><p><strong>T</strong> – Temperature at beginning of increment </p></li>
<li><p><strong>DT</strong> – Temperature increment </p></li>
<li><p><strong>Time</strong> – Time at beginning of increment </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>Wm</strong> – Total mechanical work [output] </p></li>
<li><p><strong>Wm_r</strong> – Recoverable (elastic) work [output] </p></li>
<li><p><strong>Wm_ir</strong> – Irrecoverable work stored in hardening [output] </p></li>
<li><p><strong>Wm_d</strong> – Dissipated (plastic) work [output] </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components (typically 3) </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components (typically 3) </p></li>
<li><p><strong>start</strong> – Flag indicating first increment (true) or continuation (false) </p></li>
<li><p><strong>solver_type</strong> – Solver type: 0=implicit, 1=explicit, 2=dynamic implicit </p></li>
<li><p><strong>tnew_dt</strong> – Suggested new time step size for adaptive time stepping [output]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv429umat_plasticity_hill_isoh_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd">
<span id="_CPPv329umat_plasticity_hill_isoh_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd"></span><span id="_CPPv229umat_plasticity_hill_isoh_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd"></span><span id="umat_plasticity_hill_isoh_CCP__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.doubleR"></span><span class="target" id="group__umat__mechanical_1ga8fb91b082a2fa883bce24a8ee68f2238"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_plasticity_hill_isoh_CCP</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_ir</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_d</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tnew_dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv429umat_plasticity_hill_isoh_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd" title="Link to this definition"></a><br /></dt>
<dd><p>Elastic-plastic constitutive model with Hill anisotropic yield criterion and isotropic hardening solved by the Convex Cutting Plane (CCP) algorithm. </p>
<p>This function implements the Hill anisotropic plasticity model for small and finite strain analysis of orthotropic materials. The model features:<ul class="simple">
<li><p>Hill (1948) quadratic anisotropic yield criterion</p></li>
<li><p>Isotropic hardening with power law</p></li>
<li><p>Associative flow rule</p></li>
<li><p>Convex Cutting Plane algorithm for return mapping</p></li>
<li><p>Thermal expansion effects</p></li>
<li><p>Consistent tangent modulus for implicit FE analysis</p></li>
</ul>
</p>
<p><strong>Constitutive Equations:</strong></p>
<p>The Hill anisotropic yield function is defined as:   <div class="math notranslate nohighlight">
\[\Phi(\boldsymbol{\sigma}, p) = \sigma_{eq}^{Hill} - H_p(p) - \sigma_Y \leq 0
\]</div>
 where:   <div class="math notranslate nohighlight">
\[\sigma_{eq}^{Hill} = \sqrt{F(\sigma_{22} - \sigma_{33})^2 + G(\sigma_{33} - \sigma_{11})^2 + H(\sigma_{11} - \sigma_{22})^2 + 2L\sigma_{23}^2 + 2M\sigma_{13}^2 + 2N\sigma_{12}^2}
\]</div>
</p>
<p><strong>Hill Anisotropy Parameters:</strong></p>
<p>The six Hill parameters <span class="math notranslate nohighlight">\( (F, G, H, L, M, N) \)</span> define the material’s plastic anisotropy. For orthotropic symmetry with principal axes aligned with material axes:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( F, G, H \)</span> control yielding in normal stress components</p></li>
<li><p><span class="math notranslate nohighlight">\( L, M, N \)</span> control yielding in shear stress components</p></li>
</ul>
</p>
<p><strong>Relationship to Yield Stress Ratios:</strong></p>
<p>The Hill parameters can be related to yield stresses in different directions:   <div class="math notranslate nohighlight">
\[F = \frac{1}{2}\left(\frac{1}{\sigma_{Y22}^2} + \frac{1}{\sigma_{Y33}^2} - \frac{1}{\sigma_{Y11}^2}\right)
\]</div>
<div class="math notranslate nohighlight">
\[G = \frac{1}{2}\left(\frac{1}{\sigma_{Y33}^2} + \frac{1}{\sigma_{Y11}^2} - \frac{1}{\sigma_{Y22}^2}\right)
\]</div>
<div class="math notranslate nohighlight">
\[H = \frac{1}{2}\left(\frac{1}{\sigma_{Y11}^2} + \frac{1}{\sigma_{Y22}^2} - \frac{1}{\sigma_{Y33}^2}\right)
\]</div>
<div class="math notranslate nohighlight">
\[L = \frac{3}{2\sigma_{Y23}^2}, \quad M = \frac{3}{2\sigma_{Y13}^2}, \quad N = \frac{3}{2\sigma_{Y12}^2}
\]</div>
 where <span class="math notranslate nohighlight">\( \sigma_{Yii} \)</span> is the yield stress in uniaxial loading along direction <span class="math notranslate nohighlight">\( i \)</span>, and <span class="math notranslate nohighlight">\( \sigma_{Yij} \)</span> is the yield stress in pure shear in the <span class="math notranslate nohighlight">\( ij \)</span> plane.</p>
<p><strong>Special Case - von Mises (Isotropic):</strong></p>
<p>For isotropic materials, the Hill criterion reduces to von Mises when:   <div class="math notranslate nohighlight">
\[F = G = H = \frac{1}{2}, \quad L = M = N = \frac{3}{2}
\]</div>
</p>
<p><strong>Isotropic Hardening (Power Law):</strong></p>
<p>The isotropic hardening follows a power law:   <div class="math notranslate nohighlight">
\[H_p(p) = k \cdot p^m
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( k \)</span> is the hardening coefficient</p></li>
<li><p><span class="math notranslate nohighlight">\( m \)</span> is the hardening exponent</p></li>
<li><p><span class="math notranslate nohighlight">\( p = \int_0^t \dot{p} \, dt \)</span> is the accumulated plastic strain</p></li>
</ul>
</p>
<p><strong>Plastic Flow Rule:</strong></p>
<p>The plastic strain rate follows the associative flow rule:   <div class="math notranslate nohighlight">
\[\dot{\boldsymbol{\varepsilon}}^p = \dot{p} \mathbf{n}
\]</div>
 where:   <div class="math notranslate nohighlight">
\[\mathbf{n} = \frac{\partial \sigma_{eq}^{Hill}}{\partial \boldsymbol{\sigma}} = \frac{1}{\sigma_{eq}^{Hill}} \mathbf{P}^{Hill} : \boldsymbol{\sigma}
\]</div>
 is the flow direction normal to the Hill yield surface, and <span class="math notranslate nohighlight">\( \mathbf{P}^{Hill} \)</span> is the Hill projection tensor.</p>
<p><strong>Hill Projection Tensor (Voigt Notation):</strong></p>
<p><div class="math notranslate nohighlight">
\[\begin{split}\mathbf{P}^{Hill} = \begin{bmatrix}
G+H &amp; -H &amp; -G &amp; 0 &amp; 0 &amp; 0 \\
-H &amp; H+F &amp; -F &amp; 0 &amp; 0 &amp; 0 \\
-G &amp; -F &amp; F+G &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 2N &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 2M &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 2L
\end{bmatrix}
\end{split}\]</div>
</p>
<p><strong>Incremental Form (CCP Algorithm):</strong></p>
<p>For an increment <span class="math notranslate nohighlight">\( \Delta p \)</span>, the stress is updated as:   <div class="math notranslate nohighlight">
\[\boldsymbol{\sigma}_{n+1} = \boldsymbol{\sigma}^{trial} - \Delta p \left( \mathbf{L} : \mathbf{n} + \frac{\partial \mathbf{n}}{\partial \boldsymbol{\sigma}} : \boldsymbol{\sigma} \right)
\]</div>
</p>
<p>The CCP algorithm solves for <span class="math notranslate nohighlight">\( \Delta p \)</span> using the Fischer-Burmeister complementarity condition:   <div class="math notranslate nohighlight">
\[FB(\Delta p, \Phi) = \sqrt{(\Delta p)^2 + \Phi^2} - \Delta p - \Phi = 0
\]</div>
</p>
<p><strong>Consistent Tangent Modulus:</strong></p>
<p>The algorithmic tangent modulus is:   <div class="math notranslate nohighlight">
\[\mathbf{L}_t = \mathbf{L} - \frac{(\mathbf{L}:\mathbf{n}) \otimes (\mathbf{n}:\mathbf{L})}{\mathbf{n}:\mathbf{L}:\mathbf{n} + H'}
\]</div>
 where <span class="math notranslate nohighlight">\( H' = \frac{dH_p}{dp} = k \cdot m \cdot p^{m-1} \)</span> is the hardening modulus.</p>
<p><strong>Material Parameters (props):</strong></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units   </p></th>
<th class="head"><p>Typical Range    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>props[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E \)</span></p></td>
<td><p>Young’s modulus   </p></td>
<td><p>Stress   </p></td>
<td><p>50-500 GPa    </p></td>
</tr>
<tr class="row-odd"><td><p>props[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \nu \)</span></p></td>
<td><p>Poisson’s ratio   </p></td>
<td><p>-   </p></td>
<td><p>0.2-0.45    </p></td>
</tr>
<tr class="row-even"><td><p>props[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \alpha \)</span></p></td>
<td><p>Coefficient of thermal expansion   </p></td>
<td><p>1/Temperature   </p></td>
<td><p>1e-6 to 1e-4 /K    </p></td>
</tr>
<tr class="row-odd"><td><p>props[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \sigma_Y \)</span></p></td>
<td><p>Initial yield stress   </p></td>
<td><p>Stress   </p></td>
<td><p>100-1000 MPa    </p></td>
</tr>
<tr class="row-even"><td><p>props[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( k \)</span></p></td>
<td><p>Hardening coefficient   </p></td>
<td><p>Stress   </p></td>
<td><p>100-2000 MPa    </p></td>
</tr>
<tr class="row-odd"><td><p>props[5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( m \)</span></p></td>
<td><p>Hardening exponent   </p></td>
<td><p>-   </p></td>
<td><p>0.05-0.5    </p></td>
</tr>
<tr class="row-even"><td><p>props[6]   </p></td>
<td><p><span class="math notranslate nohighlight">\( F \)</span></p></td>
<td><p>Hill parameter F   </p></td>
<td><p>1/Stress²   </p></td>
<td><p>0-10    </p></td>
</tr>
<tr class="row-odd"><td><p>props[7]   </p></td>
<td><p><span class="math notranslate nohighlight">\( G \)</span></p></td>
<td><p>Hill parameter G   </p></td>
<td><p>1/Stress²   </p></td>
<td><p>0-10    </p></td>
</tr>
<tr class="row-even"><td><p>props[8]   </p></td>
<td><p><span class="math notranslate nohighlight">\( H \)</span></p></td>
<td><p>Hill parameter H   </p></td>
<td><p>1/Stress²   </p></td>
<td><p>0-10    </p></td>
</tr>
<tr class="row-odd"><td><p>props[9]   </p></td>
<td><p><span class="math notranslate nohighlight">\( L \)</span></p></td>
<td><p>Hill parameter L   </p></td>
<td><p>1/Stress²   </p></td>
<td><p>0-10    </p></td>
</tr>
<tr class="row-even"><td><p>props[10]   </p></td>
<td><p><span class="math notranslate nohighlight">\( M \)</span></p></td>
<td><p>Hill parameter M   </p></td>
<td><p>1/Stress²   </p></td>
<td><p>0-10    </p></td>
</tr>
<tr class="row-odd"><td><p>props[11]   </p></td>
<td><p><span class="math notranslate nohighlight">\( N \)</span></p></td>
<td><p>Hill parameter N   </p></td>
<td><p>1/Stress²   </p></td>
<td><p>0-10   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>Constraint on Hill Parameters:</strong><ul class="simple">
<li><p>For physical consistency: <span class="math notranslate nohighlight">\( F + G + H &gt; 0 \)</span></p></li>
<li><p>For von Mises isotropy: <span class="math notranslate nohighlight">\( F = G = H = 0.5, L = M = N = 1.5 \)</span></p></li>
<li><p>For plane stress: Ensure appropriate ratios for the stress state</p></li>
</ul>
</p>
<p><strong>State Variables (statev):</strong></p>
<p>Total state variables required: <span class="math notranslate nohighlight">\( n_{statev} = 8 \)</span></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>statev[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( T_{init} \)</span></p></td>
<td><p>Initial/reference temperature   </p></td>
<td><p>Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( p \)</span></p></td>
<td><p>Accumulated plastic strain   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{11} \)</span></p></td>
<td><p>Plastic strain component 11   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{22} \)</span></p></td>
<td><p>Plastic strain component 22   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{33} \)</span></p></td>
<td><p>Plastic strain component 33   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{12} \)</span></p></td>
<td><p>Plastic strain component 12 (engineering)   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[6]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{13} \)</span></p></td>
<td><p>Plastic strain component 13 (engineering)   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[7]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{23} \)</span></p></td>
<td><p>Plastic strain component 23 (engineering)   </p></td>
<td><p>Strain   </p></td>
</tr>
</tbody>
</table>
</p>
<p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>// Example usage: Aluminum rolled sheet (transverse isotropy in 1-2 plane)
vec props(12);
props(0) = 70000;       // E = 70 GPa
props(1) = 0.33;        // nu = 0.33
props(2) = 2.3e-5;      // alpha = 23e-6 /K
props(3) = 200;         // sigma_Y = 200 MPa
props(4) = 400;         // k = 400 MPa
props(5) = 0.15;        // m = 0.15

// Hill parameters for rolled sheet (stronger in rolling direction)
// Assume: sigma_Y11 = 200 MPa (rolling), sigma_Y22 = 220 MPa (transverse), sigma_Y33 = 210 MPa
// sigma_Y12 = sigma_Y13 = sigma_Y23 = 115.5 MPa (shear, sqrt(3)*sigma_Y/3)
props(6) = 0.00115;     // F
props(7) = 0.00116;     // G
props(8) = 0.00126;     // H
props(9) = 0.0130;      // L = 1.5 for isotropy
props(10) = 0.0130;     // M = 1.5 for isotropy
props(11) = 0.0130;     // N = 1.5 for isotropy

vec statev = zeros(8);
statev(0) = 20.0;  // Reference temperature 20°C

vec Etot = {0.003, 0.0, 0.0, 0.0, 0.0, 0.0};  // 0.3% uniaxial strain
vec DEtot = {0.0001, 0.0, 0.0, 0.0, 0.0, 0.0};
vec sigma = zeros(6);
mat Lt = zeros(6,6);
mat DR = eye(3,3);

umat_plasticity_hill_isoh_CCP(Etot, DEtot, sigma, Lt, DR,
                              12, props, 8, statev, 20.0, 0.0, 0.0, 1.0,
                              Wm, Wm_r, Wm_ir, Wm_d, 3, 3, false, tnew_dt);

// Expected: Different yield stress depending on loading direction
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../continuum_mechanics/functions/constitutive.html#group__constitutive_1gaf485036362aaf2d53d4057c64b16cba8"><span class="std std-ref">L_iso()</span></a> for isotropic elastic stiffness construction </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../continuum_mechanics/functions/constitutive.html#group__constitutive_1gab975804a7c284e385822dd6658c84587"><span class="std std-ref">Ireal()</span></a> for real identity tensor </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../simulation/maths.html#group__maths_1ga08cbc5d47a4660b909365fb568128e59"><span class="std std-ref">Fischer_Burmeister()</span></a> for complementarity <a class="reference internal" href="../simulation/solver.html#group__solver_1gaa0596e436c2e4d097204dd1dc36071e3"><span class="std std-ref">solver</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Eq_stress_Hill() for Hill equivalent Stress Functions computation </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>denom_FB_Hill() for CCP denominator with Hill criterion</p>
</div>
</p>
<p><strong>References:</strong><ul class="simple">
<li><p>Hill, R. (1948). “A theory of the yielding and plastic flow of anisotropic metals.” <em>Proceedings of the Royal Society of London A</em>, 193(1033), 281-297.</p></li>
<li><p>Hill, R. (1950). <em>The Mathematical Theory of Plasticity</em>. Oxford University Press.</p></li>
<li><p>Barlat, F., &amp; Lian, J. (1989). “Plastic behavior and stretchability of sheet metals. Part I: A yield function for orthotropic sheets under plane stress conditions.” <em>International Journal of Plasticity</em>, 5(1), 51-66.</p></li>
<li><p>Banabic, D. (2010). <em>Sheet Metal Forming Processes: Constitutive Modelling and Numerical Simulation</em>. Springer.</p></li>
<li><p>Ortiz, M., &amp; Simo, J. C. (1986). “An analysis of a new class of integration algorithms for elastoplastic constitutive relations.” <em>International Journal for Numerical Methods in Engineering</em>, 23(3), 353-366. </p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Hill criterion is widely used for metals with crystallographic texture </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Common applications: rolled sheets, drawn wires, forged components </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Parameter identification requires yield stress measurements in multiple directions </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For fiber composites, consider more advanced criteria (Tsai-Wu, Hoffman) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The model assumes plastic incompressibility (plastic volume change = 0) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Material axes must align with the global coordinate system or use rotation</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Etot</strong> – Total strain tensor at beginning of increment (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>DEtot</strong> – Strain increment tensor (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>sigma</strong> – Stress tensor (Voigt notation: 6×1 vector) [output] </p></li>
<li><p><strong>Lt</strong> – Consistent tangent modulus <span class="math notranslate nohighlight">\( \mathbf{L}_t \)</span> (6×6 matrix) [output] </p></li>
<li><p><strong>DR</strong> – Rotation increment matrix (3×3) for objective integration </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Material properties vector (see table above) </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – State variables vector (see table above) [input/output] </p></li>
<li><p><strong>T</strong> – Temperature at beginning of increment </p></li>
<li><p><strong>DT</strong> – Temperature increment </p></li>
<li><p><strong>Time</strong> – Time at beginning of increment </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>Wm</strong> – Total mechanical work [output] </p></li>
<li><p><strong>Wm_r</strong> – Recoverable (elastic) work [output] </p></li>
<li><p><strong>Wm_ir</strong> – Irrecoverable work stored in plastic deformation [output] </p></li>
<li><p><strong>Wm_d</strong> – Dissipated (plastic) work [output] </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components (typically 3) </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components (typically 3) </p></li>
<li><p><strong>start</strong> – Flag indicating first increment (true) or continuation (false) </p></li>
<li><p><strong>tnew_dt</strong> – Suggested new time step size for adaptive time stepping [output]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv431umat_plasticity_hill_isoh_CCP_NRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd">
<span id="_CPPv331umat_plasticity_hill_isoh_CCP_NRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd"></span><span id="_CPPv231umat_plasticity_hill_isoh_CCP_NRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd"></span><span id="umat_plasticity_hill_isoh_CCP_N__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.doubleR"></span><span class="target" id="group__umat__mechanical_1ga3a8599f53a9a5bce4c38c895f8d90087"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_plasticity_hill_isoh_CCP_N</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_ir</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_d</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tnew_dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv431umat_plasticity_hill_isoh_CCP_NRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd" title="Link to this definition"></a><br /></dt>
<dd><p>Elastic-plastic model with Hill anisotropic criterion and N isotropic hardening terms. </p>
<p>This function implements the Hill anisotropic plasticity model with multiple isotropic hardening terms for enhanced flexibility in capturing complex hardening behavior. The model features:<ul class="simple">
<li><p>Hill (1948) quadratic anisotropic yield criterion</p></li>
<li><p>Multiple Voce-type isotropic hardening terms: <span class="math notranslate nohighlight">\( R(p) = \sum_{i=1}^{N} Q_i (1 - e^{-b_i p}) \)</span></p></li>
<li><p>Associative flow rule</p></li>
<li><p>Convex Cutting Plane algorithm for return mapping</p></li>
<li><p>Consistent tangent modulus for implicit FE analysis</p></li>
</ul>
</p>
<p><strong>Constitutive Equations:</strong></p>
<p>The Hill anisotropic yield function is defined as:   <div class="math notranslate nohighlight">
\[\Phi(\boldsymbol{\sigma}, p) = \sigma_{eq}^{Hill} - R(p) - \sigma_Y \leq 0
\]</div>
 where:   <div class="math notranslate nohighlight">
\[\sigma_{eq}^{Hill} = \sqrt{F(\sigma_{22} - \sigma_{33})^2 + G(\sigma_{33} - \sigma_{11})^2 + H(\sigma_{11} - \sigma_{22})^2 + 2L\sigma_{23}^2 + 2M\sigma_{13}^2 + 2N\sigma_{12}^2}
\]</div>
</p>
<p><strong>Multiple Isotropic Hardening (Voce Law):</strong></p>
<p>The isotropic hardening is the sum of N exponential terms:   <div class="math notranslate nohighlight">
\[R(p) = \sum_{i=1}^{N_{iso}} Q_i \left( 1 - e^{-b_i p} \right)
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( Q_i \)</span> is the saturation stress of the i-th hardening term</p></li>
<li><p><span class="math notranslate nohighlight">\( b_i \)</span> is the hardening rate parameter of the i-th term</p></li>
<li><p><span class="math notranslate nohighlight">\( p \)</span> is the accumulated plastic strain</p></li>
</ul>
</p>
<p><strong>Hardening Modulus:</strong></p>
<p>The derivative of the isotropic hardening function:   <div class="math notranslate nohighlight">
\[H_{iso} = \frac{dR}{dp} = \sum_{i=1}^{N_{iso}} Q_i b_i e^{-b_i p}
\]</div>
</p>
<p><strong>Advantages of Multiple Hardening Terms:</strong></p>
<p><ul class="simple">
<li><p>Better fit to experimental stress-strain curves</p></li>
<li><p>Captures both rapid initial hardening and gradual saturation</p></li>
<li><p>Different terms can represent different physical mechanisms:<ul>
<li><p>Fast term (high b): dislocation pile-up, initial work hardening</p></li>
<li><p>Slow term (low b): long-range backstress development, texture evolution</p></li>
</ul>
</p></li>
</ul>
</p>
<p><strong>Material Parameters (props):</strong></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>props[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E \)</span></p></td>
<td><p>Young’s modulus   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>props[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \nu \)</span></p></td>
<td><p>Poisson’s ratio   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-even"><td><p>props[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \alpha \)</span></p></td>
<td><p>Thermal expansion coefficient   </p></td>
<td><p>1/Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>props[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \sigma_Y \)</span></p></td>
<td><p>Initial yield stress   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>props[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( N_{iso} \)</span></p></td>
<td><p>Number of isotropic hardening terms   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-odd"><td><p>props[5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( F \)</span></p></td>
<td><p>Hill parameter F   </p></td>
<td><p>1/Stress²    </p></td>
</tr>
<tr class="row-even"><td><p>props[6]   </p></td>
<td><p><span class="math notranslate nohighlight">\( G \)</span></p></td>
<td><p>Hill parameter G   </p></td>
<td><p>1/Stress²    </p></td>
</tr>
<tr class="row-odd"><td><p>props[7]   </p></td>
<td><p><span class="math notranslate nohighlight">\( H \)</span></p></td>
<td><p>Hill parameter H   </p></td>
<td><p>1/Stress²    </p></td>
</tr>
<tr class="row-even"><td><p>props[8]   </p></td>
<td><p><span class="math notranslate nohighlight">\( L \)</span></p></td>
<td><p>Hill parameter L   </p></td>
<td><p>1/Stress²    </p></td>
</tr>
<tr class="row-odd"><td><p>props[9]   </p></td>
<td><p><span class="math notranslate nohighlight">\( M \)</span></p></td>
<td><p>Hill parameter M   </p></td>
<td><p>1/Stress²    </p></td>
</tr>
<tr class="row-even"><td><p>props[10]   </p></td>
<td><p><span class="math notranslate nohighlight">\( N \)</span></p></td>
<td><p>Hill parameter N   </p></td>
<td><p>1/Stress²    </p></td>
</tr>
<tr class="row-odd"><td><p>props[11+2j]   </p></td>
<td><p><span class="math notranslate nohighlight">\( Q_j \)</span></p></td>
<td><p>Saturation stress of j-th term   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>props[12+2j]   </p></td>
<td><p><span class="math notranslate nohighlight">\( b_j \)</span></p></td>
<td><p>Hardening rate of j-th term   </p></td>
<td><p>1/Strain   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>State Variables (statev):</strong></p>
<p>Total state variables required: <span class="math notranslate nohighlight">\( n_{statev} = 8 \)</span></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>statev[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( T_{init} \)</span></p></td>
<td><p>Initial temperature   </p></td>
<td><p>Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( p \)</span></p></td>
<td><p>Accumulated plastic strain   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{11} \)</span></p></td>
<td><p>Plastic strain component 11   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{22} \)</span></p></td>
<td><p>Plastic strain component 22   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{33} \)</span></p></td>
<td><p>Plastic strain component 33   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{12} \)</span></p></td>
<td><p>Plastic strain component 12   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[6]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{13} \)</span></p></td>
<td><p>Plastic strain component 13   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[7]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{23} \)</span></p></td>
<td><p>Plastic strain component 23   </p></td>
<td><p>Strain   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>References:</strong><ul class="simple">
<li><p>Hill, R. (1948). “A theory of the yielding and plastic flow of anisotropic metals.” <em>Proc. Roy. Soc. A</em>, 193(1033), 281-297.</p></li>
<li><p>Voce, E. (1948). “The relationship between stress and strain for homogeneous deformation.” <em>J. Inst. Met.</em>, 74, 537-562.</p></li>
<li><p>Barlat, F., et al. (2003). “Plane stress yield function for aluminum alloy sheets.” <em>Int. J. Plasticity</em>, 19(9), 1297-1319. </p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__umat__mechanical_1ga8fb91b082a2fa883bce24a8ee68f2238"><span class="std std-ref">umat_plasticity_hill_isoh_CCP()</span></a> for single power-law hardening version </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__umat__mechanical_1ga6c153aa10feac4477e39cd4bc610dd66"><span class="std std-ref">umat_hill_chaboche_CCP()</span></a> for combined kinematic and isotropic hardening</p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Typically 2-3 hardening terms are sufficient for most metals </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For single power-law hardening, use umat_plasticity_hill_isoh_CCP instead </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Hill parameters must satisfy physical constraints (positive definite)</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Etot</strong> – Total strain tensor at beginning of increment (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>DEtot</strong> – Strain increment tensor (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>sigma</strong> – Stress tensor (Voigt notation: 6×1 vector) [output] </p></li>
<li><p><strong>Lt</strong> – Consistent tangent modulus (6×6 matrix) [output] </p></li>
<li><p><strong>DR</strong> – Rotation increment matrix (3×3) for objective integration </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Material properties vector (see table above) </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – State variables vector (see table above) [input/output] </p></li>
<li><p><strong>T</strong> – Temperature at beginning of increment </p></li>
<li><p><strong>DT</strong> – Temperature increment </p></li>
<li><p><strong>Time</strong> – Time at beginning of increment </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>Wm</strong> – Total mechanical work [output] </p></li>
<li><p><strong>Wm_r</strong> – Recoverable (elastic) work [output] </p></li>
<li><p><strong>Wm_ir</strong> – Irrecoverable work stored in plastic deformation [output] </p></li>
<li><p><strong>Wm_d</strong> – Dissipated (plastic) work [output] </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components (typically 3) </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components (typically 3) </p></li>
<li><p><strong>start</strong> – Flag indicating first increment (true) or continuation (false) </p></li>
<li><p><strong>tnew_dt</strong> – Suggested new time step size for adaptive time stepping [output]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv428umat_plasticity_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd">
<span id="_CPPv328umat_plasticity_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="_CPPv228umat_plasticity_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="umat_plasticity_chaboche_CCP__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matR.arma::vecR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.iCR.doubleR"></span><span class="target" id="group__umat__mechanical_1gad0775f735c8fc1e7adfc1f4e5a31dce2"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_plasticity_chaboche_CCP</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">L</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma_in</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_ir</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_d</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">solver_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tnew_dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv428umat_plasticity_chaboche_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd" title="Link to this definition"></a><br /></dt>
<dd><p>Elastic-plastic constitutive model with Chaboche kinematic hardening solved by the Convex Cutting Plane (CCP) algorithm. </p>
<p>This function implements the Chaboche unified viscoplasticity model for small and finite strain analysis. The model features:<ul class="simple">
<li><p>J2 (von Mises) plasticity with associative flow rule</p></li>
<li><p>Multiple Armstrong-Frederick backstresses for nonlinear kinematic hardening</p></li>
<li><p>Optional isotropic hardening with Voce law</p></li>
<li><p>Dynamic recovery (recall terms) in backstress evolution</p></li>
<li><p>Convex Cutting Plane algorithm for return mapping</p></li>
<li><p>Thermal expansion effects</p></li>
<li><p>Consistent tangent modulus for implicit FE analysis</p></li>
</ul>
</p>
<p><strong>Constitutive Equations:</strong></p>
<p>The yield function is defined as:   <div class="math notranslate nohighlight">
\[\Phi(\boldsymbol{\sigma}, \mathbf{X}, R) = \sigma_{eq}(\boldsymbol{\sigma} - \mathbf{X}) - R - \sigma_Y \leq 0
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \sigma_{eq}(\boldsymbol{\eta}) = \sqrt{\frac{3}{2} \boldsymbol{\eta}_{dev} : \boldsymbol{\eta}_{dev}} \)</span> is the von Mises equivalent stress</p></li>
<li><p><span class="math notranslate nohighlight">\( \boldsymbol{\eta} = \boldsymbol{\sigma} - \mathbf{X} \)</span> is the shifted (effective) stress tensor</p></li>
<li><p><span class="math notranslate nohighlight">\( \mathbf{X} = \sum_{i=1}^{N_{kin}} \mathbf{X}_i \)</span> is the total backstress (sum of individual backstresses)</p></li>
<li><p><span class="math notranslate nohighlight">\( R \)</span> is the isotropic hardening stress</p></li>
<li><p><span class="math notranslate nohighlight">\( \sigma_Y \)</span> is the initial yield stress</p></li>
</ul>
</p>
<p><strong>Armstrong-Frederick Backstress Evolution:</strong></p>
<p>Each backstress component evolves according to the Armstrong-Frederick law with dynamic recovery:   <div class="math notranslate nohighlight">
\[\dot{\mathbf{X}}_i = \frac{2}{3} C_i \dot{\boldsymbol{\varepsilon}}^p - D_i \mathbf{X}_i \dot{p}
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( C_i \)</span> is the kinematic hardening modulus of the i-th backstress</p></li>
<li><p><span class="math notranslate nohighlight">\( D_i \)</span> is the dynamic recovery (recall) parameter of the i-th backstress</p></li>
<li><p><span class="math notranslate nohighlight">\( \dot{\boldsymbol{\varepsilon}}^p \)</span> is the plastic strain rate tensor</p></li>
<li><p><span class="math notranslate nohighlight">\( \dot{p} = \sqrt{\frac{2}{3} \dot{\boldsymbol{\varepsilon}}^p : \dot{\boldsymbol{\varepsilon}}^p} \)</span> is the accumulated plastic strain rate</p></li>
</ul>
</p>
<p><strong>Physical Interpretation:</strong><ul class="simple">
<li><p>The <span class="math notranslate nohighlight">\( C_i \)</span> term represents strain hardening (backstress growth)</p></li>
<li><p>The <span class="math notranslate nohighlight">\( D_i \mathbf{X}_i \dot{p} \)</span> term represents dynamic recovery (backstress fading)</p></li>
<li><p>Multiple backstresses capture different scales of cyclic hardening behavior</p></li>
<li><p>Typically 2-3 backstress components are used</p></li>
</ul>
</p>
<p><strong>Isotropic Hardening (Optional):</strong></p>
<p>The isotropic hardening follows the Voce law:   <div class="math notranslate nohighlight">
\[R(p) = \sum_{j=1}^{N_{iso}} Q_j \left( 1 - e^{-b_j p} \right)
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( Q_j \)</span> is the saturation value of the j-th isotropic hardening component</p></li>
<li><p><span class="math notranslate nohighlight">\( b_j \)</span> is the hardening rate parameter</p></li>
<li><p><span class="math notranslate nohighlight">\( p \)</span> is the accumulated plastic strain</p></li>
</ul>
</p>
<p><strong>Plastic Flow Rule:</strong></p>
<p>The plastic strain rate follows the associative flow rule:   <div class="math notranslate nohighlight">
\[\dot{\boldsymbol{\varepsilon}}^p = \dot{p} \mathbf{n}
\]</div>
 where:   <div class="math notranslate nohighlight">
\[\mathbf{n} = \frac{3}{2} \frac{\boldsymbol{\eta}_{dev}}{\sigma_{eq}(\boldsymbol{\eta})}
\]</div>
 is the flow direction (normal to the yield surface).</p>
<p><strong>Incremental Form (CCP Algorithm):</strong></p>
<p>For an increment <span class="math notranslate nohighlight">\( \Delta p \)</span>, the stress and backstresses are updated as:   <div class="math notranslate nohighlight">
\[\boldsymbol{\sigma}_{n+1} = \boldsymbol{\sigma}^{trial} - \Delta p \left( \mathbf{L} : \mathbf{n} + \frac{\partial \mathbf{n}}{\partial \boldsymbol{\sigma}} : \boldsymbol{\sigma} \right)
\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{X}_{i,n+1} = \mathbf{X}_{i,n} + \frac{2}{3} C_i \Delta \boldsymbol{\varepsilon}^p - D_i \mathbf{X}_{i,n} \Delta p
\]</div>
</p>
<p>The CCP algorithm solves for <span class="math notranslate nohighlight">\( \Delta p \)</span> using the Fischer-Burmeister complementarity condition:   <div class="math notranslate nohighlight">
\[FB(\Delta p, \Phi) = \sqrt{(\Delta p)^2 + \Phi^2} - \Delta p - \Phi = 0
\]</div>
</p>
<p><strong>Consistent Tangent Modulus:</strong></p>
<p>The algorithmic tangent modulus accounts for both plastic flow and backstress evolution:   <div class="math notranslate nohighlight">
\[\mathbf{L}_t = \mathbf{L} - \frac{(\mathbf{L}:\mathbf{n}) \otimes (\mathbf{n}:\mathbf{L})}{\mathbf{n}:\mathbf{L}:\mathbf{n} + H_{tot}}
\]</div>
 where:   <div class="math notranslate nohighlight">
\[H_{tot} = \sum_{i=1}^{N_{kin}} \frac{C_i}{1 + D_i \Delta p} + \sum_{j=1}^{N_{iso}} Q_j b_j e^{-b_j p}
\]</div>
 is the total hardening modulus combining kinematic and isotropic contributions.</p>
<p><strong>Material Parameters (props):</strong></p>
<p>For <span class="math notranslate nohighlight">\( N_{iso} \)</span> isotropic hardening terms and <span class="math notranslate nohighlight">\( N_{kin} \)</span> kinematic hardening terms:</p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units   </p></th>
<th class="head"><p>Typical Range    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>props[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E \)</span></p></td>
<td><p>Young’s modulus   </p></td>
<td><p>Stress   </p></td>
<td><p>50-500 GPa    </p></td>
</tr>
<tr class="row-odd"><td><p>props[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \nu \)</span></p></td>
<td><p>Poisson’s ratio   </p></td>
<td><p>-   </p></td>
<td><p>0.2-0.45    </p></td>
</tr>
<tr class="row-even"><td><p>props[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \alpha \)</span></p></td>
<td><p>Coefficient of thermal expansion   </p></td>
<td><p>1/Temperature   </p></td>
<td><p>1e-6 to 1e-4 /K    </p></td>
</tr>
<tr class="row-odd"><td><p>props[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \sigma_Y \)</span></p></td>
<td><p>Initial yield stress   </p></td>
<td><p>Stress   </p></td>
<td><p>100-1000 MPa    </p></td>
</tr>
<tr class="row-even"><td><p>props[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( N_{iso} \)</span></p></td>
<td><p>Number of isotropic hardening terms   </p></td>
<td><p>-   </p></td>
<td><p>0-3    </p></td>
</tr>
<tr class="row-odd"><td><p>props[5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( N_{kin} \)</span></p></td>
<td><p>Number of kinematic hardening terms   </p></td>
<td><p>-   </p></td>
<td><p>1-3    </p></td>
</tr>
<tr class="row-even"><td><p>props[6+2j]   </p></td>
<td><p><span class="math notranslate nohighlight">\( Q_j \)</span></p></td>
<td><p>Saturation stress of j-th isotropic term   </p></td>
<td><p>Stress   </p></td>
<td><p>0-500 MPa    </p></td>
</tr>
<tr class="row-odd"><td><p>props[7+2j]   </p></td>
<td><p><span class="math notranslate nohighlight">\( b_j \)</span></p></td>
<td><p>Hardening rate of j-th isotropic term   </p></td>
<td><p>1/Strain   </p></td>
<td><p>1-100    </p></td>
</tr>
<tr class="row-even"><td><p>props[6+2N_{iso}+2i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( C_i \)</span></p></td>
<td><p>Kinematic modulus of i-th backstress   </p></td>
<td><p>Stress   </p></td>
<td><p>10-500 GPa    </p></td>
</tr>
<tr class="row-odd"><td><p>props[7+2N_{iso}+2i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( D_i \)</span></p></td>
<td><p>Dynamic recovery parameter of i-th backstress   </p></td>
<td><p>-   </p></td>
<td><p>0-100   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>Notes on Parameter Selection:</strong><ul class="simple">
<li><p>For pure kinematic hardening, set <span class="math notranslate nohighlight">\( N_{iso} = 0 \)</span></p></li>
<li><p>For pure isotropic hardening, set <span class="math notranslate nohighlight">\( N_{kin} = 0 \)</span> (not typical for Chaboche)</p></li>
<li><p>First backstress (i=0) typically has high <span class="math notranslate nohighlight">\( C_1 \)</span>, low <span class="math notranslate nohighlight">\( D_1 \)</span> (long-range backstress)</p></li>
<li><p>Second backstress (i=1) typically has moderate <span class="math notranslate nohighlight">\( C_2 \)</span>, moderate <span class="math notranslate nohighlight">\( D_2 \)</span></p></li>
<li><p>Third backstress (i=2) typically has low <span class="math notranslate nohighlight">\( C_3 \)</span>, high <span class="math notranslate nohighlight">\( D_3 \)</span> (short-range backstress)</p></li>
</ul>
</p>
<p><strong>State Variables (statev):</strong></p>
<p>Total state variables: <span class="math notranslate nohighlight">\( n_{statev} = 1 + 1 + 6 + 6 \times N_{kin} \)</span></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>statev[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( T_{init} \)</span></p></td>
<td><p>Initial/reference temperature   </p></td>
<td><p>Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( p \)</span></p></td>
<td><p>Accumulated plastic strain   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{11} \)</span></p></td>
<td><p>Plastic strain component 11   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{22} \)</span></p></td>
<td><p>Plastic strain component 22   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{33} \)</span></p></td>
<td><p>Plastic strain component 33   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{12} \)</span></p></td>
<td><p>Plastic strain component 12 (engineering)   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[6]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{13} \)</span></p></td>
<td><p>Plastic strain component 13 (engineering)   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[7]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{23} \)</span></p></td>
<td><p>Plastic strain component 23 (engineering)   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[8+6i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( X_{i,11} \)</span></p></td>
<td><p>Backstress i, component 11   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[9+6i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( X_{i,22} \)</span></p></td>
<td><p>Backstress i, component 22   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>statev[10+6i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( X_{i,33} \)</span></p></td>
<td><p>Backstress i, component 33   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[11+6i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( X_{i,12} \)</span></p></td>
<td><p>Backstress i, component 12   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>statev[12+6i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( X_{i,13} \)</span></p></td>
<td><p>Backstress i, component 13   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[13+6i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( X_{i,23} \)</span></p></td>
<td><p>Backstress i, component 23   </p></td>
<td><p>Stress   </p></td>
</tr>
</tbody>
</table>
</p>
<p>For <span class="math notranslate nohighlight">\( N_{kin} = 2 \)</span> backstresses: <span class="math notranslate nohighlight">\( n_{statev} = 1 + 1 + 6 + 12 = 20 \)</span></p>
<p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>// Example usage: 316 stainless steel with 2 backstresses, 1 isotropic hardening
int N_iso = 1;
int N_kin = 2;
vec props(6 + 2*N_iso + 2*N_kin);
props(0) = 200000;      // E = 200 GPa
props(1) = 0.3;         // nu = 0.3
props(2) = 1.7e-5;      // alpha = 17e-6 /K
props(3) = 150;         // sigma_Y = 150 MPa
props(4) = N_iso;       // 1 isotropic hardening term
props(5) = N_kin;       // 2 kinematic hardening terms

// Isotropic hardening (Voce)
props(6) = 100;         // Q1 = 100 MPa (saturation stress)
props(7) = 10;          // b1 = 10 (hardening rate)

// First backstress (long-range)
props(8) = 300000;      // C1 = 300 GPa
props(9) = 1000;        // D1 = 1000 (moderate recovery)

// Second backstress (short-range)
props(10) = 50000;      // C2 = 50 GPa
props(11) = 100;        // D2 = 100 (strong recovery)

vec statev = zeros(1 + 1 + 6 + 6*N_kin);  // 20 state variables
statev(0) = 20.0;  // Reference temperature 20°C

vec Etot = {0.002, -0.0006, -0.0006, 0.0, 0.0, 0.0};  // 0.2% axial strain
vec DEtot = {0.0001, -0.00003, -0.00003, 0.0, 0.0, 0.0};
vec sigma = zeros(6);
mat Lt = zeros(6,6);
mat L = zeros(6,6);
vec sigma_in = zeros(6);
mat DR = eye(3,3);

umat_plasticity_chaboche_CCP(Etot, DEtot, sigma, Lt, L, sigma_in, DR,
                             12, props, 20, statev, 20.0, 0.0, 0.0, 1.0,
                             Wm, Wm_r, Wm_ir, Wm_d, 3, 3, false, 0, tnew_dt);

// Check backstress components
vec X1 = statev.subvec(8, 13);   // First backstress
vec X2 = statev.subvec(14, 19);  // Second backstress
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../continuum_mechanics/functions/constitutive.html#group__constitutive_1gab975804a7c284e385822dd6658c84587"><span class="std std-ref">Ireal()</span></a> for real identity tensor (Voigt 6×6) </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../continuum_mechanics/functions/constitutive.html#group__constitutive_1ga8d4770913e5c1d521a6aaf9ae3d2bb8d"><span class="std std-ref">Idev()</span></a> for deviatoric projection tensor </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../simulation/maths.html#group__maths_1ga08cbc5d47a4660b909365fb568128e59"><span class="std std-ref">Fischer_Burmeister()</span></a> for complementarity <a class="reference internal" href="../simulation/solver.html#group__solver_1gaa0596e436c2e4d097204dd1dc36071e3"><span class="std std-ref">solver</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../continuum_mechanics/functions/contimech.html#group__contimech_1gaa38aadc3258e1defdc465b6d49f1e9d6"><span class="std std-ref">eta_stress()</span></a> for shifted Stress Functions computation </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>denom_FB_N_Mises() for CCP denominator</p>
</div>
</p>
<p><strong>References:</strong><ul class="simple">
<li><p>Chaboche, J. L. (1986). “Time-independent constitutive theories for cyclic plasticity.” <em>International Journal of Plasticity</em>, 2(2), 149-188.</p></li>
<li><p>Chaboche, J. L. (1989). “Constitutive equations for cyclic plasticity and cyclic viscoplasticity.” <em>International Journal of Plasticity</em>, 5(3), 247-302.</p></li>
<li><p>Chaboche, J. L. (2008). “A review of some plasticity and viscoplasticity constitutive theories.” <em>International Journal of Plasticity</em>, 24(10), 1642-1693.</p></li>
<li><p>Armstrong, P. J., &amp; Frederick, C. O. (1966). “A mathematical representation of the multiaxial Bauschinger effect.” <em>CEGB Report RD/B/N731</em>.</p></li>
<li><p>Lemaitre, J., &amp; Chaboche, J. L. (1990). <em>Mechanics of Solid Materials</em>. Cambridge University Press.</p></li>
<li><p>Ortiz, M., &amp; Simo, J. C. (1986). “An analysis of a new class of integration algorithms for elastoplastic constitutive relations.” <em>International Journal for Numerical Methods in Engineering</em>, 23(3), 353-366. </p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Chaboche model excels at capturing ratcheting and cyclic plasticity </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multiple backstresses are essential for accurate multiaxial loading predictions </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Parameter identification typically requires cyclic test data (tension-compression, torsion) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For monotonic loading, simpler isotropic hardening may suffice </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The model assumes small strains (&lt; 10%); use updated Lagrangian for larger strains </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Dynamic recovery (D &gt; 0) prevents unbounded backstress growth under cycling</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Etot</strong> – Total strain tensor at beginning of increment (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>DEtot</strong> – Strain increment tensor (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>sigma</strong> – Stress tensor (Voigt notation: 6×1 vector) [output] </p></li>
<li><p><strong>Lt</strong> – Consistent tangent modulus <span class="math notranslate nohighlight">\( \mathbf{L}_t \)</span> (6×6 matrix) [output] </p></li>
<li><p><strong>L</strong> – Elastic stiffness tensor (6×6 matrix) [output] </p></li>
<li><p><strong>sigma_in</strong> – Internal stress contribution for explicit solvers (6×1 vector) [output] </p></li>
<li><p><strong>DR</strong> – Rotation increment matrix (3×3) for objective integration </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Material properties vector (see table above) </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – State variables vector (see table above) [input/output] </p></li>
<li><p><strong>T</strong> – Temperature at beginning of increment </p></li>
<li><p><strong>DT</strong> – Temperature increment </p></li>
<li><p><strong>Time</strong> – Time at beginning of increment </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>Wm</strong> – Total mechanical work [output] </p></li>
<li><p><strong>Wm_r</strong> – Recoverable (elastic) work [output] </p></li>
<li><p><strong>Wm_ir</strong> – Irrecoverable work stored in plastic deformation [output] </p></li>
<li><p><strong>Wm_d</strong> – Dissipated (plastic) work [output] </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components (typically 3) </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components (typically 3) </p></li>
<li><p><strong>start</strong> – Flag indicating first increment (true) or continuation (false) </p></li>
<li><p><strong>solver_type</strong> – Solver type: 0=implicit, 1=explicit, 2=dynamic implicit </p></li>
<li><p><strong>tnew_dt</strong> – Suggested new time step size for adaptive time stepping [output]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423umat_plasticity_iso_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd">
<span id="_CPPv323umat_plasticity_iso_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="_CPPv223umat_plasticity_iso_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="umat_plasticity_iso_CCP__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matR.arma::vecR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.iCR.doubleR"></span><span class="target" id="group__umat__mechanical_1ga2e8f1aa0df902c7c6518a458c728d07a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_plasticity_iso_CCP</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">L</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma_in</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_ir</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_d</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">solver_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tnew_dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423umat_plasticity_iso_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd" title="Link to this definition"></a><br /></dt>
<dd><p>Elastic-plastic constitutive model with isotropic hardening solved by the Convex Cutting Plane (CCP) algorithm. </p>
<p>This function implements an elastic-plastic material model for small and finite strain analysis. The model features:<ul class="simple">
<li><p>J2 (von Mises) plasticity with associative flow rule</p></li>
<li><p>Isotropic hardening following a power law: <span class="math notranslate nohighlight">\( H_p = k \cdot p^m \)</span></p></li>
<li><p>Convex Cutting Plane algorithm for return mapping</p></li>
<li><p>Thermal expansion effects</p></li>
<li><p>Consistent tangent modulus for implicit FE analysis</p></li>
</ul>
</p>
<p><strong>Constitutive Equations:</strong></p>
<p>The yield function is defined as:   <div class="math notranslate nohighlight">
\[\Phi(\boldsymbol{\sigma}, p) = \sigma_{eq} - H_p(p) - \sigma_Y \leq 0
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \sigma_{eq} = \sqrt{\frac{3}{2} \mathbf{s} : \mathbf{s}} \)</span> is the von Mises equivalent stress</p></li>
<li><p><span class="math notranslate nohighlight">\( \mathbf{s} \)</span> is the deviatoric stress tensor</p></li>
<li><p><span class="math notranslate nohighlight">\( H_p(p) = k \cdot p^m \)</span> is the isotropic hardening function</p></li>
<li><p><span class="math notranslate nohighlight">\( p = \int \sqrt{\frac{2}{3} \dot{\boldsymbol{\varepsilon}}^p : \dot{\boldsymbol{\varepsilon}}^p} \, dt \)</span> is the accumulated plastic strain</p></li>
<li><p><span class="math notranslate nohighlight">\( \sigma_Y \)</span> is the initial yield stress</p></li>
</ul>
</p>
<p>The plastic flow rule (associative plasticity):   <div class="math notranslate nohighlight">
\[\dot{\boldsymbol{\varepsilon}}^p = \dot{\lambda} \frac{\partial \Phi}{\partial \boldsymbol{\sigma}} = \dot{\lambda} \frac{3}{2} \frac{\mathbf{s}}{\sigma_{eq}}
\]</div>
</p>
<p>Evolution of accumulated plastic strain:   <div class="math notranslate nohighlight">
\[\dot{p} = \sqrt{\frac{2}{3} \dot{\boldsymbol{\varepsilon}}^p : \dot{\boldsymbol{\varepsilon}}^p} = \dot{\lambda}
\]</div>
</p>
<p><strong>Convex Cutting Plane Algorithm:</strong></p>
<p>The CCP algorithm solves the return mapping problem by reformulating it as a complementarity problem:<ul class="simple">
<li><p>Find <span class="math notranslate nohighlight">\( \Delta p \geq 0 \)</span> such that <span class="math notranslate nohighlight">\( \Phi(\boldsymbol{\sigma}, p) \leq 0 \)</span> and <span class="math notranslate nohighlight">\( \Delta p \cdot \Phi = 0 \)</span></p></li>
<li><p>This is solved using the Fischer-Burmeister function for robust convergence</p></li>
<li><p>The method provides a consistent tangent modulus for implicit finite element analysis</p></li>
</ul>
</p>
<p><strong>Material Parameters (props):</strong></p>
<p>The material properties vector must contain 6 constants: <table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>props[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E \)</span></p></td>
<td><p>Young’s modulus   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>props[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \nu \)</span></p></td>
<td><p>Poisson’s ratio   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-even"><td><p>props[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \alpha \)</span></p></td>
<td><p>Isotropic thermal expansion coefficient   </p></td>
<td><p>1/Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>props[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \sigma_Y \)</span></p></td>
<td><p>Initial yield stress   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>props[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( k \)</span></p></td>
<td><p>Hardening parameter   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>props[5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( m \)</span></p></td>
<td><p>Hardening exponent   </p></td>
<td><p>-   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>State Variables (statev):</strong></p>
<p>The state variables vector contains 8 internal variables: <table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>statev[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( T_{init} \)</span></p></td>
<td><p>Initial temperature   </p></td>
<td><p>Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( p \)</span></p></td>
<td><p>Accumulated plastic strain   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-even"><td><p>statev[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{11} \)</span></p></td>
<td><p>Plastic strain component 11   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{22} \)</span></p></td>
<td><p>Plastic strain component 22   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-even"><td><p>statev[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{33} \)</span></p></td>
<td><p>Plastic strain component 33   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{12} \)</span></p></td>
<td><p>Plastic strain component 12 (×2 in Voigt)   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-even"><td><p>statev[6]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{13} \)</span></p></td>
<td><p>Plastic strain component 13 (×2 in Voigt)   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[7]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{23} \)</span></p></td>
<td><p>Plastic strain component 23 (×2 in Voigt)   </p></td>
<td><p>-   </p></td>
</tr>
</tbody>
</table>
</p>
<p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Example</span> <span class="n">usage</span><span class="p">:</span>
<span class="n">vec</span> <span class="n">Etot</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">};</span>
<span class="n">vec</span> <span class="n">DEtot</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">};</span>
<span class="n">vec</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="n">mat</span> <span class="n">Lt</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>
<span class="n">mat</span> <span class="n">L</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>
<span class="n">vec</span> <span class="n">sigma_in</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="n">mat</span> <span class="n">DR</span> <span class="o">=</span> <span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="n">vec</span> <span class="n">props</span> <span class="o">=</span> <span class="p">{</span><span class="mi">70000</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">};</span>
<span class="n">vec</span> <span class="n">statev</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>

<span class="n">umat_plasticity_iso_CCP</span><span class="p">(</span><span class="n">Etot</span><span class="p">,</span> <span class="n">DEtot</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">Lt</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">sigma_in</span><span class="p">,</span> <span class="n">DR</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">statev</span><span class="p">,</span>
                        <span class="mf">20.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">Wm</span><span class="p">,</span> <span class="n">Wm_r</span><span class="p">,</span> <span class="n">Wm_ir</span><span class="p">,</span> <span class="n">Wm_d</span><span class="p">,</span>
                        <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">true</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tnew_dt</span><span class="p">);</span>
</pre></div>
</div>
 <div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../simulation/maths.html#group__maths_1gabd73bb1a7bdd7b30a962309383688e84"><span class="std std-ref">Fischer_Burmeister_m()</span></a> for the complementarity <a class="reference internal" href="../simulation/solver.html#group__solver_1gaa0596e436c2e4d097204dd1dc36071e3"><span class="std std-ref">solver</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../continuum_mechanics/functions/constitutive.html#group__constitutive_1gaf485036362aaf2d53d4057c64b16cba8"><span class="std std-ref">L_iso()</span></a> for isotropic elastic stiffness construction </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../continuum_mechanics/functions/contimech.html#group__contimech_1gaa38aadc3258e1defdc465b6d49f1e9d6"><span class="std std-ref">eta_stress()</span></a> for plastic flow direction computation</p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Voigt notation convention: [11, 22, 33, 12, 13, 23] with engineering shear strains (γ = 2ε) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The consistent tangent modulus Lt ensures quadratic convergence in implicit Newton-Raphson schemes </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For explicit solvers (solver_type=1), use sigma_in instead of Lt</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Etot</strong> – Total strain tensor at beginning of increment (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>DEtot</strong> – Strain increment tensor (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>sigma</strong> – Stress tensor (Voigt notation: 6×1 vector) [output] </p></li>
<li><p><strong>Lt</strong> – Consistent tangent modulus <span class="math notranslate nohighlight">\( \mathbf{L}_t = \frac{\partial \boldsymbol{\sigma}}{\partial \boldsymbol{\varepsilon}} \)</span> (6×6 matrix) [output] </p></li>
<li><p><strong>L</strong> – Elastic stiffness tensor (6×6 matrix) [output] </p></li>
<li><p><strong>sigma_in</strong> – Internal stress contribution for explicit solvers (6×1 vector) [output] </p></li>
<li><p><strong>DR</strong> – Rotation increment matrix (3×3) for objective integration </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Material properties vector (see table above) </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – State variables vector (see table above) [input/output] </p></li>
<li><p><strong>T</strong> – Temperature at beginning of increment </p></li>
<li><p><strong>DT</strong> – Temperature increment </p></li>
<li><p><strong>Time</strong> – Time at beginning of increment </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>Wm</strong> – Total mechanical work [output] </p></li>
<li><p><strong>Wm_r</strong> – Recoverable (elastic) work [output] </p></li>
<li><p><strong>Wm_ir</strong> – Irrecoverable work stored in hardening [output] </p></li>
<li><p><strong>Wm_d</strong> – Dissipated (plastic) work [output] </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components (typically 3) </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components (typically 3) </p></li>
<li><p><strong>start</strong> – Flag indicating first increment (true) or continuation (false) </p></li>
<li><p><strong>solver_type</strong> – Solver type: 0=implicit, 1=explicit, 2=dynamic implicit </p></li>
<li><p><strong>tnew_dt</strong> – Suggested new time step size for adaptive time stepping [output]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427umat_plasticity_kin_iso_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd">
<span id="_CPPv327umat_plasticity_kin_iso_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="_CPPv227umat_plasticity_kin_iso_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd"></span><span id="umat_plasticity_kin_iso_CCP__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matR.arma::vecR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.iCR.doubleR"></span><span class="target" id="group__umat__mechanical_1gacfe5aa478dffe6ffb2341f73572dc60f"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_plasticity_kin_iso_CCP</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">L</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma_in</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_ir</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_d</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">solver_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tnew_dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427umat_plasticity_kin_iso_CCPRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERN4arma3vecERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRKiRd" title="Link to this definition"></a><br /></dt>
<dd><p>Elastic-plastic constitutive model with combined isotropic and linear kinematic hardening. </p>
<p>This function implements an elastic-plastic material model combining both isotropic and linear kinematic hardening mechanisms. The model features:<ul class="simple">
<li><p>J2 (von Mises) plasticity with associative flow rule</p></li>
<li><p>Power law isotropic hardening: <span class="math notranslate nohighlight">\( R(p) = k \cdot p^m \)</span></p></li>
<li><p>Linear (Prager) kinematic hardening: <span class="math notranslate nohighlight">\( \dot{\mathbf{X}} = \frac{2}{3} H_{kin} \dot{\boldsymbol{\varepsilon}}^p \)</span></p></li>
<li><p>Convex Cutting Plane algorithm for return mapping</p></li>
<li><p>Consistent tangent modulus for implicit FE analysis</p></li>
</ul>
</p>
<p><strong>Constitutive Equations:</strong></p>
<p>The yield function is defined as:   <div class="math notranslate nohighlight">
\[\Phi(\boldsymbol{\sigma}, \mathbf{X}, p) = \sigma_{eq}(\boldsymbol{\sigma} - \mathbf{X}) - R(p) - \sigma_Y \leq 0
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \sigma_{eq}(\boldsymbol{\eta}) = \sqrt{\frac{3}{2} \boldsymbol{\eta}_{dev} : \boldsymbol{\eta}_{dev}} \)</span> is the von Mises equivalent stress</p></li>
<li><p><span class="math notranslate nohighlight">\( \boldsymbol{\eta} = \boldsymbol{\sigma} - \mathbf{X} \)</span> is the shifted (effective) stress</p></li>
<li><p><span class="math notranslate nohighlight">\( \mathbf{X} \)</span> is the backstress (kinematic hardening variable)</p></li>
<li><p><span class="math notranslate nohighlight">\( R(p) = k \cdot p^m \)</span> is the isotropic hardening function</p></li>
<li><p><span class="math notranslate nohighlight">\( \sigma_Y \)</span> is the initial yield stress</p></li>
</ul>
</p>
<p><strong>Kinematic Hardening (Prager Linear):</strong></p>
<p>The backstress evolves according to linear (Prager) kinematic hardening:   <div class="math notranslate nohighlight">
\[\dot{\mathbf{X}} = \frac{2}{3} H_{kin} \dot{\boldsymbol{\varepsilon}}^p = \frac{2}{3} H_{kin} \dot{p} \mathbf{n}
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( H_{kin} \)</span> is the kinematic hardening modulus</p></li>
<li><p><span class="math notranslate nohighlight">\( \mathbf{n} = \frac{3}{2} \frac{\boldsymbol{\eta}_{dev}}{\sigma_{eq}} \)</span> is the flow direction</p></li>
</ul>
</p>
<p><strong>Combined Hardening Effect:</strong></p>
<p>The combined hardening provides:<ul class="simple">
<li><p><strong>Isotropic hardening</strong>: Expands the yield surface uniformly (captures strain hardening)</p></li>
<li><p><strong>Kinematic hardening</strong>: Translates the yield surface center (captures Bauschinger effect)</p></li>
</ul>
</p>
<p><strong>Plastic Flow Rule:</strong></p>
<p>The plastic strain rate follows the associative flow rule:   <div class="math notranslate nohighlight">
\[\dot{\boldsymbol{\varepsilon}}^p = \dot{p} \frac{\partial \Phi}{\partial \boldsymbol{\sigma}} = \dot{p} \mathbf{n}
\]</div>
</p>
<p><strong>Incremental Update:</strong></p>
<p>For an increment <span class="math notranslate nohighlight">\( \Delta p \)</span>:   <div class="math notranslate nohighlight">
\[\boldsymbol{\sigma}_{n+1} = \boldsymbol{\sigma}^{trial} - \Delta p \cdot \mathbf{L} : \mathbf{n}
\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{X}_{n+1} = \mathbf{X}_n + \frac{2}{3} H_{kin} \Delta p \cdot \mathbf{n}
\]</div>
</p>
<p><strong>Consistent Tangent Modulus:</strong></p>
<p>The algorithmic tangent accounts for both hardening mechanisms:   <div class="math notranslate nohighlight">
\[\mathbf{L}_t = \mathbf{L} - \frac{(\mathbf{L}:\mathbf{n}) \otimes (\mathbf{n}:\mathbf{L})}{\mathbf{n}:\mathbf{L}:\mathbf{n} + H_{iso} + H_{kin}}
\]</div>
 where <span class="math notranslate nohighlight">\( H_{iso} = \frac{dR}{dp} = k \cdot m \cdot p^{m-1} \)</span> is the isotropic hardening modulus.</p>
<p><strong>Material Parameters (props):</strong></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>props[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E \)</span></p></td>
<td><p>Young’s modulus   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>props[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \nu \)</span></p></td>
<td><p>Poisson’s ratio   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-even"><td><p>props[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \alpha \)</span></p></td>
<td><p>Thermal expansion coefficient   </p></td>
<td><p>1/Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>props[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \sigma_Y \)</span></p></td>
<td><p>Initial yield stress   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>props[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( k \)</span></p></td>
<td><p>Isotropic hardening coefficient   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>props[5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( m \)</span></p></td>
<td><p>Isotropic hardening exponent   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-even"><td><p>props[6]   </p></td>
<td><p><span class="math notranslate nohighlight">\( H_{kin} \)</span></p></td>
<td><p>Kinematic hardening modulus   </p></td>
<td><p>Stress   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>State Variables (statev):</strong></p>
<p>Total state variables required: <span class="math notranslate nohighlight">\( n_{statev} = 14 \)</span></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>statev[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( T_{init} \)</span></p></td>
<td><p>Initial temperature   </p></td>
<td><p>Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( p \)</span></p></td>
<td><p>Accumulated plastic strain   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{11} \)</span></p></td>
<td><p>Plastic strain component 11   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{22} \)</span></p></td>
<td><p>Plastic strain component 22   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{33} \)</span></p></td>
<td><p>Plastic strain component 33   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{12} \)</span></p></td>
<td><p>Plastic strain component 12   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[6]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{13} \)</span></p></td>
<td><p>Plastic strain component 13   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[7]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^p_{23} \)</span></p></td>
<td><p>Plastic strain component 23   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[8]   </p></td>
<td><p><span class="math notranslate nohighlight">\( X_{11} \)</span></p></td>
<td><p>Backstress component 11   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[9]   </p></td>
<td><p><span class="math notranslate nohighlight">\( X_{22} \)</span></p></td>
<td><p>Backstress component 22   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>statev[10]   </p></td>
<td><p><span class="math notranslate nohighlight">\( X_{33} \)</span></p></td>
<td><p>Backstress component 33   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[11]   </p></td>
<td><p><span class="math notranslate nohighlight">\( X_{12} \)</span></p></td>
<td><p>Backstress component 12   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>statev[12]   </p></td>
<td><p><span class="math notranslate nohighlight">\( X_{13} \)</span></p></td>
<td><p>Backstress component 13   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[13]   </p></td>
<td><p><span class="math notranslate nohighlight">\( X_{23} \)</span></p></td>
<td><p>Backstress component 23   </p></td>
<td><p>Stress   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>References:</strong><ul class="simple">
<li><p>Prager, W. (1956). “A new method of analyzing stresses and strains in work-hardening plastic solids.” <em>J. Appl. Mech.</em>, 23, 493-496.</p></li>
<li><p>Ziegler, H. (1959). “A modification of Prager’s hardening rule.” <em>Q. Appl. Math.</em>, 17, 55-65.</p></li>
<li><p>Lemaitre, J., &amp; Chaboche, J. L. (1990). <em>Mechanics of Solid Materials</em>. Cambridge University Press.</p></li>
<li><p>Simo, J. C., &amp; Hughes, T. J. R. (1998). <em>Computational Inelasticity</em>. Springer. </p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__umat__mechanical_1ga2e8f1aa0df902c7c6518a458c728d07a"><span class="std std-ref">umat_plasticity_iso_CCP()</span></a> for pure isotropic hardening </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__umat__mechanical_1gad0775f735c8fc1e7adfc1f4e5a31dce2"><span class="std std-ref">umat_plasticity_chaboche_CCP()</span></a> for nonlinear kinematic hardening</p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Linear kinematic hardening cannot capture cyclic softening/hardening saturation </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For saturating kinematic hardening, use the Chaboche model (Armstrong-Frederick) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Bauschinger effect is proportional to the kinematic hardening modulus </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting <span class="math notranslate nohighlight">\( H_{kin} = 0 \)</span> recovers pure isotropic hardening </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting <span class="math notranslate nohighlight">\( k = 0 \)</span> (or <span class="math notranslate nohighlight">\( m = 0 \)</span>) recovers pure kinematic hardening</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Etot</strong> – Total strain tensor at beginning of increment (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>DEtot</strong> – Strain increment tensor (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>sigma</strong> – Stress tensor (Voigt notation: 6×1 vector) [output] </p></li>
<li><p><strong>Lt</strong> – Consistent tangent modulus (6×6 matrix) [output] </p></li>
<li><p><strong>L</strong> – Elastic stiffness tensor (6×6 matrix) [output] </p></li>
<li><p><strong>sigma_in</strong> – Internal stress contribution for explicit solvers (6×1 vector) [output] </p></li>
<li><p><strong>DR</strong> – Rotation increment matrix (3×3) for objective integration </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Material properties vector (see table above) </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – State variables vector (see table above) [input/output] </p></li>
<li><p><strong>T</strong> – Temperature at beginning of increment </p></li>
<li><p><strong>DT</strong> – Temperature increment </p></li>
<li><p><strong>Time</strong> – Time at beginning of increment </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>Wm</strong> – Total mechanical work [output] </p></li>
<li><p><strong>Wm_r</strong> – Recoverable (elastic) work [output] </p></li>
<li><p><strong>Wm_ir</strong> – Irrecoverable work stored in hardening [output] </p></li>
<li><p><strong>Wm_d</strong> – Dissipated (plastic) work [output] </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components (typically 3) </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components (typically 3) </p></li>
<li><p><strong>start</strong> – Flag indicating first increment (true) or continuation (false) </p></li>
<li><p><strong>solver_type</strong> – Solver type: 0=implicit, 1=explicit, 2=dynamic implicit </p></li>
<li><p><strong>tnew_dt</strong> – Suggested new time step size for adaptive time stepping [output]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413umat_sma_monoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd">
<span id="_CPPv313umat_sma_monoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd"></span><span id="_CPPv213umat_sma_monoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd"></span><span id="umat_sma_mono__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.doubleR"></span><span class="target" id="group__umat__mechanical_1ga42d5556397e4ef76b7d4605f6d00aed2"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_sma_mono</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">L</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_ir</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_d</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tnew_dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413umat_sma_monoRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd" title="Link to this definition"></a><br /></dt>
<dd><p>Micromechanical monocrystal model for SMA based on Patoor et al. (1996) </p>
<p>This function implements the micromechanical monocrystal model of Patoor et al. (1996) for shape memory alloys. The model describes the martensitic phase transformation in a single crystal by tracking N individual martensite variants, where N is typically 12 or 24 depending on the crystallographic system.</p>
<p><strong>Key Features:</strong><ul class="simple">
<li><p>Explicit tracking of N martensite variant volume fractions <span class="math notranslate nohighlight">\( f_n \)</span> (n = 1, …, N)</p></li>
<li><p>Crystallographic transformation strains for each variant</p></li>
<li><p>Variant selection driven by resolved thermodynamic driving force</p></li>
<li><p>Inter-variant interactions through hardening matrix</p></li>
<li><p>Applicable to single crystal SMA behavior</p></li>
</ul>
</p>
<p><strong>Physical Background:</strong></p>
<p>In single crystal SMAs, the austenite-to-martensite transformation occurs through the formation of distinct crystallographic variants. For cubic-to-monoclinic transformations (e.g., NiTi), there are typically 12 or 24 habit plane variants, each characterized by:<ul class="simple">
<li><p>A specific transformation strain tensor <span class="math notranslate nohighlight">\( \boldsymbol{\varepsilon}^{tr}_n \)</span></p></li>
<li><p>A habit plane normal and transformation direction</p></li>
</ul>
</p>
<p><strong>Variant Volume Fractions:</strong></p>
<p>The microstructural state is characterized by N variant volume fractions:   <div class="math notranslate nohighlight">
\[f_n \geq 0, \quad \sum_{n=1}^{N} f_n \leq 1, \quad f_A = 1 - \sum_{n=1}^{N} f_n
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( f_n \)</span> is the volume fraction of martensite variant n</p></li>
<li><p><span class="math notranslate nohighlight">\( f_A \)</span> is the austenite volume fraction</p></li>
<li><p>The total martensite fraction is <span class="math notranslate nohighlight">\( \xi = \sum_{n=1}^{N} f_n \)</span></p></li>
</ul>
</p>
<p><strong>Transformation Strain:</strong></p>
<p>The macroscopic transformation strain is the volume-weighted sum over all variants:   <div class="math notranslate nohighlight">
\[\boldsymbol{\varepsilon}^{tr} = \sum_{n=1}^{N} f_n \boldsymbol{\varepsilon}^{tr}_n
\]</div>
 where <span class="math notranslate nohighlight">\( \boldsymbol{\varepsilon}^{tr}_n \)</span> is the crystallographic transformation strain tensor of variant n, computed from the lattice correspondence.</p>
<p><strong>Thermodynamic Driving Force:</strong></p>
<p>For each variant n, the driving force for transformation is:   <div class="math notranslate nohighlight">
\[F_n = \boldsymbol{\sigma} : \boldsymbol{\varepsilon}^{tr}_n - \Delta G^{chem}(T) - \sum_{m=1}^{N} H_{nm} f_m
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \boldsymbol{\sigma} : \boldsymbol{\varepsilon}^{tr}_n \)</span> is the mechanical driving force</p></li>
<li><p><span class="math notranslate nohighlight">\( \Delta G^{chem}(T) \)</span> is the chemical free energy difference (temperature-dependent)</p></li>
<li><p><span class="math notranslate nohighlight">\( H_{nm} \)</span> is the interaction matrix describing variant-variant hardening</p></li>
</ul>
</p>
<p><strong>Transformation Criteria:</strong></p>
<p><strong>Forward Transformation (A → M_n):</strong><div class="math notranslate nohighlight">
\[\Phi_n^{fwd} = F_n - F_c^{fwd} \leq 0, \quad \dot{f}_n \geq 0
\]</div>
</p>
<p><strong>Reverse Transformation (M_n → A):</strong><div class="math notranslate nohighlight">
\[\Phi_n^{rev} = -F_n - F_c^{rev} \leq 0, \quad \dot{f}_n \leq 0
\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\( F_c^{fwd} \)</span> and <span class="math notranslate nohighlight">\( F_c^{rev} \)</span> are critical driving forces for forward and reverse transformations.</p>
<p><strong>Interaction Matrix:</strong></p>
<p>The hardening matrix <span class="math notranslate nohighlight">\( H_{nm} \)</span> captures:<ul class="simple">
<li><p>Self-hardening ( <span class="math notranslate nohighlight">\( H_{nn} \)</span>): resistance to growth of variant n</p></li>
<li><p>Latent hardening ( <span class="math notranslate nohighlight">\( H_{nm}, n \neq m \)</span>): interaction between different variants</p></li>
</ul>
</p>
<p><strong>Variant Selection:</strong></p>
<p>Under applied stress, variants with favorable orientation (high resolved stress on transformation system) are preferentially activated. This leads to:<ul class="simple">
<li><p>Single variant formation under uniaxial loading along specific orientations</p></li>
<li><p>Multi-variant microstructures under complex loading</p></li>
<li><p>Texture-dependent macroscopic response</p></li>
</ul>
</p>
<p><strong>Number of Variants:</strong></p>
<p>Common crystallographic systems:<ul class="simple">
<li><p>Cubic → Orthorhombic: N = 6 variants</p></li>
<li><p>Cubic → Monoclinic (NiTi): N = 12 or 24 variants</p></li>
<li><p>Cubic → Tetragonal: N = 3 variants</p></li>
</ul>
</p>
<p><strong>State Variables (statev):</strong></p>
<p>Total state variables required: <span class="math notranslate nohighlight">\( n_{statev} = 1 + N + 6 \)</span> (for N variants)</p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>statev[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( T_{init} \)</span></p></td>
<td><p>Initial/reference temperature   </p></td>
<td><p>Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( f_1 \)</span></p></td>
<td><p>Volume fraction of martensite variant 1   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-even"><td><p>statev[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( f_2 \)</span></p></td>
<td><p>Volume fraction of martensite variant 2   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-odd"><td><p>…   </p></td>
<td><p>…   </p></td>
<td><p>…   </p></td>
<td><p>…    </p></td>
</tr>
<tr class="row-even"><td><p>statev[N]   </p></td>
<td><p><span class="math notranslate nohighlight">\( f_N \)</span></p></td>
<td><p>Volume fraction of martensite variant N   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[N+1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^{tr}_{11} \)</span></p></td>
<td><p>Macroscopic transformation strain component 11   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[N+2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^{tr}_{22} \)</span></p></td>
<td><p>Macroscopic transformation strain component 22   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[N+3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^{tr}_{33} \)</span></p></td>
<td><p>Macroscopic transformation strain component 33   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[N+4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^{tr}_{12} \)</span></p></td>
<td><p>Macroscopic transformation strain component 12   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[N+5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^{tr}_{13} \)</span></p></td>
<td><p>Macroscopic transformation strain component 13   </p></td>
<td><p>Strain    </p></td>
</tr>
<tr class="row-even"><td><p>statev[N+6]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \varepsilon^{tr}_{23} \)</span></p></td>
<td><p>Macroscopic transformation strain component 23   </p></td>
<td><p>Strain   </p></td>
</tr>
</tbody>
</table>
</p>
<p>The macroscopic transformation strain is computed as: <span class="math notranslate nohighlight">\( \boldsymbol{\varepsilon}^{tr} = \sum_{n=1}^{N} f_n \boldsymbol{\varepsilon}^{tr}_n \)</span></p>
<p><strong>References:</strong><ul class="simple">
<li><p><p>Patoor, E., Eberhardt, A., &amp; Berveiller, M. (1996). “Micromechanical modelling of</p>
<p>superelasticity in shape memory alloys.”</p>
<em>Journal de Physique IV</em>, 6(C1), 277-292.</p></li>
<li><p>Patoor, E., Lagoudas, D. C., Entchev, P. B., Brinson, L. C., &amp; Gao, X. (2006). “Shape memory alloys, Part I: General properties and modeling of single crystals.” <em>Mechanics of Materials</em>, 38(5-6), 391-429.</p></li>
<li><p><p>Gall, K., &amp; Sehitoglu, H. (1999). “The role of texture in tension-compression</p>
<p>asymmetry in polycrystalline NiTi.”</p>
<em>International Journal of Plasticity</em>, 15(1), 69-92. </p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This model is specifically for <strong>single crystal</strong> SMA behavior </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For polycrystalline SMAs, use this model within a homogenization scheme </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of variants N depends on the crystallographic transformation system </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Variant transformation strains must be provided based on crystallographic data</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Etot</strong> – Total strain tensor at beginning of increment (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>DEtot</strong> – Strain increment tensor (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>sigma</strong> – Cauchy stress tensor (Voigt notation: 6×1 vector) [output] </p></li>
<li><p><strong>Lt</strong> – Consistent tangent modulus (6×6 matrix) [output] </p></li>
<li><p><strong>L</strong> – Elastic stiffness tensor (6×6 matrix) [output] </p></li>
<li><p><strong>DR</strong> – Rotation increment matrix (3×3) for objective integration </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Material properties vector </p></li>
<li><p><strong>nstatev</strong> – Number of state variables (includes N variant volume fractions) </p></li>
<li><p><strong>statev</strong> – State variables vector containing variant fractions [input/output] </p></li>
<li><p><strong>T</strong> – Temperature at beginning of increment </p></li>
<li><p><strong>DT</strong> – Temperature increment </p></li>
<li><p><strong>Time</strong> – Time at beginning of increment </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>Wm</strong> – Total mechanical work [output] </p></li>
<li><p><strong>Wm_r</strong> – Recoverable (elastic) work [output] </p></li>
<li><p><strong>Wm_ir</strong> – Irrecoverable work stored in transformation [output] </p></li>
<li><p><strong>Wm_d</strong> – Dissipated work (hysteresis) [output] </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components (typically 3) </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components (typically 3) </p></li>
<li><p><strong>start</strong> – Flag indicating first increment (true) or continuation (false) </p></li>
<li><p><strong>tnew_dt</strong> – Suggested new time step size for adaptive time stepping [output]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416umat_prony_NfastRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd">
<span id="_CPPv316umat_prony_NfastRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd"></span><span id="_CPPv216umat_prony_NfastRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd"></span><span id="umat_prony_Nfast__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.doubleR"></span><span class="target" id="group__umat__mechanical_1ga3b458b2e70aef216dee52bd42f40a49e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_prony_Nfast</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_ir</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_d</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tnew_dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416umat_prony_NfastRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd" title="Link to this definition"></a><br /></dt>
<dd><p>Linear viscoelastic constitutive model with Prony series representation (Generalized Maxwell model) </p>
<p>This function implements a linear viscoelastic material model using the Prony series decomposition, also known as the Generalized Maxwell model. The model consists of multiple Maxwell elements in parallel, each characterized by a relaxation time and modulus.</p>
<p><strong>Constitutive Equations:</strong></p>
<p>The relaxation modulus is expressed as a Prony series:   <div class="math notranslate nohighlight">
\[E(t) = E_\infty + \sum_{i=1}^N E_i e^{-t/\tau_i}
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( E_\infty \)</span> is the long-term (equilibrium) modulus</p></li>
<li><p><span class="math notranslate nohighlight">\( E_i \)</span> is the modulus of the i-th Maxwell element</p></li>
<li><p><span class="math notranslate nohighlight">\( \tau_i \)</span> is the relaxation time of the i-th element</p></li>
<li><p><span class="math notranslate nohighlight">\( N \)</span> is the number of Maxwell elements</p></li>
</ul>
</p>
<p><strong>Incremental Form:</strong></p>
<p>The stress at time <span class="math notranslate nohighlight">\( t + \Delta t \)</span> is computed as:   <div class="math notranslate nohighlight">
\[\boldsymbol{\sigma}(t + \Delta t) = \mathbf{L}_\infty : \boldsymbol{\varepsilon}(t + \Delta t) + \sum_{i=1}^N \mathbf{q}_i(t + \Delta t)
\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\( \mathbf{q}_i \)</span> are the internal state variables (stress-like quantities) that evolve according to:   <div class="math notranslate nohighlight">
\[\mathbf{q}_i(t + \Delta t) = e^{-\Delta t/\tau_i} \mathbf{q}_i(t) + \frac{E_i}{E_\infty} \mathbf{L}_\infty : \left( e^{-\Delta t/\tau_i} - 1 \right) \Delta \boldsymbol{\varepsilon}
\]</div>
</p>
<p><strong>Bulk and Shear Decomposition:</strong></p>
<p>The model handles volumetric and deviatoric responses independently:<ul class="simple">
<li><p>Volumetric: <span class="math notranslate nohighlight">\( K(t) = K_\infty + \sum_{i=1}^N K_i e^{-t/\tau_i^K} \)</span></p></li>
<li><p>Deviatoric: <span class="math notranslate nohighlight">\( G(t) = G_\infty + \sum_{i=1}^N G_i e^{-t/\tau_i^G} \)</span></p></li>
</ul>
</p>
<p><strong>Consistent Tangent Modulus:</strong></p>
<p>For implicit finite element analysis:   <div class="math notranslate nohighlight">
\[\mathbf{L}_t = \mathbf{L}_\infty + \sum_{i=1}^N \left( 1 - e^{-\Delta t/\tau_i} \right) \mathbf{L}_i
\]</div>
</p>
<p><strong>Material Parameters (props):</strong></p>
<p>For N Maxwell elements, the props vector contains: <table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>props[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( N \)</span></p></td>
<td><p>Number of Maxwell elements   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-odd"><td><p>props[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E_\infty \)</span></p></td>
<td><p>Equilibrium Young’s modulus   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>props[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \nu_\infty \)</span></p></td>
<td><p>Equilibrium Poisson’s ratio   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-odd"><td><p>props[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \alpha \)</span></p></td>
<td><p>Thermal expansion coefficient   </p></td>
<td><p>1/Temperature    </p></td>
</tr>
<tr class="row-even"><td><p>props[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E_1 \)</span></p></td>
<td><p>Modulus of 1st Maxwell element   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>props[5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \tau_1 \)</span></p></td>
<td><p>Relaxation time of 1st element   </p></td>
<td><p>Time    </p></td>
</tr>
<tr class="row-even"><td><p>…   </p></td>
<td><p>…   </p></td>
<td><p>…   </p></td>
<td><p>…    </p></td>
</tr>
<tr class="row-odd"><td><p>props[4+2(i-1)]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E_i \)</span></p></td>
<td><p>Modulus of i-th element   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>props[5+2(i-1)]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \tau_i \)</span></p></td>
<td><p>Relaxation time of i-th element   </p></td>
<td><p>Time   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>State Variables (statev):</strong></p>
<p>For each Maxwell element, 6 internal state variables store the stress-like quantities <span class="math notranslate nohighlight">\( \mathbf{q}_i \)</span>: <table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>statev[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( T_{init} \)</span></p></td>
<td><p>Initial temperature   </p></td>
<td><p>Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[1:6]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \mathbf{q}_1 \)</span></p></td>
<td><p>Internal stresses of 1st element (Voigt)   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>statev[7:12]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \mathbf{q}_2 \)</span></p></td>
<td><p>Internal stresses of 2nd element (Voigt)   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>…   </p></td>
<td><p>…   </p></td>
<td><p>…   </p></td>
<td><p>…    </p></td>
</tr>
<tr class="row-even"><td><p>statev[1+6(i-1):6i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \mathbf{q}_i \)</span></p></td>
<td><p>Internal stresses of i-th element (Voigt)   </p></td>
<td><p>Stress   </p></td>
</tr>
</tbody>
</table>
</p>
<p>Total state variables required: <span class="math notranslate nohighlight">\( n_{statev} = 1 + 6N \)</span></p>
<p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Example</span> <span class="n">usage</span><span class="p">:</span> <span class="mi">2</span> <span class="n">Maxwell</span> <span class="n">elements</span>
<span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">vec</span> <span class="n">props</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
<span class="n">props</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span>          <span class="o">//</span> <span class="mi">2</span> <span class="n">Maxwell</span> <span class="n">elements</span>
<span class="n">props</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span>       <span class="o">//</span> <span class="n">E_inf</span> <span class="o">=</span> <span class="mi">1000</span> <span class="n">MPa</span>
<span class="n">props</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>        <span class="o">//</span> <span class="n">nu_inf</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">props</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">;</span>       <span class="o">//</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1e-5</span> <span class="o">/</span><span class="n">K</span>
<span class="n">props</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>        <span class="o">//</span> <span class="n">E_1</span> <span class="o">=</span> <span class="mi">500</span> <span class="n">MPa</span>
<span class="n">props</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>        <span class="o">//</span> <span class="n">tau_1</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="n">s</span>
<span class="n">props</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>        <span class="o">//</span> <span class="n">E_2</span> <span class="o">=</span> <span class="mi">200</span> <span class="n">MPa</span>
<span class="n">props</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>        <span class="o">//</span> <span class="n">tau_2</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="n">s</span>

<span class="n">vec</span> <span class="n">statev</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">N</span><span class="p">);</span>  <span class="o">//</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">12</span> <span class="n">state</span> <span class="n">variables</span>
<span class="n">vec</span> <span class="n">Etot</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>
<span class="n">vec</span> <span class="n">DEtot</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>
<span class="n">vec</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="n">mat</span> <span class="n">Lt</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>
<span class="n">mat</span> <span class="n">DR</span> <span class="o">=</span> <span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>

<span class="n">umat_prony_Nfast</span><span class="p">(</span><span class="n">Etot</span><span class="p">,</span> <span class="n">DEtot</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">Lt</span><span class="p">,</span> <span class="n">DR</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="n">statev</span><span class="p">,</span>
                 <span class="mf">20.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">Wm</span><span class="p">,</span> <span class="n">Wm_r</span><span class="p">,</span> <span class="n">Wm_ir</span><span class="p">,</span> <span class="n">Wm_d</span><span class="p">,</span>
                 <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">false</span><span class="p">,</span> <span class="n">tnew_dt</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../continuum_mechanics/functions/constitutive.html#group__constitutive_1gaf485036362aaf2d53d4057c64b16cba8"><span class="std std-ref">L_iso()</span></a> for isotropic elastic stiffness construction </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../continuum_mechanics/functions/constitutive.html#group__constitutive_1ga26aa9d2e852a11d4de1edc0574468218"><span class="std std-ref">Ivol()</span></a> for volumetric projection tensor </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../continuum_mechanics/functions/constitutive.html#group__constitutive_1ga8d4770913e5c1d521a6aaf9ae3d2bb8d"><span class="std std-ref">Idev()</span></a> for deviatoric projection tensor</p>
</div>
</p>
<p><strong>References:</strong><ul class="simple">
<li><p>Ferry, J. D. (1980). <em>Viscoelastic Properties of Polymers</em> (3rd ed.). Wiley.</p></li>
<li><p>Simo, J. C., &amp; Hughes, T. J. R. (1998). <em>Computational Inelasticity</em>. Springer.</p></li>
<li><p>Park, S. W., &amp; Schapery, R. A. (1999). “Methods of interconversion between linear viscoelastic material functions. Part I—A numerical method based on Prony series.” <em>International Journal of Solids and Structures</em>, 36(11), 1653-1675. </p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Prony series provides an efficient representation for viscoelastic relaxation </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Relaxation times should span the expected loading time scales </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For frequency-domain data, use fitting algorithms to extract Prony parameters </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The model assumes small strains and linear viscoelasticity </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Time step should be small relative to shortest relaxation time for accuracy</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Etot</strong> – Total strain tensor at beginning of increment (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>DEtot</strong> – Strain increment tensor (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>sigma</strong> – Stress tensor (Voigt notation: 6×1 vector) [output] </p></li>
<li><p><strong>Lt</strong> – Consistent tangent modulus (6×6 matrix) [output] </p></li>
<li><p><strong>DR</strong> – Rotation increment matrix (3×3) for objective integration </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Material properties vector (see table above) </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – State variables vector (see table above) [input/output] </p></li>
<li><p><strong>T</strong> – Temperature at beginning of increment </p></li>
<li><p><strong>DT</strong> – Temperature increment </p></li>
<li><p><strong>Time</strong> – Time at beginning of increment </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>Wm</strong> – Total mechanical work [output] </p></li>
<li><p><strong>Wm_r</strong> – Recoverable (elastic) work [output] </p></li>
<li><p><strong>Wm_ir</strong> – Irrecoverable work stored in viscous elements [output] </p></li>
<li><p><strong>Wm_d</strong> – Dissipated (viscous) work [output] </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components (typically 3) </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components (typically 3) </p></li>
<li><p><strong>start</strong> – Flag indicating first increment (true) or continuation (false) </p></li>
<li><p><strong>tnew_dt</strong> – Suggested new time step size for adaptive time stepping [output]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415umat_zener_fastRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd">
<span id="_CPPv315umat_zener_fastRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd"></span><span id="_CPPv215umat_zener_fastRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd"></span><span id="umat_zener_fast__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.doubleR"></span><span class="target" id="group__umat__mechanical_1ga6884029478cfdc54c964e5a3bffa9744"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_zener_fast</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_ir</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_d</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tnew_dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415umat_zener_fastRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd" title="Link to this definition"></a><br /></dt>
<dd><p>Linear viscoelastic constitutive model using the Zener (Standard Linear Solid) model. </p>
<p>This function implements a linear viscoelastic material model using the Zener model, also known as the Standard Linear Solid (SLS). The Zener model consists of a spring in series with a Kelvin-Voigt element (spring and dashpot in parallel), providing both instantaneous elastic response and time-dependent relaxation.</p>
<p><strong>Rheological Representation:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  E_0 (instantaneous)
─────────┬─────────
         │
  ┌──────┴──────┐
  │   E_1      η_1   │  (Kelvin-Voigt element)
  │ ──/\/\──┬──[=]──│
  │         │        │
  └─────────┴────────┘
</pre></div>
</div>
<p><strong>Constitutive Equations:</strong></p>
<p>The Zener model stress-strain relationship is given by:   <div class="math notranslate nohighlight">
\[   \boldsymbol{\sigma} + \tau \dot{\boldsymbol{\sigma}} = E_0 \boldsymbol{\varepsilon} + (E_0 + E_1) \tau \dot{\boldsymbol{\varepsilon}}
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( E_0 \)</span> is the instantaneous (glassy) modulus</p></li>
<li><p><span class="math notranslate nohighlight">\( E_1 \)</span> is the modulus of the Kelvin-Voigt element</p></li>
<li><p><span class="math notranslate nohighlight">\( \tau = \eta_1 / E_1 \)</span> is the relaxation time</p></li>
<li><p><span class="math notranslate nohighlight">\( \eta_1 \)</span> is the viscosity of the dashpot</p></li>
</ul>
</p>
<p><strong>Relaxation Modulus:</strong></p>
<p>The relaxation modulus for the Zener model is:   <div class="math notranslate nohighlight">
\[   E(t) = E_\infty + (E_0 - E_\infty) e^{-t/\tau}
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( E_\infty = \frac{E_0 E_1}{E_0 + E_1} \)</span> is the long-term (rubbery) modulus</p></li>
<li><p><span class="math notranslate nohighlight">\( E_0 \)</span> is the instantaneous modulus</p></li>
<li><p><span class="math notranslate nohighlight">\( \tau \)</span> is the relaxation time</p></li>
</ul>
</p>
<p><strong>Creep Compliance:</strong></p>
<p>The creep compliance is:   <div class="math notranslate nohighlight">
\[   J(t) = \frac{1}{E_0} + \frac{1}{E_1} \left( 1 - e^{-t/\tau_c} \right)
\]</div>
 where <span class="math notranslate nohighlight">\( \tau_c = \eta_1 / E_1 \)</span> is the retardation time.</p>
<p><strong>Incremental Form:</strong></p>
<p>For numerical integration over a time step <span class="math notranslate nohighlight">\( \Delta t \)</span>:   <div class="math notranslate nohighlight">
\[   \boldsymbol{\sigma}_{n+1} = \mathbf{L}_\infty : \boldsymbol{\varepsilon}_{n+1} + \mathbf{q}_{n+1}
\]</div>
 where the internal variable <span class="math notranslate nohighlight">\( \mathbf{q} \)</span> evolves as:   <div class="math notranslate nohighlight">
\[   \mathbf{q}_{n+1} = e^{-\Delta t/\tau} \mathbf{q}_n + \frac{E_1 - E_\infty}{E_\infty} \mathbf{L}_\infty : \left( e^{-\Delta t/\tau} - 1 \right) \Delta \boldsymbol{\varepsilon}
\]</div>
</p>
<p><strong>Material Parameters (props):</strong></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>props[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E_\infty \)</span></p></td>
<td><p>Equilibrium (long-term) Young’s modulus   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>props[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \nu \)</span></p></td>
<td><p>Poisson’s ratio (assumed constant)   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-even"><td><p>props[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \alpha \)</span></p></td>
<td><p>Thermal expansion coefficient   </p></td>
<td><p>1/Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>props[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E_1 \)</span></p></td>
<td><p>Modulus of Kelvin-Voigt element   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>props[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \tau \)</span></p></td>
<td><p>Relaxation time   </p></td>
<td><p>Time   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>State Variables (statev):</strong></p>
<p>Total state variables required: <span class="math notranslate nohighlight">\( n_{statev} = 7 \)</span></p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>statev[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( T_{init} \)</span></p></td>
<td><p>Initial temperature   </p></td>
<td><p>Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[1:6]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \mathbf{q} \)</span></p></td>
<td><p>Internal stress-like variable (Voigt 6×1)   </p></td>
<td><p>Stress   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>References:</strong><ul class="simple">
<li><p>Zener, C. (1948). <em>Elasticity and Anelasticity of Metals</em>. University of Chicago Press.</p></li>
<li><p>Ferry, J. D. (1980). <em>Viscoelastic Properties of Polymers</em> (3rd ed.). Wiley.</p></li>
<li><p>Simo, J. C., &amp; Hughes, T. J. R. (1998). <em>Computational Inelasticity</em>. Springer. </p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Zener model is the simplest model capturing both creep and relaxation </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For multiple relaxation times, use the Prony series model (umat_prony_Nfast) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Time step should be small relative to relaxation time for accuracy </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The model assumes small strains and linear viscoelasticity</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Etot</strong> – Total strain tensor at beginning of increment (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>DEtot</strong> – Strain increment tensor (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>sigma</strong> – Stress tensor (Voigt notation: 6×1 vector) [output] </p></li>
<li><p><strong>Lt</strong> – Consistent tangent modulus (6×6 matrix) [output] </p></li>
<li><p><strong>DR</strong> – Rotation increment matrix (3×3) for objective integration </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Material properties vector (see table above) </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – State variables vector (see table above) [input/output] </p></li>
<li><p><strong>T</strong> – Temperature at beginning of increment </p></li>
<li><p><strong>DT</strong> – Temperature increment </p></li>
<li><p><strong>Time</strong> – Time at beginning of increment </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>Wm</strong> – Total mechanical work [output] </p></li>
<li><p><strong>Wm_r</strong> – Recoverable (elastic) work [output] </p></li>
<li><p><strong>Wm_ir</strong> – Irrecoverable work stored in viscous elements [output] </p></li>
<li><p><strong>Wm_d</strong> – Dissipated (viscous) work [output] </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components (typically 3) </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components (typically 3) </p></li>
<li><p><strong>start</strong> – Flag indicating first increment (true) or continuation (false) </p></li>
<li><p><strong>tnew_dt</strong> – Suggested new time step size for adaptive time stepping [output]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416umat_zener_NfastRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd">
<span id="_CPPv316umat_zener_NfastRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd"></span><span id="_CPPv216umat_zener_NfastRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd"></span><span id="umat_zener_Nfast__arma::vecCR.arma::vecCR.arma::vecR.arma::matR.arma::matCR.iCR.arma::vecCR.iCR.arma::vecR.doubleCR.doubleCR.doubleCR.doubleCR.doubleR.doubleR.doubleR.doubleR.iCR.iCR.bCR.doubleR"></span><span class="target" id="group__umat__mechanical_1gabea0cc58e8a05078fa7011fcb477aa77"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">umat_zener_Nfast</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Etot</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DEtot</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sigma</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Lt</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mat</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DR</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nprops</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">props</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nstatev</span></span>, <span class="n"><span class="pre">arma</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vec</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">statev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">T</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DT</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">DTime</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_ir</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Wm_d</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ndi</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">nshr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">start</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tnew_dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416umat_zener_NfastRKN4arma3vecERKN4arma3vecERN4arma3vecERN4arma3matERKN4arma3matERKiRKN4arma3vecERKiRN4arma3vecERKdRKdRKdRKdRdRdRdRdRKiRKiRKbRd" title="Link to this definition"></a><br /></dt>
<dd><p>Generalized Zener (Standard Linear Solid) viscoelastic model with N parallel branches. </p>
<p>This function implements a generalized linear viscoelastic material model using N Zener (Maxwell) elements in parallel with a long-term equilibrium spring. This is equivalent to a Generalized Maxwell model and provides a discrete approximation of the continuous relaxation spectrum.</p>
<p><strong>Rheological Representation:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                 E_∞ (equilibrium spring)
────────────────────/\/\/\────────────────
         │                       │
         ├──── E_1 ─[η_1]────────┤   Branch 1
         │                       │
         ├──── E_2 ─[η_2]────────┤   Branch 2
         │                       │
         │         ...           │
         │                       │
         └──── E_N ─[η_N]────────┘   Branch N
</pre></div>
</div>
<p><strong>Constitutive Equations:</strong></p>
<p>The relaxation modulus is expressed as a sum of exponentials (Prony series):   <div class="math notranslate nohighlight">
\[   E(t) = E_\infty + \sum_{i=1}^N E_i e^{-t/\tau_i}
\]</div>
 where:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( E_\infty \)</span> is the long-term (equilibrium) modulus</p></li>
<li><p><span class="math notranslate nohighlight">\( E_i \)</span> is the modulus of the i-th Maxwell element</p></li>
<li><p><span class="math notranslate nohighlight">\( \tau_i = \eta_i / E_i \)</span> is the relaxation time of the i-th element</p></li>
<li><p><span class="math notranslate nohighlight">\( N \)</span> is the number of Maxwell elements</p></li>
</ul>
</p>
<p><strong>Instantaneous Modulus:</strong></p>
<p>At <span class="math notranslate nohighlight">\( t = 0 \)</span>:   <div class="math notranslate nohighlight">
\[   E_0 = E(0) = E_\infty + \sum_{i=1}^N E_i
\]</div>
</p>
<p><strong>Stress Decomposition:</strong></p>
<p>The total stress is the sum of the equilibrium stress and internal stresses:   <div class="math notranslate nohighlight">
\[   \boldsymbol{\sigma} = \mathbf{L}_\infty : \boldsymbol{\varepsilon} + \sum_{i=1}^N \mathbf{q}_i
\]</div>
 where <span class="math notranslate nohighlight">\( \mathbf{q}_i \)</span> are the internal stress-like variables for each Maxwell element.</p>
<p><strong>Internal Variable Evolution:</strong></p>
<p>Each internal variable evolves according to:   <div class="math notranslate nohighlight">
\[   \dot{\mathbf{q}}_i + \frac{1}{\tau_i} \mathbf{q}_i = \frac{E_i}{E_\infty} \mathbf{L}_\infty : \dot{\boldsymbol{\varepsilon}}
\]</div>
</p>
<p><strong>Incremental Form:</strong></p>
<p>For numerical integration over a time step <span class="math notranslate nohighlight">\( \Delta t \)</span>:   <div class="math notranslate nohighlight">
\[   \mathbf{q}_{i,n+1} = e^{-\Delta t/\tau_i} \mathbf{q}_{i,n} + \frac{E_i}{E_\infty} \mathbf{L}_\infty : \frac{\tau_i}{\Delta t} \left( 1 - e^{-\Delta t/\tau_i} \right) \Delta \boldsymbol{\varepsilon}
\]</div>
</p>
<p><strong>Consistent Tangent Modulus:</strong></p>
<p>For implicit finite element analysis:   <div class="math notranslate nohighlight">
\[   \mathbf{L}_t = \mathbf{L}_\infty \left( 1 + \sum_{i=1}^N \frac{E_i}{E_\infty} \frac{\tau_i}{\Delta t} \left( 1 - e^{-\Delta t/\tau_i} \right) \right)
\]</div>
</p>
<p><strong>Material Parameters (props):</strong></p>
<p>For N Maxwell elements, the props vector contains:</p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>props[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( N \)</span></p></td>
<td><p>Number of Maxwell elements   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-odd"><td><p>props[1]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E_\infty \)</span></p></td>
<td><p>Equilibrium Young’s modulus   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>props[2]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \nu \)</span></p></td>
<td><p>Poisson’s ratio (assumed constant)   </p></td>
<td><p>-    </p></td>
</tr>
<tr class="row-odd"><td><p>props[3]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \alpha \)</span></p></td>
<td><p>Thermal expansion coefficient   </p></td>
<td><p>1/Temperature    </p></td>
</tr>
<tr class="row-even"><td><p>props[4]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E_1 \)</span></p></td>
<td><p>Modulus of 1st Maxwell element   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>props[5]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \tau_1 \)</span></p></td>
<td><p>Relaxation time of 1st element   </p></td>
<td><p>Time    </p></td>
</tr>
<tr class="row-even"><td><p>…   </p></td>
<td><p>…   </p></td>
<td><p>…   </p></td>
<td><p>…    </p></td>
</tr>
<tr class="row-odd"><td><p>props[4+2(i-1)]   </p></td>
<td><p><span class="math notranslate nohighlight">\( E_i \)</span></p></td>
<td><p>Modulus of i-th element   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>props[5+2(i-1)]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \tau_i \)</span></p></td>
<td><p>Relaxation time of i-th element   </p></td>
<td><p>Time   </p></td>
</tr>
</tbody>
</table>
</p>
<p><strong>State Variables (statev):</strong></p>
<p>For each Maxwell element, 6 internal state variables store the stress-like quantities:</p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index   </p></th>
<th class="head"><p>Symbol   </p></th>
<th class="head"><p>Description   </p></th>
<th class="head"><p>Units    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>statev[0]   </p></td>
<td><p><span class="math notranslate nohighlight">\( T_{init} \)</span></p></td>
<td><p>Initial temperature   </p></td>
<td><p>Temperature    </p></td>
</tr>
<tr class="row-odd"><td><p>statev[1:6]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \mathbf{q}_1 \)</span></p></td>
<td><p>Internal stresses of 1st element (Voigt)   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-even"><td><p>statev[7:12]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \mathbf{q}_2 \)</span></p></td>
<td><p>Internal stresses of 2nd element (Voigt)   </p></td>
<td><p>Stress    </p></td>
</tr>
<tr class="row-odd"><td><p>…   </p></td>
<td><p>…   </p></td>
<td><p>…   </p></td>
<td><p>…    </p></td>
</tr>
<tr class="row-even"><td><p>statev[1+6(i-1):6i]   </p></td>
<td><p><span class="math notranslate nohighlight">\( \mathbf{q}_i \)</span></p></td>
<td><p>Internal stresses of i-th element (Voigt)   </p></td>
<td><p>Stress   </p></td>
</tr>
</tbody>
</table>
</p>
<p>Total state variables required: <span class="math notranslate nohighlight">\( n_{statev} = 1 + 6N \)</span></p>
<p><strong>References:</strong><ul class="simple">
<li><p>Zener, C. (1948). <em>Elasticity and Anelasticity of Metals</em>. University of Chicago Press.</p></li>
<li><p>Ferry, J. D. (1980). <em>Viscoelastic Properties of Polymers</em> (3rd ed.). Wiley.</p></li>
<li><p>Simo, J. C., &amp; Hughes, T. J. R. (1998). <em>Computational Inelasticity</em>. Springer.</p></li>
<li><p>Park, S. W., &amp; Schapery, R. A. (1999). “Methods of interconversion between linear viscoelastic material functions.” <em>Int. J. Solids Struct.</em>, 36(11), 1653-1675. </p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__umat__mechanical_1ga6884029478cfdc54c964e5a3bffa9744"><span class="std std-ref">umat_zener_fast()</span></a> for single Maxwell element version </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#group__umat__mechanical_1ga3b458b2e70aef216dee52bd42f40a49e"><span class="std std-ref">umat_prony_Nfast()</span></a> for equivalent Prony series formulation</p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Relaxation times should span the expected loading time scales (decades in log-time) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Typically 5-10 Maxwell elements are sufficient for most polymers </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For frequency-domain data, use fitting algorithms to extract Prony parameters </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The model assumes small strains and linear viscoelasticity </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Time step should be small relative to shortest relaxation time for accuracy</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Etot</strong> – Total strain tensor at beginning of increment (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>DEtot</strong> – Strain increment tensor (Voigt notation: 6×1 vector) </p></li>
<li><p><strong>sigma</strong> – Stress tensor (Voigt notation: 6×1 vector) [output] </p></li>
<li><p><strong>Lt</strong> – Consistent tangent modulus (6×6 matrix) [output] </p></li>
<li><p><strong>DR</strong> – Rotation increment matrix (3×3) for objective integration </p></li>
<li><p><strong>nprops</strong> – Number of material properties </p></li>
<li><p><strong>props</strong> – Material properties vector (see table above) </p></li>
<li><p><strong>nstatev</strong> – Number of state variables </p></li>
<li><p><strong>statev</strong> – State variables vector (see table above) [input/output] </p></li>
<li><p><strong>T</strong> – Temperature at beginning of increment </p></li>
<li><p><strong>DT</strong> – Temperature increment </p></li>
<li><p><strong>Time</strong> – Time at beginning of increment </p></li>
<li><p><strong>DTime</strong> – Time increment </p></li>
<li><p><strong>Wm</strong> – Total mechanical work [output] </p></li>
<li><p><strong>Wm_r</strong> – Recoverable (elastic) work [output] </p></li>
<li><p><strong>Wm_ir</strong> – Irrecoverable work stored in viscous elements [output] </p></li>
<li><p><strong>Wm_d</strong> – Dissipated (viscous) work [output] </p></li>
<li><p><strong>ndi</strong> – Number of direct stress components (typically 3) </p></li>
<li><p><strong>nshr</strong> – Number of shear stress components (typically 3) </p></li>
<li><p><strong>start</strong> – Flag indicating first increment (true) or continuation (false) </p></li>
<li><p><strong>tnew_dt</strong> – Suggested new time step size for adaptive time stepping [output]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413get_L_elasticR21phase_characteristics">
<span id="_CPPv313get_L_elasticR21phase_characteristics"></span><span id="_CPPv213get_L_elasticR21phase_characteristics"></span><span id="get_L_elastic__phase_characteristicsR"></span><span class="target" id="group__umat__mechanical_1gacf8fbb6f59f480ee0a766c2cbecaa0fd"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_L_elastic</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">phase_characteristics</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413get_L_elasticR21phase_characteristics" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, 3MAH development team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>